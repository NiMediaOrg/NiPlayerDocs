(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{278:function(t,e,i){"use strict";var n;function s(t){let e=t.getBoundingClientRect();return{x:e.left,y:e.top}}function A(t,e,i,n,A){let{x:r,y:o}=s(t),a=o-i-e.clientHeight,h=o+t.clientHeight,l=r+Math.round(t.clientWidth/2)-Math.round(e.clientWidth/2),d=r+Math.round(t.clientWidth/2)+Math.round(e.clientWidth/2),p=r,c=r+t.clientWidth;return n>=l&&n<=d&&A<=o&&A>=a||n>=p-5&&n<=c+5&&A>=o-5&&A<=h+5}i.r(e),i.d(e,"$",(function(){return o})),i.d(e,"BuiltInControllerComponent",(function(){return Y})),i.d(e,"COMPONENT_STORE",(function(){return P})),i.d(e,"Controller",(function(){return qt})),i.d(e,"Danmaku",(function(){return Ut})),i.d(e,"DanmakuController",(function(){return ji})),i.d(e,"DanmakuInput",(function(){return Dt})),i.d(e,"DanmakuOpenClose",(function(){return Ot})),i.d(e,"DanmakuSettings",(function(){return Mt})),i.d(e,"DutaionShow",(function(){return lt})),i.d(e,"EVENT",(function(){return n})),i.d(e,"Env",(function(){return _t})),i.d(e,"ErrorLoading",(function(){return q})),i.d(e,"FullPage",(function(){return dt})),i.d(e,"FullScreen",(function(){return st})),i.d(e,"HIDEEN_COMPONENT_STORE",(function(){return J})),i.d(e,"Loading",(function(){return w})),i.d(e,"MediumBar",(function(){return It})),i.d(e,"ONCE_COMPONENT_STORE",(function(){return N})),i.d(e,"Options",(function(){return it})),i.d(e,"PicInPic",(function(){return pt})),i.d(e,"PlayButton",(function(){return At})),i.d(e,"ScreenShot",(function(){return ct})),i.d(e,"SubSetting",(function(){return mt})),i.d(e,"SubsettingItem",(function(){return ft})),i.d(e,"SubsettingsMain",(function(){return yt})),i.d(e,"SubsettingsPlayrate",(function(){return bt})),i.d(e,"SubsettingsSubtitle",(function(){return wt})),i.d(e,"TimeLoading",(function(){return V})),i.d(e,"Toast",(function(){return x})),i.d(e,"ToolBar",(function(){return kt})),i.d(e,"TopBar",(function(){return St})),i.d(e,"VideoProgress",(function(){return xt})),i.d(e,"VideoShot",(function(){return ut})),i.d(e,"Volume",(function(){return rt})),i.d(e,"addClass",(function(){return h})),i.d(e,"addZero",(function(){return ot})),i.d(e,"changeClass",(function(){return d})),i.d(e,"checkIsMouseInRange",(function(){return A})),i.d(e,"computeAngle",(function(){return ht})),i.d(e,"containsDOM",(function(){return c})),i.d(e,"createSvg",(function(){return g})),i.d(e,"createSvgs",(function(){return b})),i.d(e,"default",(function(){return ln})),i.d(e,"formatTime",(function(){return at})),i.d(e,"getDOMPoint",(function(){return s})),i.d(e,"getEl",(function(){return a})),i.d(e,"getElementSize",(function(){return u})),i.d(e,"getExtension",(function(){return Ct})),i.d(e,"includeClass",(function(){return p})),i.d(e,"nextTick",(function(){return Bt})),i.d(e,"patchComponent",(function(){return y})),i.d(e,"patchDOMProps",(function(){return v})),i.d(e,"patchFn",(function(){return E})),i.d(e,"patchStyle",(function(){return _})),i.d(e,"removeClass",(function(){return l})),i.d(e,"setSvgPath",(function(){return m})),i.d(e,"storeControlComponent",(function(){return G})),function(t){t.LOADED_META_DATA="loadedmetadata",t.TIME_UPDATE="timeupdate",t.PLAY="play",t.PAUSE="pause",t.SEEKING="seeking",t.SEEKED="seeked",t.WAITING="waiting",t.CAN_PLAY="canplay",t.ERROR="videoError",t.RATE_CHANGE="ratechange",t.VIDEO_CLICK="videoClick",t.PROGRESS_CLICK="progress-click",t.PROGRESS_MOUSE_ENTER="progress-mouseenter",t.PROGRESS_MOUSE_LEAVE="progress-mouseleave",t.VIDEO_PROGRESS_CLICK="video-progress-click",t.DANMAKU_INPUT_FOCUS="inputFocus",t.DANMAKU_INPUT_BLUR="inputBlur",t.DOT_DOWN="dotdown",t.DOT_UP="dotup",t.DOT_DRAG="dotdrag",t.VIDEO_DOT_DOWN="videoDotDown",t.VIDEO_DOT_UP="videoDotUp",t.VIDEO_DOT_DRAG="videoDotDrag",t.ENTER_FULLSCREEN="enterFullscreen",t.LEAVE_FULLSCREEN="leaveFullscreen",t.ENTER_FULLPAGE="enterFullPage",t.LEAVE_FULLPAGE="leaveFullPage",t.RESIZE="resize",t.SHOW_TOOLBAR="showtoolbar",t.HIDE_TOOLBAR="hidetoolbar",t.MOVE_VERTICAL="moveVertical",t.MOVE_HORIZONTAL="moveHorizontal",t.SLIDE_VERTICAL="slideVertical",t.SLIDE_HORIZONTAL="slideHorizontal",t.VOLUME_PROGRESS_CLICK="volume-progress-click",t.REQUEST_DANMAKU_DATA="RequestDanmakuData",t.SEND_DANMAKU_DATA="SendDanmakuData",t.MOOV_PARSE_READY="MoovParseReady",t.SOURCE_ATTACHED="sourceAttached"}(n||(n={}));const r=/([\w-]+)?(?:#([\w-]+))?(?:\.([\w-]+))?/;function o(t,e,i){let n=[],s=r.exec(t);n[0]=s[1]||void 0,n[1]=s[2]||void 0,n[2]=s[3]||void 0;let A=n[0]?document.createElement(n[0]):document.createElement("div");n[1]&&(A.id=n[1]),n[2]&&h(A,[n[2]]);for(let t in e)if("object"==typeof e[t]){if("style"===t){let i="",n=e[t];for(let t in n)i+=`${t}: ${n[t]};`;A.setAttribute("style",i)}}else A.setAttribute(t,String(e[t]));if("string"==typeof i)A.innerHTML+=i;else if(i)for(let t of i)A.appendChild(t.el);return A}function a(t){return t instanceof HTMLElement?t:"string"==typeof t?document.querySelector(t):void 0}function h(t,e){let i=t.classList;for(let n of e)p(t,n)||i.add(n)}function l(t,e){t.classList.remove(...e)}function d(t,e){t.className=e}function p(t,e){let i=t.classList;for(let t in i)if(i[t]===e)return!0;return!1}function c(t,e){return t.childNodes.length>0&&t.childNodes.forEach(t=>{if(t===e)return!0;c(t,e)}),!1}function u(t){const e=t.cloneNode(!0);e.style.position="absolute",e.style.opacity="0",e.removeAttribute("hidden");const i=t.parentNode||document.body;i.appendChild(e);const n=e.getBoundingClientRect();return i.removeChild(e),n}const f="http://www.w3.org/2000/svg";function g(t,e="0 0 24 24"){const i=document.createElementNS(f,"svg");if(i.setAttribute("viewBox",e),t){const e=document.createElementNS(f,"path");e.setAttributeNS(null,"d",t),i.appendChild(e)}return i}function m(t,e){t.getElementsByTagNameNS(f,"path")[0].setAttributeNS(null,"d",e)}function b(t,e="0 0 24 24"){const i=document.createElementNS(f,"svg");i.setAttribute("viewBox",e);for(let e of t){const t=document.createElementNS(f,"path");t.setAttributeNS(null,"d",e),i.appendChild(t)}return i}function y(t,e,i){var n,s;if(t.id!==e.id)throw new Error("需要合并的两个组件的id不相同");let A=(null==i?void 0:i.replaceElType)||"replaceOuterHTMLOfComponent";for(let i in e)if(i in t)if("props"===i)v(t[i],e[i],t.el);else if("el"===i)if("replaceOuterHTMLOfComponent"===A)t.el=e.el;else{for(let e of t.el.childNodes)t.el.removeChild(e);t.el.appendChild(e.el)}else if(t[i]instanceof Function){if(!(e[i]instanceof Function))throw new Error(`属性${i}对应的值应该为函数类型`);console.log("合并函数",e[i]),t[i]=E(t[i],e[i],t),t.resetEvent()}else if(t[i]instanceof HTMLElement){if(!(e[i]instanceof HTMLElement)&&"string"!=typeof e[i])throw new Error(`属性${i}对应的值应该为DOM元素或者字符串类型`);"string"==typeof e[i]||(null===(n=t[i].parentNode)||void 0===n||n.insertBefore(e[i],t[i]),null===(s=t[i].parentNode)||void 0===s||s.removeChild(t[i]),t[i]=e[i])}}function v(t,e,i){for(let n in e)if(t.hasOwnProperty(n))"id"===n?(t.id=e.id,i.id=t.id):"className"===n?(t.className.concat(e.className),h(i,e.className)):"style"===n&&_(t.style,e.style,i);else if(t[n]=e[n],"style"!==n)i[n]=e[n];else if("style"===n)for(let t in e.style)i.style[t]=e.style[t]}function _(t,e,i){for(let i in e)t[i]=e[i];for(let e in t)i.style[e]=t[e]}function E(t,e,i){return console.log(t,e,i),function(...n){t.call(i,...n),e.call(i,...n)}.bind(i)}class B{constructor(){this.$events={}}emit(t,...e){this.$events[t]&&this.$events[t].forEach(t=>{t.call(this,...e)})}on(t,e){this.$events[t]=this.$events[t]||[],this.$events[t].push(e)}off(t,e){this.$events[t]&&(this.$events[t]=this.$events[t].filter(t=>e!==t))}}class C extends B{constructor(t,e,i,n){super();let s=o(e,i,n);if(this.el=s,this.container=t,i&&(i.id&&(this.el.id=i.id),i.className&&h(this.el,i.className),i.style))for(let t in i.style)this.el.style[t]=i.style[t];t&&t.appendChild(s)}init(){}initEvent(){}initPCEvent(){}initMobileEvent(){}initTemplate(){}initPCTemplate(){}initMobileTemplate(){}initComponent(){}resetEvent(){}dispose(){}}class w extends C{constructor(t,e,i,n,s,A){super(null,n,s,A),this.id="Loading",this.props=s||{},this.player=t,this.container=i,this.message=e,this.init()}init(){this.initTemplate(),this.initEvent()}initTemplate(){h(this.el,["video-loading"]),this.loadingBox=o("div"),this.messageBox=o("div"),this.messageBox.innerText=this.message,h(this.messageBox,["video-loading-msgbox"]),this.el.appendChild(this.loadingBox),this.el.appendChild(this.messageBox)}initEvent(){}addLoading(){[...this.container.childNodes].includes(this.el)||this.container.appendChild(this.el)}removeLoading(){[...this.container.childNodes].includes(this.el)&&this.container.removeChild(this.el)}}class q extends w{constructor(t,e,i){super(t,e,i),this.id="errorloading",h(this.loadingBox,["video-loading-errorloading"]),this.initEvent()}initEvent(){this.player.on(n.ERROR,()=>{this.addLoading()}),this.player.on(n.CAN_PLAY,()=>{this.removeLoading()})}}class V extends w{constructor(t,e,i){super(t,e,i),this.id="timeloading",h(this.loadingBox,["video-loading-loadingbox"]),this.initEvent()}initEvent(){this.player.on(n.WAITING,()=>{this.addLoading()}),this.player.on(n.CAN_PLAY,()=>{this.removeLoading()})}}class x extends C{constructor(t,e,i){super(null,"div",i,null),this.id="Toast",this.player=t,this.props=i,this.dom=e||null,this.init()}init(){this.initTemplate(),this.initEvent()}initTemplate(){this.dom&&this.el.appendChild(this.dom),h(this.el,["video-toast-wrapper"]),this.player.el.appendChild(this.el),window.setTimeout(()=>{h(this.el,["video-toast-animate"]);let t=30;for(let e in x.ToastQueue)t+=x.ToastQueue[e].el.clientHeight+10;this.el.style.transform=`translateY(${t}px)`,x.ToastQueue.push(this)})}initEvent(){}dispose(){let t=x.ToastQueue.indexOf(this);x.ToastQueue.splice(t,1),this.el.parentElement.removeChild(this.el);for(let e=t;e<x.ToastQueue.length;e++){let i=x.ToastQueue[e];i.el.style.transform=e===t?`translateY(${10+this.el.clientHeight}px)`:`translateY(${10+x.ToastQueue[e-1].el.clientHeight}px)`}}}x.ToastQueue=[];let I=Document.prototype.createElement;let k=Document.prototype.getElementsByClassName;let S=Document.prototype.getElementById;let Q=Document.prototype.getElementsByTagName;function U(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function T(t){return"object"==typeof t&&null!==t.stopPropagation}function D(t,e,i,n){let s=0,A=0,r=0,o=0,a={x:0,y:0},h={x:0,y:0},l=[],d=!1;T(n)&&(d=n.stopPropagation),t.addEventListener("touchstart",t=>{d&&t.stopPropagation(),t.touches.length>1||(s=Date.now(),A=Date.now(),h={x:t.touches[0].clientX,y:t.touches[0].clientY},a={x:t.touches[0].clientX,y:t.touches[0].clientY},r=a.x,o=a.y)}),t.addEventListener("touchmove",t=>{if(d&&t.stopPropagation(),t.touches.length>1)return;t.preventDefault();let e=Date.now();if(e-s>=10){let o=(i=t.touches[0].clientX,n=a.x,A=t.touches[0].clientY,r=a.y,Math.sqrt((i-A)*(i-A)+(n-r)*(n-r)));l.push(o/(e-s)),a={x:t.touches[0].clientX,y:t.touches[0].clientY},s=e}var i,n,A,r}),t.addEventListener("touchend",t=>{if(d&&t.stopPropagation(),t.touches.length>1)return;let n=0,p=1;s=Date.now(),console.log(l);for(let t=l.length-1;t>=0&&l[t]>l[t-1];t--)n+=l[t]-l[t-1],p++;let c=a.x-r,u=a.y-o;if(n/p*100>=10&&l[l.length-1]>=20&&(c<=0&&"fastSlideLeft"===e||c>=0&&"fastSlideRight"===e||u>=0&&"fastSlideDown"===e||u<=0&&"fastSlideTop"===e||"fastSlide"===e)){let e=Object.assign(Object.assign({},t),{startPos:h,endPos:a,interval:s-A,lastSpeed:l[l.length-1],e:t});i instanceof Function?i(e):i.handleEvent(e)}l=[],a={x:0,y:0},h={x:0,y:0},s=0,A=0})}function O(t,e,i,n){let s,A,r={x:0,y:0},o=1,a=!1;T(n)&&(a=n.stopPropagation),t.addEventListener("touchstart",t=>{a&&t.stopPropagation(),t.touches.length>1&&(s=t.touches[0],A=t.touches[1],r={x:A.clientX-s.clientX,y:A.clientY-s.clientY})}),t.addEventListener("touchmove",t=>{if(a&&t.stopPropagation(),t.preventDefault(),t.touches.length>1){let n=t.touches[0],s=t.touches[1],A={x:s.clientX-n.clientX,y:s.clientY-n.clientY};if(o=U(A)/U(r),"pintch"===e){let e=Object.assign(Object.assign({},t),{scale:o,e:t});i instanceof Function?i(e):i.handleEvent(e)}let a=function(t,e){let i=0,n=U(t)*U(e);if(n){let s=(t.x*e.x+t.y*e.y)/n;return i=Math.acos(Math.min(s,1)),i=t.x*e.y-e.x*t.y>0?-i:i,180*i/Math.PI}return 0}(r,A);if("rotate"===e){let e=Object.assign(Object.assign({},t),{angle:a,e:t});i instanceof Function?i(e):i.handleEvent(e)}}}),t.addEventListener("touchend",t=>{if(a&&t.stopPropagation(),(-1===[...t.touches].indexOf(s)||-1===[...t.touches].indexOf(A))&&"pintchOver"===e){let e=Object.assign(Object.assign({},t),{scale:o,e:t});i instanceof Function?i(e):i.handleEvent(e)}r={x:0,y:0}})}function R(t){if(t.__proto__.addEventListener===L)return t;let e=t.__proto__,i=Object.create(e);return i.addEventListener=L,Object.setPrototypeOf(t,i),Object.setPrototypeOf(i,e),t}const z=HTMLElement.prototype.addEventListener;function L(t,e,i){let n=this;switch(t){case"singleTap":case"doubleTap":case"longTap":!function(t,e,i,n){let s=null,A=null,r=-1,o=!1,a=0,h=!1,l=0,d=!1;T(n)&&(d=n.stopPropagation),t.addEventListener("touchstart",t=>{d&&t.stopPropagation(),t.touches.length>1||(a=Date.now(),"longTap"===e&&(A=window.setTimeout(()=>{},800)),r>0&&a-r<150&&(window.clearTimeout(s),l=a-r,s=null,r=-1,h=!0))}),t.addEventListener("touchmove",t=>{d&&t.stopPropagation(),t.touches.length>1||(o=!0,t.preventDefault(),A&&(window.clearTimeout(A),A=null))}),t.addEventListener("touchend",t=>{if(d&&t.stopPropagation(),t.touches.length>1)return;let n=Date.now()-a;A&&(window.clearTimeout(A),A=null),n<150&&!o&&("singleTap"===e&&!1===h?s=window.setTimeout(()=>{let e=Object.assign(Object.assign({},t),{interval:n,e:t});i instanceof Function?i(e):i.handleEvent(e)},150):"doubleTap"===e&&!0===h&&(s=window.setTimeout(()=>{let e=Object.assign(Object.assign({},t),{interval:l,e:t});i instanceof Function?i(e):i.handleEvent(e)})),r=Date.now()),o=!1,h=!1})}(n,t,e,i);break;case"swipe":case"swipeLeft":case"swipeRight":case"swipeTop":case"swipeDown":case"move":case"moveLeft":case"moveRight":case"moveTop":case"moveDown":!function(t,e,i,n){let s=!1,A={x:0,y:0},r=0,o=0,a=!1;T(n)&&(a=n.stopPropagation),t.addEventListener("touchstart",t=>{a&&t.stopPropagation(),t.touches.length>1||(A.x=t.touches[0].clientX,A.y=t.touches[0].clientY)}),t.addEventListener("touchmove",t=>{if(a&&t.stopPropagation(),t.touches.length>1)return;s=!0,t.preventDefault();let n=t.touches[0].clientX,h=t.touches[0].clientY;if(r=n-A.x,o=h-A.y,"moveLeft"===e&&r<0||"moveRight"===e&&r>0||"moveTop"===e&&o<0||"moveDown"===e&&o>0||"move"===e){let e=Object.assign(Object.assign({},t),{startPos:A,deltaX:r,deltaY:o,e:t});i instanceof Function?i(e):i.handleEvent(e)}}),t.addEventListener("touchend",t=>{if(a&&t.stopPropagation(),t.touches.length>1)return;let n={x:A.x+r,y:A.y+o};if(s&&("swipeLeft"===e&&r<0||"swipeRight"===e&&r>0||"swipeTop"===e&&o<0||"swipeDown"===e&&o>0||"swipe"===e)){let e=Object.assign(Object.assign({},t),{startPos:A,endPos:n,e:t});i instanceof Function?i(e):i.handleEvent(e)}s=!1})}(n,t,e,i);break;case"fastSlide":case"fastSlideLeft":case"fastSlideRight":case"fastSlideTop":case"fastSlideDown":D(n,t,e,i);break;case"pintch":case"pintchOver":case"rotate":O(n,t,e,i);break;default:n===M.body?z.call(window.document.body,t,e,i):z.call(n,t,e,i)}}let F=Object.create(window.document.body);F.addEventListener=L;let M={body:F,createElement:function(t,e){let i=I.call(window.document,t,e),n=i.__proto__,s=Object.create(n);return s.addEventListener=L,Object.setPrototypeOf(i,s),Object.setPrototypeOf(s,n),i},getElementById:function(t){let e=S.call(window.document,t)||null;if(null===e)return null;if(e.__proto__ instanceof HTMLElement){let t=Object.create(e.__proto__);t.addEventListener=L,Object.setPrototypeOf(e,t)}return e},getElementsByClassName:function(t){let e=k.call(window.document,t);return e.forEach(t=>{if(t.__proto__ instanceof HTMLElement){let e=Object.create(t.__proto__);e.addEventListener=L,Object.setPrototypeOf(t,e)}}),e},getElementsByTagName:function(t){let e=Q.call(window.document,t);return e.forEach(t=>{if(t.__proto__ instanceof HTMLElement){let e=Object.create(t.__proto__);e.addEventListener=L,Object.setPrototypeOf(t,e)}}),e}};Object.setPrototypeOf(M,Document.prototype);const P=new Map,N=new Map,J=new Map,Y=["DurationShow","FullPage","FullScreen","PicInPic","PlayButton","Playrate","ScreenShot","SubSetting","VideoShot","Toast"];function G(t){P.set(t.id,t),N.set(t.id,t)}const H="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z",K="M181.333333 213.333333h661.333334a53.393333 53.393333 0 0 1 53.333333 53.333334v490.666666a53.393333 53.393333 0 0 1-53.333333 53.333334H181.333333a53.393333 53.393333 0 0 1-53.333333-53.333334V266.666667a53.393333 53.393333 0 0 1 53.333333-53.333334z m53.333334 640H96a10.666667 10.666667 0 0 1-10.666667-10.666666v-138.666667a21.333333 21.333333 0 0 0-42.666666 0v138.666667a53.393333 53.393333 0 0 0 53.333333 53.333333h138.666667a21.333333 21.333333 0 0 0 0-42.666667zM64 341.333333a21.333333 21.333333 0 0 0 21.333333-21.333333V181.333333a10.666667 10.666667 0 0 1 10.666667-10.666666h138.666667a21.333333 21.333333 0 0 0 0-42.666667H96a53.393333 53.393333 0 0 0-53.333333 53.333333v138.666667a21.333333 21.333333 0 0 0 21.333333 21.333333z m896 341.333334a21.333333 21.333333 0 0 0-21.333333 21.333333v138.666667a10.666667 10.666667 0 0 1-10.666667 10.666666h-138.666667a21.333333 21.333333 0 0 0 0 42.666667h138.666667a53.393333 53.393333 0 0 0 53.333333-53.333333v-138.666667a21.333333 21.333333 0 0 0-21.333333-21.333333z m-32-554.666667h-138.666667a21.333333 21.333333 0 0 0 0 42.666667h138.666667a10.666667 10.666667 0 0 1 10.666667 10.666666v138.666667a21.333333 21.333333 0 0 0 42.666666 0V181.333333a53.393333 53.393333 0 0 0-53.333333-53.333333z",j="M928 128H96a53.393333 53.393333 0 0 0-53.333333 53.333333v661.333334a53.393333 53.393333 0 0 0 53.333333 53.333333h832a53.393333 53.393333 0 0 0 53.333333-53.333333V181.333333a53.393333 53.393333 0 0 0-53.333333-53.333333zM377.753333 591.086667L200.833333 768H320a21.333333 21.333333 0 0 1 0 42.666667H149.206667a21.333333 21.333333 0 0 1-21.206667-21.206667V618.666667a21.333333 21.333333 0 0 1 42.666667 0v119.166666l176.913333-176.92a21.333333 21.333333 0 0 1 30.173333 30.173334zM896 405.333333a21.333333 21.333333 0 0 1-42.666667 0V286.166667l-176.913333 176.92a21.333333 21.333333 0 0 1-30.173333-30.173334L823.166667 256H704a21.333333 21.333333 0 0 1 0-42.666667h170.793333a21.333333 21.333333 0 0 1 21.206667 21.206667V405.333333z",W="M217.8 319.89h-48c-35.9 0-65-29.1-65-65s29.1-65 65-65h48c35.9 0 65 29.1 65 65s-29.1 65-65 65zM714.8 319.89h-322c-35.9 0-65-29.1-65-65s29.1-65 65-65h322c35.9 0 65 29.1 65 65s-29.1 65-65 65zM403.8 579.89h-234c-35.9 0-65-29.1-65-65s29.1-65 65-65h234c35.9 0 65 29.1 65 65s-29.1 65-65 65zM252.8 838.89h-83c-35.9 0-65-29.1-65-65s29.1-65 65-65h83c35.9 0 65 29.1 65 65s-29.1 65-65 65zM425.8 838.89h-1c-35.9 0-65-29.1-65-65s29.1-65 65-65h1c35.9 0 65 29.1 65 65s-29.1 65-65 65zM717.73 398.22c-122.04 0-220.97 98.93-220.97 220.97 0 122.04 98.93 220.97 220.97 220.97 122.04 0 220.97-98.93 220.97-220.97 0.01-122.04-98.93-220.97-220.97-220.97zM822 554.48l-165.25 171.2c-5.9 6.12-13.77 9.19-21.65 9.19-7.52 0-15.05-2.8-20.89-8.44-11.95-11.54-12.29-30.58-0.75-42.54l165.25-171.2c11.54-11.96 30.58-12.29 42.54-0.75 11.95 11.55 12.29 30.59 0.75 42.54z",X="M221.58 319.89h-48c-35.9 0-65-29.1-65-65s29.1-65 65-65h48c35.9 0 65 29.1 65 65s-29.1 65-65 65zM718.58 319.89h-322c-35.9 0-65-29.1-65-65s29.1-65 65-65h322c35.9 0 65 29.1 65 65s-29.1 65-65 65zM407.58 579.89h-234c-35.9 0-65-29.1-65-65s29.1-65 65-65h234c35.9 0 65 29.1 65 65s-29.1 65-65 65zM256.58 838.89h-83c-35.9 0-65-29.1-65-65s29.1-65 65-65h83c35.9 0 65 29.1 65 65s-29.1 65-65 65zM429.58 838.89h-1c-35.9 0-65-29.1-65-65s29.1-65 65-65h1c35.9 0 65 29.1 65 65s-29.1 65-65 65zM713.96 396.72c-122.04 0-220.97 98.93-220.97 220.97s98.93 220.97 220.97 220.97 220.97-98.93 220.97-220.97S836 396.72 713.96 396.72zM837.9 561.91L689.88 715.26a30.078 30.078 0 0 1-21.38 9.19h-0.27c-7.97 0-15.63-3.17-21.27-8.81l-56.57-56.57c-11.75-11.75-11.75-30.79 0-42.54s30.79-11.75 42.54 0l34.92 34.91 126.76-131.32c11.54-11.96 30.58-12.29 42.54-0.75 11.95 11.54 12.29 30.58 0.75 42.54z",Z="M558.933333 490.666667L384 665.6l59.733333 59.733333 234.666667-234.666666L443.733333 256 384 315.733333l174.933333 174.933334z",$="M503.466667 490.666667l174.933333 174.933333-59.733333 59.733333L384 490.666667 618.666667 256l59.733333 59.733333-174.933333 174.933334z",tt="M456.899566 728.522382c-15.978926 15.977903-40.33873 18.47477-58.932204 7.492648-3.446495-2.039449-9.653871-9.990538-9.653871-9.990538L188.797435 526.509459c-18.938328-18.938328-18.938328-47.148833 0-66.084091 18.934235-18.938328 49.64263-16.442484 68.579935 2.495844l165.227112 165.225065 312.24449-312.24142c18.938328-18.938328 49.6457-21.435195 68.583005-2.495844 18.938328 18.940374 18.939351 47.149856 0 66.085114L456.909799 728.507032c0 0-0.005117 0.00921-0.010233 0.013303l0 0L456.899566 728.522382zM510.742868 64.090691c-246.752894 0-446.786743 200.032826-446.786743 446.786743 0 246.75187 200.033849 446.785719 446.786743 446.785719 246.752894 0 446.787766-200.034872 446.787766-446.785719C957.531658 264.125563 757.495762 64.090691 510.742868 64.090691L510.742868 64.090691 510.742868 64.090691 510.742868 64.090691z",et="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z";class it extends C{constructor(t,e,i,n,s,A,r){super(e,s,A,r),this.id="Options",this.bottom=48,this.player=t,this.props=A||{},this.hideHeight=n,this.hideWidth=i,this.initBase()}initBase(){this.initBaseTemplate(),this.initBaseEvent()}initBaseTemplate(){this.hideBox=o("div"),h(this.hideBox,["video-set","video-set-hidden"]),this.hideHeight&&this.hideHeight>0&&(this.hideBox.style.height=this.hideHeight+"px"),this.hideWidth&&this.hideWidth>0&&(this.hideBox.style.width=this.hideWidth+"px"),this.el.appendChild(this.hideBox),this.iconBox=o("div"),h(this.iconBox,["video-icon"]),this.el.appendChild(this.iconBox)}initBaseEvent(){"PC"===this.player.env?this.initBasePCEvent():this.initBaseMobileEvent()}initBasePCEvent(){this.el.onmouseenter=t=>{l(this.hideBox,["video-set-hidden"]),document.body.onmousemove=this.handleMouseMove.bind(this),this.player.emit("oneControllerHover",this)},this.player.on("oneControllerHover",t=>{this!==t&&(p(this.hideBox,"video-set-hidden")||h(this.hideBox,["video-set-hidden"]))}),this.player.on(n.VIDEO_CLICK,()=>{h(this.hideBox,["video-set-hidden"])})}initBaseMobileEvent(){}handleMouseMove(t){let e=t.clientX,i=t.clientY;A(this.el,this.hideBox,this.bottom,e,i)||(h(this.hideBox,["video-set-hidden"]),document.body.onmousemove=null)}replaceIcon(t){this.iconBox.removeChild(this.icon),this.iconBox.appendChild(t),this.icon=t}}var nt={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.toggleFull=t.isFull=t.exitFull=t.beFull=void 0;var e=document.documentElement,i=e.querySelector("head"),n=document.createElement("style"),s="requestFullscreen",A="exitFullscreen",r="fullscreenElement";if("webkitRequestFullScreen"in e)s="webkitRequestFullScreen",A="webkitExitFullscreen",r="webkitFullscreenElement";else if("msRequestFullscreen"in e)s="msRequestFullscreen",A="msExitFullscreen",r="msFullscreenElement";else if("mozRequestFullScreen"in e)s="mozRequestFullScreen",A="mozCancelFullScreen",r="mozFullScreenElement";else if(!("requestFullscreen"in e))throw"当前浏览器不支持Fullscreen API !";function o(t){return t instanceof HTMLElement?t:e}function a(t,e){return e&&(null===i&&(i=document.createElement("head")),n.innerHTML=":fullscreen{background-color:"+e+";}",i.appendChild(n)),o(t)[s]()}function h(){return e.contains(n)&&(null==i||i.removeChild(n)),document[A]()}function l(t){return o(t)===document[r]}t.beFull=a,t.exitFull=h,t.isFull=l,t.toggleFull=function(t,e){return l(t)?(h(),!1):(a(t,e),!0)}}(nt);class st extends it{constructor(t,e,i,n,s){super(t,e,0,0,i,n,s),this.id="FullScreen",this.enterFullScreen=!1,this.init()}init(){this.initTemplate(),this.initEvent(),G(this)}initTemplate(){h(this.el,["video-fullscreen","video-controller"]),this.icon=g(K,"0 0 1024 1024"),this.iconBox.appendChild(this.icon),this.hideBox.innerText="全屏"}initEvent(){this.requestFullScreen=this.requestFullScreen.bind(this),"PC"===this.player.env?this.el.onclick=this.requestFullScreen:R(this.el).addEventListener("singleTap",this.requestFullScreen,{stopPropagation:!0}),document.addEventListener("fullscreenchange",t=>{document.fullscreenElement?(console.log("进入全屏"),this.player.emit(n.ENTER_FULLSCREEN)):(console.log("退出全屏"),this.player.emit(n.LEAVE_FULLSCREEN))})}requestFullScreen(t){t instanceof Event&&t.stopPropagation(),nt.isFull(this.player.container)?nt.isFull(this.player.container)&&(!function(){if(document.exitFullscreen)return document.exitFullscreen();if(document.mozCancelFullScreen)return document.mozCancelFullScreen();if(document.webkitExitFullscreen)return document.webkitExitFullscreen();if(document.msExitFullscreen)return document.msExitFullscreen();throw new Error("你的浏览器无法退出全屏")}(),this.iconBox.removeChild(this.icon),this.icon=g(K,"0 0 1024 1024"),this.iconBox.appendChild(this.icon)):(!function(t){if(t.requestFullscreen)return t.requestFullscreen();if(t.mozRequestFullScreen)return t.mozRequestFullScreen();if(t.webkitRequestFullscreen)return t.webkitRequestFullscreen();if(t.msRequestFullscreen)return t.msRequestFullscreen();throw new Error("你的浏览器不支持任何全屏请求")}(this.player.container),this.iconBox.removeChild(this.icon),this.icon=g("M768 629.333333a53.393333 53.393333 0 0 1-53.333333 53.333334H309.333333a53.393333 53.393333 0 0 1-53.333333-53.333334V394.666667a53.393333 53.393333 0 0 1 53.333333-53.333334h405.333334a53.393333 53.393333 0 0 1 53.333333 53.333334z m53.333333-288h138.666667a21.333333 21.333333 0 0 0 0-42.666666h-138.666667a10.666667 10.666667 0 0 1-10.666666-10.666667V149.333333a21.333333 21.333333 0 0 0-42.666667 0v138.666667a53.393333 53.393333 0 0 0 53.333333 53.333333zM64 341.333333h138.666667a53.393333 53.393333 0 0 0 53.333333-53.333333V149.333333a21.333333 21.333333 0 0 0-42.666667 0v138.666667a10.666667 10.666667 0 0 1-10.666666 10.666667H64a21.333333 21.333333 0 0 0 0 42.666666z m138.666667 341.333334H64a21.333333 21.333333 0 0 0 0 42.666666h138.666667a10.666667 10.666667 0 0 1 10.666666 10.666667v138.666667a21.333333 21.333333 0 0 0 42.666667 0v-138.666667a53.393333 53.393333 0 0 0-53.333333-53.333333z m757.333333 0h-138.666667a53.393333 53.393333 0 0 0-53.333333 53.333333v138.666667a21.333333 21.333333 0 0 0 42.666667 0v-138.666667a10.666667 10.666667 0 0 1 10.666666-10.666667h138.666667a21.333333 21.333333 0 0 0 0-42.666666z","0 0 1024 1024"),this.iconBox.appendChild(this.icon))}}class At extends C{constructor(t,e,i,n,s){super(e,i,n,s),this.id="PlayButton",this.player=t,this.props=n||{},this.init()}init(){this.initTemplate(),this.initEvent(),G(this)}initTemplate(){h(this.el,["video-start-pause","video-controller"]),this.iconBox=o("div.video-icon"),this.el.appendChild(this.iconBox),this.pauseIcon=g("M14.333 20.133H19V3.8h-4.667M5 20.133h4.667V3.8H5v16.333z"),this.playIcon=g("M6 2.914v18.172L20.279 12 6 2.914z"),this.button=this.playIcon,this.iconBox.appendChild(this.button)}initEvent(){this.player.on("play",t=>{this.iconBox.removeChild(this.button),this.button=this.pauseIcon,this.iconBox.appendChild(this.button)}),this.player.on("pause",t=>{this.iconBox.removeChild(this.button),this.button=this.playIcon,this.iconBox.appendChild(this.button)}),this.onClick=this.onClick.bind(this),"Mobile"===this.player.env?this.initMobileEvent():this.initPCEvent()}initPCEvent(){this.el.onclick=this.onClick}initMobileEvent(){R(this.el).addEventListener("singleTap",this.onClick,{stopPropagation:!0})}onClick(t){t instanceof Event&&t.stopPropagation(),this.player.video.paused?this.player.video.play():this.player.video.pause()}resetEvent(){this.onClick=this.onClick.bind(this),this.el.onclick=null,this.el.onclick=this.onClick}}class rt extends it{constructor(t,e,i,n,s){super(t,e,0,0,i),this.id="Volume",this.volume=.5,this.mouseY=0,this.init()}init(){this.initTemplate(),this.initEvent(),G(this)}initTemplate(){h(this.el,["video-volume","video-controller"]),this.el["aria-label"]="音量",h(this.hideBox,["video-volume-set"]),this.volumeProgress=o("div.video-volume-progress",{style:{height:"70px"}}),this.volumeShow=o("div.video-volume-show"),this.volumeShow.innerText=(100*this.volume).toFixed(0),this.volumeCompleted=o("div.video-volume-completed"),this.volumeProgress.appendChild(this.volumeCompleted),this.hideBox.appendChild(this.volumeShow),this.hideBox.appendChild(this.volumeProgress),this.volumeDot=o("div.video-volume-dot"),this.volumeProgress.appendChild(this.volumeDot),this.icon=g(H),this.iconBox.appendChild(this.icon),this.player.video.volume=this.volume}initEvent(){this.player.on(n.VOLUME_PROGRESS_CLICK,(t,e)=>{let i=t.clientY-s(this.volumeProgress).y,n=(this.volumeProgress.clientHeight-i)/this.volumeProgress.clientHeight;n<0?n=0:n>1&&(n=1),this.volumeCompleted.style.height=100*n+"%",this.volumeDot.style.top=(1-n)*this.volumeProgress.clientHeight+"px",this.volume=n,this.volumeShow.innerText=Math.round(100*this.volume)+"",this.player.video.volume=this.volume}),this.volumeProgress.onclick=t=>{t.stopPropagation(),this.player.emit(n.VOLUME_PROGRESS_CLICK,t,this)},this.volumeDot.onmousedown=t=>{t.stopPropagation(),this.mouseY=t.pageY;let e=parseInt(getComputedStyle(this.volumeDot).top);document.body.onmousemove=t=>{t.preventDefault();let i=e+t.pageY-this.mouseY;console.log(i);let n=(this.volumeProgress.clientHeight-i)/this.volumeProgress.clientHeight;n<0?n=0:n>1&&(n=1),this.volumeDot.style.top=(1-n)*this.volumeProgress.clientHeight+"px",this.volumeCompleted.style.height=100*n+"%",this.volumeShow.innerText=Math.round(100*n)+"",this.player.video.volume=n,this.volume=n},document.body.onmouseup=t=>{document.body.onmousemove=null,document.body.onmouseup=null}}}}function ot(t){return t>9?""+t:"0"+t}function at(t){let e=(t=Math.floor(t))%60;return ot(Math.floor(t/60))+":"+ot(e)}function ht(t,e){return 0===t?90:0===e?0:Math.round(180*Math.atan(Math.abs(e)/Math.abs(t))/Math.PI)}class lt extends C{constructor(t,e,i,n,s){super(e,i,n,s),this.id="DurationShow",this.currentTime="00:00",this.totalTime="00:00",this.player=t,this.props=n,this.init()}init(){this.initTemplate(),this.initEvent(),G(this)}initTemplate(){h(this.el,["video-duration-time","video-controller"]),this.el.innerText=`${this.currentTime}/${this.totalTime}`}initEvent(){this.player.on(n.LOADED_META_DATA,t=>{let e=t.target;this.totalTime=at(e.duration),this.el.innerText=`${this.currentTime}/${this.totalTime}`}),this.player.on(n.TIME_UPDATE,t=>{let e=t.target;this.currentTime=at(e.currentTime),this.el.innerText=`${this.currentTime}/${this.totalTime}`}),this.player.on(n.VIDEO_DOT_DRAG,t=>{this.currentTime=at(this.player.video.duration*t),this.el.innerText=`${this.currentTime}/${this.totalTime}`})}}class dt extends it{constructor(t,e,i,n,s){super(t,e,0,0,i,n,s),this.id="FullPage",this.isFullPage=!1,this.init()}init(){this.initTemplate(),this.initEvent(),G(this)}initTemplate(){h(this.el,["video-fullpage","video-controller"]),this.icon=g(j,"0 0 1024 1024"),this.iconBox.appendChild(this.icon),this.hideBox.innerText="网页全屏"}initEvent(){this.onClick=this.onClick.bind(this),"Mobile"===this.player.env?R(this.el).addEventListener("singleTap",this.onClick,{stopPropagation:!0}):this.el.onclick=this.onClick}onClick(t){t instanceof Event&&t.stopPropagation(),this.isFullPage?(l(this.player.el,["video-wrapper-fullpage"]),this.iconBox.removeChild(this.icon),this.icon=g(j,"0 0 1024 1024"),this.iconBox.appendChild(this.icon),this.player.emit(n.LEAVE_FULLPAGE)):(h(this.player.el,["video-wrapper-fullpage"]),this.iconBox.removeChild(this.icon),this.icon=g("M928 128H96a53.393333 53.393333 0 0 0-53.333333 53.333333v661.333334a53.393333 53.393333 0 0 0 53.333333 53.333333h832a53.393333 53.393333 0 0 0 53.333333-53.333333V181.333333a53.393333 53.393333 0 0 0-53.333333-53.333333z m-544 618.666667a21.333333 21.333333 0 0 1-42.666667 0V627.5l-176.913333 176.92a21.333333 21.333333 0 0 1-30.173333-30.173333L311.166667 597.333333H192a21.333333 21.333333 0 0 1 0-42.666666h170.766667A21.333333 21.333333 0 0 1 384 575.9z m505.753333-496.913334L712.833333 426.666667H832a21.333333 21.333333 0 0 1 0 42.666666H661.233333A21.333333 21.333333 0 0 1 640 448.1V277.333333a21.333333 21.333333 0 0 1 42.666667 0v119.166667l176.913333-176.92a21.333333 21.333333 0 1 1 30.173333 30.173333z","0 0 1024 1024"),this.iconBox.appendChild(this.icon),this.player.emit(n.ENTER_FULLPAGE)),this.isFullPage=!this.isFullPage}}class pt extends it{constructor(t,e,i,n,s){super(t,e,0,0,i,n,s),this.id="PicInPic",this.init()}init(){this.initTemplate(),this.initEvent(),G(this)}initTemplate(){h(this.el,["video-picInpic","video-controller"]),this.icon=g("M768 213.333333H256a85.333333 85.333333 0 0 0-85.333333 85.333334v426.666666a85.333333 85.333333 0 0 0 85.333333 85.333334h170.666667a42.666667 42.666667 0 1 1 0 85.333333H256a170.666667 170.666667 0 0 1-170.666667-170.666667V298.666667a170.666667 170.666667 0 0 1 170.666667-170.666667h512a170.666667 170.666667 0 0 1 170.666667 170.666667v128a42.666667 42.666667 0 1 1-85.333334 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m-128 341.333334a128 128 0 0 0-128 128v85.333333a128 128 0 0 0 128 128h170.666667a128 128 0 0 0 128-128v-85.333333a128 128 0 0 0-128-128h-170.666667z","0 0 1024 1024"),this.iconBox.appendChild(this.icon),this.hideBox.innerText="画中画"}initEvent(){this.onClick=this.onClick.bind(this),"Mobile"===this.player.env?R(this.el).addEventListener("singleTap",this.onClick):this.el.onclick=this.onClick}onClick(t){t instanceof Event&&t.stopPropagation(),document.pictureInPictureElement?document.exitPictureInPicture():this.player.video.requestPictureInPicture()}}class ct extends it{constructor(t,e,i,n,s){super(t,e,0,0,i,n,s),this.id="ScreenShot",this.init()}init(){this.initTemplate(),this.initEvent(),G(this)}initTemplate(){this.confirmIcon=g(tt,"0 0 1024 1024"),h(this.el,["video-screenshot","video-controller"]),this.icon=g("M981.333333 224v661.333333a53.393333 53.393333 0 0 1-53.333333 53.333334H96a53.393333 53.393333 0 0 1-53.333333-53.333334V224a53.393333 53.393333 0 0 1 53.333333-53.333333h80a10.713333 10.713333 0 0 0 8.533333-4.266667L229.333333 106.666667a53.58 53.58 0 0 1 42.666667-21.333334h138.666667a53.58 53.58 0 0 1 42.666666 21.333334l44.8 59.733333A10.713333 10.713333 0 0 0 506.666667 170.666667h421.333333a53.393333 53.393333 0 0 1 53.333333 53.333333z m-348.666666 451.333333a170.666667 170.666667 0 1 0-120.666667 50 169.553333 169.553333 0 0 0 120.666667-50z m7.333333-120.666666c0 70.58-57.42 128-128 128s-128-57.42-128-128 57.42-128 128-128 128 57.42 128 128z m213.333333-234.666667a21.333333 21.333333 0 0 0-21.333333-21.333333h-85.333333a21.333333 21.333333 0 0 0 0 42.666666h85.333333a21.333333 21.333333 0 0 0 21.333333-21.333333z","0 0 1024 1024"),this.iconBox.appendChild(this.icon),this.hideBox.innerText="截图"}initEvent(){this.onClick=this.onClick.bind(this),"PC"===this.player.env?this.el.addEventListener("click",this.onClick):R(this.el).addEventListener("singleTap",this.onClick,{stopPropagation:!0})}onClick(t){t instanceof Event&&t.stopPropagation(),p(this.icon,"video-screenshot-animate")||(h(this.icon,["video-screenshot-animate"]),this.icon.ontransitionend=t=>{l(this.icon,["video-screenshot-animate"]),this.icon.ontransitionend=null}),this.screenShot()}screenShot(){const t=document.createElement("canvas");let e=this.player.video;t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0,t.width,t.height);const i=`${Math.random().toString(36).slice(-8)}_${e.currentTime}.png`;try{t.toBlob(t=>{const e=URL.createObjectURL(t),n=document.createElement("a");n.href=e,n.download=i,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(e)},"image/png")}catch(t){}let n=o("div.video-screenshot-toast"),s=o("span");s.innerText="截图成功!";let A=this.confirmIcon.cloneNode(!0);n.appendChild(A),n.appendChild(s);let r=new x(this.player,n);setTimeout(()=>{r.dispose(),r=null},2e3)}}class ut extends it{constructor(t,e,i,n,s){super(t,e,0,0,i,n,s),this.id="VideoShot",this.countDown=30,this.timer=null,this.player=t,this.props=n||{},this.init()}init(){this.initTemplate(),this.initEvent(),G(this)}initTemplate(){h(this.el,["video-videoshot","video-controller"]),this.icon=g("M640 266.666667v490.666666a53.393333 53.393333 0 0 1-53.333333 53.333334H53.333333a53.393333 53.393333 0 0 1-53.333333-53.333334V266.666667a53.393333 53.393333 0 0 1 53.333333-53.333334h533.333334a53.393333 53.393333 0 0 1 53.333333 53.333334z m357.053333-46.133334a52.746667 52.746667 0 0 0-53.613333 0.493334l-192 114a53.553333 53.553333 0 0 0-26.106667 45.853333v262.24a53.54 53.54 0 0 0 26.106667 45.853333l192 114a53.333333 53.333333 0 0 0 80.56-45.853333V266.88a52.746667 52.746667 0 0 0-26.946667-46.346667z","0 0 1024 1024"),this.iconBox.appendChild(this.icon),this.hideBox.innerText="视频录制"}initEvent(){this.onDown=this.onDown.bind(this),"PC"===this.player.env?this.el.onmousedown=this.onDown:this.el.ontouchstart=this.onDown}onDown(t){t.stopPropagation(),h(this.icon,["video-videoshot-animate"]),this.player.video.played&&this.videoShot()}videoShot(){let t=this.createInProgressToast(),e=new MediaRecorder(this.player.video.captureStream(60));e.addEventListener("start",t=>{console.log("开始录制视频")}),e.addEventListener("stop",t=>{console.log("结束录制视频")}),e.addEventListener("dataavailable",t=>{let e=t.data,i=document.createElement("a");i.href=window.URL.createObjectURL(e),i.download="Test.mp4",i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),i=null}),e.start(),this.timer=window.setInterval(()=>{console.log(this.countDown),t.el.querySelector("span").innerText=`开始录屏，最多录制30秒; 还剩${this.countDown}秒`,0!==this.countDown?this.countDown--:this.stop(e)},1e3),"Mobile"===this.player.env?this.el.ontouchend=i=>{l(this.icon,["video-videoshot-animate"]),this.stop(e),t.dispose(),t=null;let n=this.createSuccessToast();window.setTimeout(()=>{n.dispose(),n=null},2e3)}:this.el.onmouseup=i=>{l(this.icon,["video-videoshot-animate"]),this.stop(e),t.dispose(),t=null;let n=this.createSuccessToast();window.setTimeout(()=>{n.dispose(),n=null},2e3)}}stop(t){t.stop(),t=null,window.clearInterval(this.timer),this.timer=0,this.el.onmouseup=null,this.el.ontouchend=null,this.countDown=30}createInProgressToast(){let t=g("M449.59694 552.460488c-2.589471 0-5.210911-0.319688-7.800382-0.959063C313.729623 519.308862 224.280976 404.668816 224.280976 272.733659L224.280976 160.842927c0-17.646767 14.322014-31.96878 31.96878-31.96878s31.96878 14.322014 31.96878 31.96878l0 111.890732c0 102.587817 69.564066 191.716777 169.114849 216.748332 17.134267 4.315785 27.52512 21.674833 23.241303 38.778131C476.930248 542.805916 463.886985 552.460488 449.59694 552.460488L449.59694 552.460488zM574.40306 552.460488c-14.290045 0-27.301339-9.654572-30.977748-24.168398-4.315785-17.134267 6.074068-34.493315 23.208336-38.777132C666.217397 464.450435 735.781463 375.321475 735.781463 272.733659L735.781463 160.842927c0-17.646767 14.290045-31.96878 31.96878-31.96878s31.96878 14.322014 31.96878 31.96878l0 111.890732c0 131.935157-89.448648 246.575204-217.483614 278.767766C579.613971 552.1408 576.992531 552.460488 574.40306 552.460488zM767.750244 896.124878c-17.678736 0-31.96878-14.322014-31.96878-31.96878l0-95.906341c0-102.619785-69.564066-191.748745-169.114849-216.748332-17.134267-4.283817-27.52512-21.674833-23.241303-38.778131 4.347754-17.134267 21.930583-27.397245 38.777132-23.208336C710.270377 521.642583 799.719024 636.28263 799.719024 768.249756l0 95.906341C799.719024 881.802864 785.42898 896.124878 767.750244 896.124878zM256.249756 896.124878c-17.646767 0-31.96878-14.322014-31.96878-31.96878l0-95.906341c0-131.967126 89.448648-246.607173 217.516581-278.767766 17.167235-4.18791 34.461346 6.074068 38.777132 23.209335 4.315785 17.134267-6.074068 34.493315-23.241303 38.777132C357.750634 576.501011 288.218537 665.629971 288.218537 768.249756l0 95.906341C288.218537 881.802864 273.896523 896.124878 256.249756 896.124878zM863.656585 192.811707 160.343415 192.811707c-17.646767 0-31.96878-14.322014-31.96878-31.96878L128.374634 32.967805c0-17.646767 14.322014-31.96878 31.96878-31.96878l703.313171 0c17.678736 0 31.96878 14.322014 31.96878 31.96878l0 127.875122C895.625366 178.489694 881.335321 192.811707 863.656585 192.811707zM192.312195 128.874146l639.37561 0L831.687805 64.936585 192.312195 64.936585 192.312195 128.874146zM863.656585 1024 160.343415 1024c-17.646767 0-31.96878-14.322014-31.96878-31.96878L128.374634 864.156098c0-17.646767 14.322014-31.96878 31.96878-31.96878l703.313171 0c17.678736 0 31.96878 14.322014 31.96878 31.96878l0 127.875122C895.625366 1009.677986 881.335321 1024 863.656585 1024zM192.312195 960.062439l639.37561 0 0-63.937561L192.312195 896.124878 192.312195 960.062439z","0 0 1024 1024"),e=o("div.video-videoshot-inprogress-toast"),i=o("span");return i.innerText=`开始录屏，最多录制30秒; 还剩${this.countDown}秒`,e.appendChild(t),e.appendChild(i),new x(this.player,e)}createSuccessToast(){let t=g(tt,"0 0 1024 1024"),e=o("div.video-videoshot-success-toast"),i=o("span");return i.innerText="录制成功!",e.appendChild(t),e.appendChild(i),new x(this.player,e)}}class ft{constructor(t,e,i,n,s){this.player=t,this.init(),e&&this.leftIconBox.appendChild(e),i&&(this.leftTextBox.innerText=i),n&&(this.rightTipBox.innerText=n),s&&this.rightElementBox.appendChild(s)}init(){this.el=o("div.video-subsettings-item"),this.leftArea=o("div.video-subsettings-itemleft"),this.rightArea=o("div.video-subsettings-itemright"),this.leftIconBox=o("div.video-subsettings-itemleft-icon"),this.leftTextBox=o("div.video-subsettings-itemleft-text"),this.rightTipBox=o("div.video-subsettings-itemright-tip"),this.rightElementBox=o("div.video-subsettings-itemright-icon"),this.el.append(this.leftArea,this.rightArea),this.leftArea.append(this.leftIconBox,this.leftTextBox),this.rightArea.append(this.rightTipBox,this.rightElementBox)}}class gt extends B{constructor(t,e){super(),this.id="SubsettingsBase",this.clickOrTap="click",this.player=e,this.subsetting=t,this.__proto__.constructor.instance=this}initBaseSubsettingsItem(){this.SubsettingsItem.forEach(t=>{this.registerSubsettingsItem(t),t.instance.el.dataset.SubsettingsSubtitleType=t.leftText})}initPCEvent(){this.clickOrTap="click"}initMobileEvent(){this.clickOrTap="singleTap"}registerSubsettingsItem(t){let e=null;if(t.target)if(e=t.target instanceof gt?t.target:t.target.instance?t.target.instance:new t.target(this.subsetting,this.player),this.subsetting.registerSubsettingsBase(e),this.subsetting.subsettingsBaseGraph.has(this)){let t=this.subsetting.subsettingsBaseGraph.get(this);!t.includes(e)&&t.push(e),this.subsetting.subsettingsBaseGraph.set(this,t)}else this.subsetting.subsettingsBaseGraph.set(this,[e]);this.SubsettingsItem.includes(t)||this.SubsettingsItem.push(t);let i=new ft(this.player,t.leftIcon,t.leftText,t.rightTip,t.rightIcon);return t.instance=i,this.el.appendChild(i.el),"PC"===this.player.env?this.initPCEvent():this.initMobileEvent(),R(i.el).addEventListener(this.clickOrTap,i=>{i instanceof MouseEvent&&i.stopPropagation(),t.target&&(this.el.style.display="none",e.el.style.display="",this.subsetting.hideBox.style.width=e.el.dataset.width?e.el.dataset.width/this.player.baseSize+"rem":200/this.player.baseSize+"rem"),t.click&&t.click(t)},{stopPropagation:!0}),t}}class mt extends it{constructor(t,e,i){super(t,e,0,0,i),this.id="SubSetting",this.subsettingsBaseGraph=new Map,this.init()}init(){this.initTemplate(),this.initEvent(),G(this)}initTemplate(){h(this.el,["video-subsettings","video-controller"]),h(this.hideBox,["video-subsettings-set"]),this.el["aria-label"]="设置",this.icon=g("M920.606667 611.153333A106.153333 106.153333 0 0 1 853.333333 512v-0.593333a106.166667 106.166667 0 0 1 67.106667-99.273334c26.82-10.713333 40.186667-41.426667 29.793333-68.466666a468.233333 468.233333 0 0 0-74.46-128.24A53.226667 53.226667 0 0 0 801.6 207.333333a106.666667 106.666667 0 0 1-119.433333 8.666667 106.253333 106.253333 0 0 1-52.366667-107.253333 53.46 53.46 0 0 0-44.62-60.4 474.34 474.34 0 0 0-147.893333 0.24 52.613333 52.613333 0 0 0-34.546667 21.333333 53.566667 53.566667 0 0 0-9.62 39.173333 106.753333 106.753333 0 0 1-105.493333 121.813334 107.333333 107.333333 0 0 1-66-22.793334 53.233333 53.233333 0 0 0-74.186667 8.286667A468 468 0 0 0 73.333333 344.82c-10.32 27.053333 3.126667 57.733333 30 68.38a106.706667 106.706667 0 0 1 0.166667 198.306667c-26.826667 10.666667-40.22 41.393333-29.853333 68.44A468.086667 468.086667 0 0 0 148 808.253333a52.6 52.6 0 0 0 35.673333 19.22 53.566667 53.566667 0 0 0 38.666667-11.213333 106.706667 106.706667 0 0 1 171.513333 98.893333 53.466667 53.466667 0 0 0 44.58 60.44 474.366667 474.366667 0 0 0 147.566667-0.066666 53.48 53.48 0 0 0 44.533333-60.486667 106.253333 106.253333 0 0 1 52.173334-107.373333 106.226667 106.226667 0 0 1 119.24 8.333333 53.52 53.52 0 0 0 38.706666 11.18 52.606667 52.606667 0 0 0 35.653334-19.253333 468 468 0 0 0 74.22-128.346667c10.34-27.066667-3.08-57.753333-29.92-68.426667zM640 512c0 70.58-57.42 128-128 128s-128-57.42-128-128 57.42-128 128-128 128 57.42 128 128z","0 0 1024 1024"),this.iconBox.appendChild(this.icon),this.el.appendChild(this.iconBox),this.el.appendChild(this.hideBox),this.initSubSettingBase()}initSubSettingBase(){this.subsettingsMain=new yt(this,this.player),this.registerSubsettingsBase(this.subsettingsMain)}initEvent(){"PC"===this.player.env?this.initPCEvent():this.initMobileEvent(),this.el.onmouseenter=null,R(this.iconBox).addEventListener(this.clickOrTap,t=>{t instanceof Event&&t.stopPropagation(),p(this.icon,"video-subsettings-animate")?l(this.icon,["video-subsettings-animate"]):h(this.icon,["video-subsettings-animate"]),p(this.hideBox,"video-set-hidden")?l(this.hideBox,["video-set-hidden"]):h(this.hideBox,["video-set-hidden"]),this.player.emit("oneControllerHover",this)},{stopPropagation:!0})}initPCEvent(){this.clickOrTap="click"}initMobileEvent(){this.clickOrTap="singleTap"}registerSubsettingsBase(t){if(t instanceof gt)this.hideBox.appendChild(t.el);else{let e=new t(this,this.player);this.hideBox.appendChild(e.el)}}}class bt extends gt{constructor(t,e){super(t,e),this.id="SubsettingsPlayrate",this.SubsettingsItem=[{leftIcon:g($,"0 0 1024 1024"),leftText:"播放速度",target:yt},{leftText:"0.5",target:yt},{leftText:"0.75",target:yt},{leftIcon:g(et),leftText:"正常",target:yt},{leftText:"1.5",target:yt},{leftText:"2",target:yt}],this.init()}init(){this.el=o("div.video-subsettings-playrate"),this.el.dataset.width="170",this.el.style.display="none",this.initSubsettingsItem(),this.initEvent()}initSubsettingsItem(){this.initBaseSubsettingsItem()}initEvent(){this.SubsettingsItem.forEach((t,e)=>{t.instance.el.onclick=e=>{if(e.stopPropagation(),"播放速度"===t.leftText){return this.el.style.display="none",void(this.subsetting.subsettingsBaseGraph.get(this)[0].el.style.display="")}"正常"===t.leftText?this.player.video.playbackRate=1:this.player.video.playbackRate=Number(t.leftText),t.leftIcon=g(et),t.instance.leftIconBox.innerHTML="",t.instance.leftIconBox.appendChild(t.leftIcon);for(let e of this.SubsettingsItem)e!==t&&(e.instance.leftIconBox.innerHTML="")}})}}class yt extends gt{constructor(t,e){super(t,e),this.SubsettingsItem=[{leftIcon:g("M675.328 117.717333A425.429333 425.429333 0 0 0 512 85.333333C276.352 85.333333 85.333333 276.352 85.333333 512s191.018667 426.666667 426.666667 426.666667 426.666667-191.018667 426.666667-426.666667c0-56.746667-11.093333-112-32.384-163.328a21.333333 21.333333 0 0 0-39.402667 16.341333A382.762667 382.762667 0 0 1 896 512c0 212.074667-171.925333 384-384 384S128 724.074667 128 512 299.925333 128 512 128c51.114667 0 100.8 9.984 146.986667 29.12a21.333333 21.333333 0 0 0 16.341333-39.402667zM456.704 305.92C432.704 289.152 405.333333 303.082667 405.333333 331.797333v360.533334c0 28.586667 27.541333 42.538667 51.370667 25.856l252.352-176.768c21.76-15.253333 21.632-43.541333 0-58.709334l-252.373333-176.768z m-8.597333 366.72V351.466667l229.269333 160.597333-229.269333 160.597333z","0 0 1024 1024"),leftText:"播放速度",rightTip:"正常",rightIcon:g(Z,"0 0 1024 1024"),target:bt},{leftIcon:b(["M117.297548 128.825806h762.483613v172.659613a28.771097 28.771097 0 0 1-57.542193 0V186.401032H174.839742v115.084387a28.771097 28.771097 0 0 1-57.542194 0V128.825806zM117.297548 888.567742h762.483613v-172.626581a28.771097 28.771097 0 1 0-57.542193 0v115.084387H174.839742v-115.084387a28.771097 28.771097 0 1 0-57.542194 0V888.567742z","M392.588387 645.615484h-54.701419v-210.811871l-65.271742 20.248774V410.590968l114.093419-40.860903h5.879742v275.885419zM487.192774 618.727226c0-8.687484 2.906839-15.756387 8.687484-21.173678a31.545806 31.545806 0 0 1 22.131613-8.158967c8.984774 0 16.350968 2.741677 22.131613 8.158967a27.416774 27.416774 0 0 1 8.91871 21.173678c0 8.588387-2.906839 15.591226-8.687484 21.008516-5.813677 5.285161-13.245935 7.927742-22.329807 7.927742a31.545806 31.545806 0 0 1-22.131613-7.927742 27.449806 27.449806 0 0 1-8.720516-21.008516z m0-154.954323c0-8.720516 2.906839-15.756387 8.687484-21.206709a31.545806 31.545806 0 0 1 22.131613-8.125936c8.984774 0 16.350968 2.708645 22.131613 8.125936a27.416774 27.416774 0 0 1 8.91871 21.206709 27.416774 27.416774 0 0 1-8.687484 21.008516c-5.813677 5.285161-13.245935 7.927742-22.329807 7.927742a31.545806 31.545806 0 0 1-22.131613-7.927742 27.416774 27.416774 0 0 1-8.720516-21.008516zM724.463484 645.615484h-54.668387v-210.811871l-65.271742 20.248774V410.590968l114.093419-40.860903h5.84671v275.885419z"],"0 0 1024 1024"),leftText:"画面比例",rightTip:"默认",rightIcon:g(Z,"0 0 1024 1024")},{leftIcon:g("M554.666667 810.666667v85.333333h-85.333334v-85.333333h85.333334zM170.666667 178.005333a42.666667 42.666667 0 0 1 34.986666 18.218667l203.904 291.328a42.666667 42.666667 0 0 1 0 48.896l-203.946666 291.328A42.666667 42.666667 0 0 1 128 803.328V220.672a42.666667 42.666667 0 0 1 42.666667-42.666667z m682.666666 0a42.666667 42.666667 0 0 1 42.368 37.717334l0.298667 4.949333v582.656a42.666667 42.666667 0 0 1-74.24 28.629333l-3.413333-4.181333-203.904-291.328a42.666667 42.666667 0 0 1-3.029334-43.861333l3.029334-5.034667 203.946666-291.328A42.666667 42.666667 0 0 1 853.333333 178.005333zM554.666667 640v85.333333h-85.333334v-85.333333h85.333334zM196.266667 319.104V716.8L335.957333 512 196.309333 319.104zM554.666667 469.333333v85.333334h-85.333334v-85.333334h85.333334z m0-170.666666v85.333333h-85.333334V298.666667h85.333334z m0-170.666667v85.333333h-85.333334V128h85.333334z","0 0 1024 1024"),leftText:"画面翻转",rightTip:"正常",rightIcon:g(Z,"0 0 1024 1024")}],this.init()}init(){this.el=o("div.video-subsettings-main"),this.el.dataset.width="200",this.subsetting.hideBox.style.width=parseInt(this.el.dataset.width)/this.player.baseSize+"rem",this.initSubsettingsItem(),this.initEvent()}initSubsettingsItem(){this.initBaseSubsettingsItem()}initEvent(){}}const vt=window.navigator.userAgent.toLowerCase(),_t={isInWeixin:()=>-1!==vt.indexOf("micromessenger"),isInApp:()=>/(^|;\s)app\//.test(vt),isInIOS:()=>vt.match(/(iphone|ipod|ipad);?/i),isInAndroid:()=>vt.match(/android|adr/i),isInPc:()=>!(_t.isInAndroid()||_t.isInApp()||_t.isInIOS()||_t.isInWeixin()),get env(){return this.isInPc()?"PC":"Mobile"}};function Et(t){return"function"==typeof t&&/native code/.test(t.toString())}function Bt(t){if("undefined"!=typeof Promise&&Et(Promise))Promise.resolve().then(t());else if("undefined"!=typeof MutationObserver&&Et(MutationObserver)&&"[object MutationObserverConstructor]"===MutationObserver.toString()){let e=new MutationObserver(t),i=1,n=document.createTextNode(String(i));e.observe(n,{characterData:!0}),i++,n.data=String(i)}else setTimeout(()=>t())}function Ct(t){for(let e=t.length-1;e--;e>=0)if("."===t[e])return t.slice(e+1);return t}class wt extends gt{constructor(t,e){super(t,e),this.id="SubsettingsSubtitle",this.switchOnIcon=g("M764 252H260C116.4 252 0 368.4 0 512s116.4 260 260 260h504c143.6 0 260-116.4 260-260S907.6 252 764 252z m0 484c-123.7 0-224-100.3-224-224s100.3-224 224-224 224 100.3 224 224-100.3 224-224 224z","0 0 1024 1024"),this.switchOffIcon=g("M764 252H260C116.4 252 0 368.4 0 512s116.4 260 260 260h504c143.6 0 260-116.4 260-260S907.6 252 764 252zM260 736C136.3 736 36 635.7 36 512s100.3-224 224-224 224 100.3 224 224-100.3 224-224 224z","0 0 1024 1024"),this.status="show",this.SubsettingsItem=[{leftIcon:g($,"0 0 1024 1024"),leftText:"字幕设置",target:yt},{leftIcon:g("M128.512 214.016h768v81.92h-768zM128.512 718.336h768v81.92h-768zM128.512 466.432h486.4v81.92h-486.4zM896.512 507.392l-174.592-133.12v266.24l174.08-133.12"),leftText:"字幕显示",rightTip:"Show",rightIcon:this.switchOnIcon}],this.init()}init(){this.el=o("div.video-subsettings-subtitle"),this.el.dataset.width="180",this.el.style.display="none",h(this.switchOffIcon,["video-switch-off"]),h(this.switchOnIcon,["video-switch-on"]),this.initSubsettingsItem(),this.initEvent(),G(this)}initSubsettingsItem(){this.initBaseSubsettingsItem(),this.SubsettingsItem[1].instance.rightElementBox.appendChild(this.switchOffIcon),this.switchOffIcon.style.display="none"}initEvent(){for(let t=0;t<this.SubsettingsItem.length;t++)this.SubsettingsItem[t].instance.el.onclick=e=>{e.stopPropagation(),1!==t?this.player.emit("SubsettingsSubtitleClick",this.SubsettingsItem[t],t):"show"===this.status?(this.player.emit("HideSubtitle"),this.switchOffIcon.style.display="",this.switchOnIcon.style.display="none",this.status="hide",this.SubsettingsItem[t].instance.rightTipBox.innerText="Hide"):(this.player.emit("ShowSubtitle"),this.switchOffIcon.style.display="none",this.switchOnIcon.style.display="",this.status="show",this.SubsettingsItem[t].instance.rightTipBox.innerText="Show")}}}class qt extends C{constructor(t,e,i){super(e,i),this.id="Controller",this.leftControllers=[At,rt,lt],this.rightController=[mt,ut,ct,pt,dt,st],this.player=t,this.init()}init(){this.initControllers(),this.initTemplate(),this.initComponent(),G(this)}initControllers(){let t=this.player.playerOptions.leftBottomBarControllers,e=this.player.playerOptions.rightBottomBarControllers;t&&(this.leftControllers=t),e&&(this.rightController=e)}initTemplate(){this.leftArea=o("div.video-bottombar-left"),this.mediumArea=o("div.video-bottombar-medium"),this.rightArea=o("div.video-bottombar-right"),this.el.appendChild(this.leftArea),this.el.appendChild(this.mediumArea),this.el.appendChild(this.rightArea)}initComponent(){this.leftControllers.forEach(t=>{let e=new t(this.player,this.leftArea,"div");N.get(e.id)||G(e),this[e.id]=e}),this.rightController.forEach(t=>{let e=new t(this.player,this.rightArea,"div");N.get(e.id)||G(e),this[e.id]=e})}}class Vt extends C{constructor(t,e,i){super(e,i),this.id="Progress",this.mouseX=0,this.dotLeft=0,this.player=t,this.initBase()}initBase(){this.initBaseTemplate(),this.initBaseEvent()}initBaseTemplate(){this.dot=o("div"),this.completedProgress=o("div"),this.bufferProgress=o("div"),this.el.append(this.dot,this.completedProgress,this.bufferProgress)}initBaseEvent(){this.onMouseMove=this.onMouseMove.bind(this),"PC"===this.player.env?this.initBasePCEvent():this.initBaseMobileEvent(),this.on(n.PROGRESS_CLICK,(t,e)=>{let i=t/this.el.clientWidth;i<0?i=0:i>1&&(i=1),this.dot.style.left=`calc(${100*i}% - 6px)`,this.completedProgress.style.width=100*i+"%"}),this.on(n.DOT_DRAG,(t,e)=>{let i=(t+this.dotLeft)/this.el.clientWidth;i<0?i=0:i>1&&(i=1),this.dot.style.left=`calc(${100*i}% - 6px)`,this.completedProgress.style.width=100*i+"%"})}initBasePCEvent(){let t=this;this.el.onmouseenter=e=>{this.el.style.height="8px",this.emit(n.PROGRESS_MOUSE_ENTER,e,t)},this.el.onmouseleave=e=>{this.el.style.height="",this.emit(n.PROGRESS_MOUSE_LEAVE,e,t)},this.el.onclick=e=>{e.stopPropagation(),this.emit(n.PROGRESS_CLICK,e.offsetX,t)},this.dot.addEventListener("mousedown",e=>{e.stopPropagation(),this.emit(n.DOT_DOWN),this.mouseX=e.pageX,document.body.addEventListener("mousemove",t.onMouseMove),document.body.onmouseup=e=>{this.emit(n.DOT_UP,this.completedProgress.clientWidth/this.el.clientWidth,t),document.body.removeEventListener("mousemove",t.onMouseMove),document.body.onmouseup=null}})}initBaseMobileEvent(){let t=this;R(this.el).addEventListener("singleTap",e=>{let i=e.e.touches[0].clientX-s(this.el).x;this.emit(n.PROGRESS_CLICK,i,t)}),R(this.dot).addEventListener("touchstart",e=>{e.preventDefault(),this.emit(n.DOT_DOWN),this.mouseX=e.touches[0].clientX,this.dotLeft=parseInt(this.el.style.left),document.body.addEventListener("touchmove",this.onMouseMove),document.body.ontouchend=e=>{this.emit(n.DOT_UP,this.completedProgress.clientWidth/this.el.clientWidth,t),document.body.removeEventListener("touchmove",this.onMouseMove),document.body.ontouchend=null}})}onMouseMove(t){if(t instanceof MouseEvent){let e=t.pageX-this.mouseX;this.emit(n.DOT_DRAG,e,this)}else{let e=t.touches[0].clientX-this.mouseX;this.emit(n.DOT_DRAG,e,this)}}}class xt extends Vt{constructor(t,e,i){super(t,e,i),this.id="VideoProgress",this.thumbnailsOptions=null,this.currentIndex=null,this.init()}init(){this.initTemplate(),this.initEvent(),this.thumbnailsOptions&&this.initThumbnails()}initTemplate(){this.player.playerOptions.thumbnails&&(this.thumbnailsOptions=Object.assign({width:160,height:90,margin:0},this.player.playerOptions.thumbnails),this.thumbnails=o("div.video-progress-thumbnails"),this.thumbnails.style.height=this.thumbnailsOptions.height+"px",this.thumbnails.style.width=this.thumbnailsOptions.width+"px"),this.preTime=o("div.video-progress-pretime"),this.el.append(this.preTime),this.thumbnails&&this.el.append(this.thumbnails),h(this.el,["video-progress"]),h(this.dot,["video-progress-dot","video-progress-dot-hidden"]),h(this.completedProgress,["video-progress-completed"])}initEvent(){"PC"===this.player.env?this.initPCEvent():this.initMobileEvent(),this.on(n.DOT_DRAG,(t,e)=>{let i=(t+this.dotLeft)/this.el.clientWidth;i<0?i=0:i>1&&(i=1),this.player.emit(n.VIDEO_DOT_DRAG,i)}),this.on(n.DOT_DOWN,()=>{this.dotLeft=parseInt(this.dot.style.left)/100*this.el.clientWidth,this.player.emit(n.DOT_DOWN)}),this.on(n.DOT_UP,t=>{this.player.emit(n.DOT_UP),this.dotLeft=this.el.clientWidth*t,this.player.video.currentTime=t*this.player.video.duration}),this.player.video.addEventListener("timeupdate",t=>{if(this.player.enableSeek){let t=this.player.video.currentTime/this.player.video.duration;this.dot.style.left=100*t+"%",this.completedProgress.style.width=100*t+"%"}})}initPCEvent(){this.el.addEventListener("mouseenter",t=>{this.preTime.style.display="block",this.thumbnails&&(this.thumbnails.style.display="block");let e=t.clientX-s(this.el).x;this.preTime.style.left=e-this.preTime.clientWidth/2+"px";let i=at(e/t.currentTarget.clientWidth*this.player.video.duration);this.preTime.innerText=i}),this.el.addEventListener("mousemove",t=>{let e=t.clientX-s(this.el).x,i=at(e/t.currentTarget.clientWidth*this.player.video.duration);this.preTime.style.left=e-this.preTime.clientWidth/2+"px",this.preTime.innerText=i,this.thumbnails&&(e-this.thumbnails.clientWidth/2>=0?this.thumbnails.style.left=e-this.thumbnails.clientWidth/2+"px":this.thumbnails.style.left="0px")}),this.el.addEventListener("mouseleave",()=>{this.preTime.style.display="",this.thumbnails&&(this.thumbnails.style.display="")}),this.on(n.PROGRESS_CLICK,(t,e)=>{let i=t/this.el.clientWidth;i<0?i=0:i>1&&(i=1),this.player.video.currentTime=i*this.player.video.duration,this.player.video.paused&&this.player.video.play()}),this.on(n.PROGRESS_MOUSE_ENTER,()=>{l(this.dot,["video-progress-dot-hidden"])}),this.on(n.PROGRESS_MOUSE_LEAVE,()=>{h(this.dot,["video-progress-dot-hidden"])})}initMobileEvent(){this.player.on(n.MOVE_HORIZONTAL,t=>{let e=t.deltaX;this.emit(n.DOT_DRAG,e,this)}),this.player.on(n.SLIDE_HORIZONTAL,t=>{this.player.video.paused&&this.player.video.play();let e=t.endPos.x-t.startPos.x,i=(this.dotLeft+e)/this.el.clientWidth;this.emit(n.DOT_UP,i)})}initThumbnails(){this.el.addEventListener("mousemove",t=>{let e=(t.clientX-s(this.el).x)/this.el.clientWidth*this.player.video.duration,i=Math.floor(e/this.thumbnailsOptions.interval);if(null===this.currentIndex||this.currentIndex!==i||i>=this.thumbnailsOptions.total){this.currentIndex=i;let t=Math.floor(i/this.thumbnailsOptions.col)*this.thumbnailsOptions.margin*2+this.thumbnailsOptions.margin+i*this.thumbnailsOptions.height,e=Math.floor(i%this.thumbnailsOptions.col)*this.thumbnailsOptions.margin*2+this.thumbnailsOptions.margin+i*this.thumbnailsOptions.width;this.thumbnails.style.backgroundImage=`url(${this.thumbnailsOptions.source})`,this.thumbnails.style.backgroundPositionX=`-${e}px`,this.thumbnails.style.backgroundPositionY=`-${t}px`}})}}class It extends C{constructor(t,e,i){super(e,i),this.id="MediumBar",this.player=t,this.init()}init(){this.initTemplate(),this.initComponent(),G(this)}initTemplate(){this.leftArea=o("div.video-mediumbar-left"),this.mediumArea=o("div.video-mediumbar-medium"),this.rightArea=o("div.video-mediumbar-right"),this.el.append(this.leftArea,this.mediumArea,this.rightArea)}initComponent(){this.videoProgress=new xt(this.player,this.el,"div"),this.mediumArea.append(this.videoProgress.el)}}class kt extends C{constructor(t,e,i,n,s){super(e,i,n,s),this.id="Toolbar",this.status="hidden",this.timer=0,this.player=t,this.props=n||{},this.init()}init(){this.initTemplate(),this.initComponent(),this.initEvent(),G(this)}initTemplate(){h(this.el,["video-toolbar"])}initComponent(){this.mediumbar=new It(this.player,this.el,"div.video-mediumbar"),this.controller=new qt(this.player,this.el,"div.video-bottombar")}initEvent(){this.player.on(n.SHOW_TOOLBAR,()=>{this.onShowToolBar()}),this.player.on(n.HIDE_TOOLBAR,()=>{this.onHideToolBar()})}hideToolBar(){p(this.el,"video-toolbar-hidden")||this.player.video.paused||(h(this.el,["video-toolbar-hidden"]),this.status="hidden")}showToolBar(){p(this.el,"video-toolbar-hidden")&&(l(this.el,["video-toolbar-hidden"]),this.status="show"),this.timer=window.setTimeout(()=>{this.player.video.paused||this.hideToolBar()},3e3)}onShowToolBar(){this.timer&&(window.clearTimeout(this.timer),this.timer=null),this.showToolBar()}onHideToolBar(){this.hideToolBar()}}class St extends C{constructor(t,e,i,n,s){super(e,i,n,s),this.id="TopBar",this.timer=0,this.player=t,this.props=n||{},this.init()}init(){this.initTemplate(),this.initEvent(),G(this)}initTemplate(){if(h(this.el,["video-topbar","video-topbar-hidden"]),this.leftArea=o("div.video-topbar-left"),this.rightArea=o("div.video-topbar-right"),this.el.appendChild(this.leftArea),this.el.appendChild(this.rightArea),this.player.playerOptions.title){let t=this.player.playerOptions.title,e=o("div");if("object"==typeof t){if(e.innerText=t.message,t.style)for(let i in t.style)e[i]=t.style[i]}else e.innerText=t;this.leftArea.appendChild(e)}}initComponent(){this.leftControllers=this.player.playerOptions.leftTopBarControllers||[],this.rightController=this.player.playerOptions.rightTopBarController||[],this.leftControllers.forEach(t=>{let e=new t(this.player,this.leftArea,"div");N.get(e.id)||G(e),this[e.id]=e}),this.rightController.forEach(t=>{let e=new t(this.player,this.rightArea,"div");N.get(e.id)||G(e),this[e.id]=e})}initEvent(){this.player.on(n.SHOW_TOOLBAR,()=>{this.onShowToolBar()}),this.player.on(n.HIDE_TOOLBAR,()=>{this.onHideToolBar()})}hideToolBar(){p(this.el,"video-topbar-hidden")||h(this.el,["video-topbar-hidden"])}showToolBar(){p(this.el,"video-topbar-hidden")&&l(this.el,["video-topbar-hidden"]),this.timer=window.setTimeout(()=>{this.hideToolBar()},3e3)}onShowToolBar(){this.timer&&(window.clearTimeout(this.timer),this.timer=null),this.showToolBar()}onHideToolBar(){this.hideToolBar()}}class Qt{constructor(){this.newestTime=0,this.maxInterval=5,this.queue=[]}removeOutTimeData(){this.queue.filter((t,e)=>this.newestTime-t.timestamp<=this.maxInterval)}add(t){return this.newestTime=t.timestamp,this.queue.unshift(t),this.removeOutTimeData(),this}push(t){return this.queue.push(t),this}shift(){return this.queue.shift()}splice(t,e){return this.queue.splice(t,e),this}clear(){for(;this.queue.length;)this.queue.pop();return this}forEach(t){for(let e=0;e<this.queue.length;e++)t(this.queue[e],e)}get length(){return this.queue.length}}class Ut{constructor(t,e){this.moovingQueue=[],this.timer=null,this.renderInterval=100,this.trackHeight=10,this.opacity=1,this.fontSizeScale=1,this.isHidden=!1,this.isPaused=!0,this.showScale=.5,this.defaultDanmaku={message:"default message",fontColor:"#fff",fontSize:this.trackHeight,fontFamily:"",fontWeight:500},this.queue=new Qt,this.container=t,this.player=e,this.trackNumber=this.container.clientHeight/2/this.trackHeight,this.tracks=new Array(this.container.clientHeight/this.trackHeight),this.init()}init(){for(let t=0;t<this.tracks.length;t++)this.tracks[t]||(this.tracks[t]={track:{id:0,priority:0},datas:[]}),this.tracks[t].track={id:t,priority:15-t}}pause(){this.setPaused(!0),this.moovingQueue.forEach(t=>{this.pauseOneData(t)})}resume(){this.setPaused(!1),this.timer=window.setTimeout(()=>{this.render()},this.renderInterval),this.moovingQueue.forEach(t=>{this.resumeOneData(t)})}resumeOneData(t){t.startTime=Date.now(),t.rollTime=(t.totalDistance-t.rollDistance)/t.rollSpeed,t.dom.style.transition=`transform ${t.rollTime}s linear`,t.dom.style.transform=`translateX(${-t.totalDistance}px)`}pauseOneData(t){let e=(Date.now()-t.startTime)*t.rollSpeed/1e3;t.rollDistance=e+(t.rollDistance?t.rollDistance:0),t.dom.style.transition="",t.dom.style.transform=`translateX(${-t.rollDistance}px)`}startDanmaku(){this.render()}addData(t){this.queue.push(this.parseData(t)),console.log(this.isPaused),null===this.timer&&this.render()}parseData(t){if("string"==typeof t)return{message:t,fontColor:"#fff",fontSize:this.trackHeight,fontWeight:500,timestamp:this.player.video.currentTime};if("object"==typeof t){if(!t.message||""===t.message)throw new Error(`传入的弹幕数据${t}不合法`);return Object.assign(Object.assign(Object.assign({},this.defaultDanmaku),{timestamp:this.player.video.currentTime}),t)}throw new Error(`传入的弹幕数据${t}不合法`)}render(){try{this.renderToDOM()}finally{this.renderEnd()}}renderEnd(){0===this.queue.length?(window.clearTimeout(this.timer),this.timer=null):this.timer=window.setTimeout(()=>{this.render()},this.renderInterval)}renderToDOM(){if(0===this.queue.length)return;let t=this.queue.shift();if(!t.dom){let e=o("div.video-danmaku-message");e.innerText=t.message,""!==t.fontFamily&&(e.style.fontFamily=t.fontFamily),e.style.color=t.fontColor,e.style.fontSize=t.fontSize*this.fontSizeScale+"px",e.style.fontWeight=t.fontWeight+"",e.style.position="absolute",e.style.left="100%",e.style.whiteSpace="nowrap",e.style.willChange="transform",e.style.cursor="pointer",e.style.opacity=this.opacity+"",e.style.visibility=this.isHidden?"hidden":"",t.dom=e}this.container.appendChild(t.dom),t.totalDistance=this.container.clientWidth+t.dom.clientWidth,t.width=t.dom.clientWidth,t.rollTime=t.rollTime||Math.floor(.0058*t.totalDistance*(.3*Math.random()+.7)),t.rollSpeed=parseFloat((t.totalDistance/t.rollTime).toFixed(2)),t.useTracks=Math.ceil(t.dom.clientHeight/this.trackHeight),t.y=[],this.addDataToTrack(t),0===t.y.length?([...this.container.childNodes].includes(t.dom)&&this.container.removeChild(t.dom),this.queue.push(t)):(t.dom.style.top=t.y[0]*this.trackHeight+"px",this.startAnimate(t)),t.dom.ontransitionstart=e=>{t.startTime=Date.now()}}addDataToTrack(t){let e=[];for(let i=0;i<this.trackNumber;i++){let n=this.tracks[i].datas;if(0===n.length)e.push(i);else{let s=n[n.length-1],A=s.rollSpeed*(Date.now()-s.startTime)/1e3;A>s.width&&(t.rollSpeed<=s.rollSpeed||(A-s.width)/(t.rollSpeed-s.rollSpeed)>(this.container.clientWidth+s.width-A)/s.rollSpeed)?e.push(i):e=[]}if(e.length>=t.useTracks){t.y=e,t.y.forEach(e=>{this.tracks[e].datas.push(t)});break}}}removeDataFromTrack(t){t.y.forEach(e=>{let i=this.tracks[e].datas,n=i.indexOf(t);-1!==n&&i.splice(n,1)})}startAnimate(t){if(this.isPaused||this.player.video.paused)return this.queue.add(t),void this.removeDataFromTrack(t);this.isHidden&&(t.dom.style.visibility="hidden"),this.moovingQueue.push(t),t.dom.style.transition=`transform ${t.rollTime}s linear`,t.dom.style.transform=`translateX(-${t.totalDistance}px)`,t.dom.ontransitionend=e=>{this.container.removeChild(t.dom),this.removeDataFromTrack(t),this.moovingQueue.splice(this.moovingQueue.indexOf(t),1)}}flush(){console.log("flush"),window.clearTimeout(this.timer),this.timer=null,this.moovingQueue.forEach(t=>{var e;null===(e=t.dom.parentNode)||void 0===e||e.removeChild(t.dom),t.dom.ontransitionend=null,t.dom.ontransitionstart=null}),this.queue.forEach((t,e)=>{var i;[...this.container.children].includes(t.dom)&&(null===(i=t.dom.parentNode)||void 0===i||i.removeChild(t.dom),t.dom.ontransitionend=null,t.dom.ontransitionstart=null)}),this.tracks.forEach(t=>{t.datas=[]}),this.moovingQueue=[],this.queue.clear()}close(){this.isHidden=!0,this.moovingQueue.forEach(t=>{t.dom.style.visibility="hidden"}),this.queue.forEach((t,e)=>{t.dom&&(t.dom.style.visibility="")})}open(){this.isHidden=!1,this.moovingQueue.forEach(t=>{t.dom.style.visibility=""}),this.queue.forEach((t,e)=>{t.dom&&(t.dom.style.visibility="")})}setOpacity(t){this.opacity=t,this.moovingQueue.forEach(e=>{e.dom.style.opacity=t+""})}setTrackNumber(t){t?(this.showScale=t,this.trackNumber=this.container.clientHeight/this.trackHeight*this.showScale):this.trackNumber=this.container.clientHeight/this.trackHeight*this.showScale}setRollDistance(){this.moovingQueue.forEach(t=>{if(t.totalDistance=this.container.clientWidth+t.width,!this.player.video.paused&&!this.isPaused){const e=Date.now(),i=(e-t.startTime)*t.rollSpeed/1e3;t.rollDistance=i+(t.rollDistance?t.rollDistance:0),t.startTime=e,t.rollTime=(t.totalDistance-t.rollDistance)/t.rollSpeed,t.dom.style.transition=`transform ${t.rollTime}s linear`,t.dom.style.transform=`translateX(${-t.totalDistance}px)`}})}setFontSize(t){this.fontSizeScale=t,this.moovingQueue.forEach(t=>{t.dom.style.fontSize=t.fontSize*this.fontSizeScale+"px"})}setPaused(t){this.isPaused=t}}function Tt(t,e){void 0===e&&(e={});var i=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===i&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}}Tt(".danmaku-input-wrapper {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  padding: 0 0.3125rem;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  height: 100%;\n  -webkit-box-flex: 1;\n  -webkit-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  background-color: hsla(0, 0%, 100%, 0.15);\n  border-radius: 2px;\n}\n.danmaku-input-wrapper .danmaku-input {\n  background-color: transparent;\n  width: calc(100% - 2.5rem);\n  height: 50%;\n  line-height: 100%;\n  color: #fff;\n  font-size: 0.8125rem;\n  outline: 0;\n  padding: 0;\n  border: 0;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.danmaku-input-wrapper .danmaku-send {\n  height: 100%;\n  width: 3.125rem;\n  text-align: center;\n  line-height: 30px;\n  background-color: transparent;\n  color: #fff;\n  font-size: 0.8125rem;\n  vertical-align: middle;\n  cursor: pointer;\n}\n.danmaku-box {\n  cursor: pointer;\n}\n.video-danmaku-container {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: transparent;\n  left: 0;\n  top: 0;\n  z-index: 3001;\n}\n.video-danmaku-container .video-danmaku-message {\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  white-space: pre;\n  pointer-events: none;\n  -webkit-perspective: 500px;\n          perspective: 500px;\n  display: inline-block;\n  will-change: transform;\n  font-weight: normal;\n  line-height: 1.125;\n  font-family: SimHei, 'Microsoft JhengHei', Arial, Helvetica, sans-serif;\n  text-shadow: #000000 1px 0px 1px, #000000 0px 1px 1px, #000000 0px -1px 1px, #000000 -1px 0px 1px;\n  opacity: 1;\n  margin-left: 0;\n}\n.video-danmaku-container .video-danmaku-loading-base {\n  position: absolute;\n  z-index: 3001;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  background-color: hsla(0, 0%, 100%, 0.15);\n  padding: 0.625rem 0.625rem;\n  -webkit-box-sizing: content-box;\n          box-sizing: content-box;\n  color: #fff;\n  border-radius: 5px;\n  left: 5px;\n  bottom: 3.75rem;\n  overflow: hidden;\n  -webkit-transition: all 1.5s ease;\n  transition: all 1.5s ease;\n  font-size: 0.875rem;\n}\n.video-danmaku-container .video-danmaku-loading {\n  left: 50%;\n  bottom: 50%;\n  -webkit-transform: translate(-50%, 50%);\n          transform: translate(-50%, 50%);\n}\n.video-danmaku-container .video-danmaku-shaking {\n  -webkit-animation: shake 2.5s 0.15s linear infinite;\n          animation: shake 2.5s 0.15s linear infinite;\n}\n.video-danmaku-container .video-danmaku-loading-hide {\n  -webkit-transform: scale(0);\n          transform: scale(0);\n  opacity: 0;\n}\n@-webkit-keyframes shake {\n  10% {\n    -webkit-transform: rotate(15deg) translate(-50%, 50%);\n            transform: rotate(15deg) translate(-50%, 50%);\n  }\n  20% {\n    -webkit-transform: rotate(-10deg) translate(-50%, 50%);\n            transform: rotate(-10deg) translate(-50%, 50%);\n  }\n  30% {\n    -webkit-transform: rotate(5deg) translate(-50%, 50%);\n            transform: rotate(5deg) translate(-50%, 50%);\n  }\n  40% {\n    -webkit-transform: rotate(-5deg) translate(-50%, 50%);\n            transform: rotate(-5deg) translate(-50%, 50%);\n  }\n  50% {\n    -webkit-transform: rotate(10deg) translate(-50%, 50%);\n            transform: rotate(10deg) translate(-50%, 50%);\n  }\n  60% {\n    -webkit-transform: rotate(-15deg) translate(-50%, 50%);\n            transform: rotate(-15deg) translate(-50%, 50%);\n  }\n  70% {\n    -webkit-transform: rotate(10deg) translate(-50%, 50%);\n            transform: rotate(10deg) translate(-50%, 50%);\n  }\n  80% {\n    -webkit-transform: rotate(-5deg) translate(-50%, 50%);\n            transform: rotate(-5deg) translate(-50%, 50%);\n  }\n  90%,\n  100% {\n    -webkit-transform: rotate(0deg) translate(-50%, 50%);\n            transform: rotate(0deg) translate(-50%, 50%);\n  }\n}\n@keyframes shake {\n  10% {\n    -webkit-transform: rotate(15deg) translate(-50%, 50%);\n            transform: rotate(15deg) translate(-50%, 50%);\n  }\n  20% {\n    -webkit-transform: rotate(-10deg) translate(-50%, 50%);\n            transform: rotate(-10deg) translate(-50%, 50%);\n  }\n  30% {\n    -webkit-transform: rotate(5deg) translate(-50%, 50%);\n            transform: rotate(5deg) translate(-50%, 50%);\n  }\n  40% {\n    -webkit-transform: rotate(-5deg) translate(-50%, 50%);\n            transform: rotate(-5deg) translate(-50%, 50%);\n  }\n  50% {\n    -webkit-transform: rotate(10deg) translate(-50%, 50%);\n            transform: rotate(10deg) translate(-50%, 50%);\n  }\n  60% {\n    -webkit-transform: rotate(-15deg) translate(-50%, 50%);\n            transform: rotate(-15deg) translate(-50%, 50%);\n  }\n  70% {\n    -webkit-transform: rotate(10deg) translate(-50%, 50%);\n            transform: rotate(10deg) translate(-50%, 50%);\n  }\n  80% {\n    -webkit-transform: rotate(-5deg) translate(-50%, 50%);\n            transform: rotate(-5deg) translate(-50%, 50%);\n  }\n  90%,\n  100% {\n    -webkit-transform: rotate(0deg) translate(-50%, 50%);\n            transform: rotate(0deg) translate(-50%, 50%);\n  }\n}\n");class Dt extends C{constructor(t,e,i,n,s){super(e,i,n,s),this.id="DanmakuInput",this.props=n||{},this.player=t,this.init()}init(){this.initTemplate(),this.initEvent()}initTemplate(){h(this.el,["danmaku-input-wrapper"]),this.inputBox=o("input.danmaku-input",{type:"text"}),this.sendBox=o("span.danmaku-send"),this.sendBox.innerText="发送",this.el.appendChild(this.inputBox),this.el.appendChild(this.sendBox)}initEvent(){this.sendBox.onclick=t=>{t.stopPropagation();let e=this.inputBox.value;this.emit("sendData",e),this.inputBox.value="",this.inputBox.blur()},this.inputBox.addEventListener("focus",t=>{t.stopPropagation(),this.player.emit("inputFocus")}),this.inputBox.addEventListener("blur",t=>{t.stopPropagation(),this.player.emit("inputBlur")}),this.inputBox.addEventListener("click",t=>{t.stopPropagation()})}}class Ot extends it{constructor(t,e,i,n,s){super(t,e,0,0,i,n,s),this.id="DanmakuOpenClose",this.danmakuClosePath=W,this.danmakuOpenPath=X,this.status="open",this.msg="关闭弹幕",this.props=n||{},this.player=t,this.init()}init(){this.initTemplate(),this.initEvent()}initTemplate(){h(this.el,["video-danmaku-openclose","video-controller"]),this.icon=g(this.danmakuOpenPath,"0 0 1024 1024"),this.iconBox.appendChild(this.icon),this.hideBox.innerText=this.msg,this.hideBox.style.fontSize="13px"}initEvent(){this.iconBox.addEventListener("click",t=>{t.stopPropagation(),"open"===this.status?(this.replaceIcon(g(W,"0 0 1024 1024")),this.status="close",this.player.emit("closeDanmaku"),this.msg="开启弹幕"):(this.replaceIcon(g(X,"0 0 1024 1024")),this.status="open",this.player.emit("openDanmaku"),this.msg="关闭弹幕"),this.hideBox.innerText=this.msg})}}class Rt extends gt{constructor(t,e){super(t,e),this.id="SubsettingsDanmakuOpacity",this.SubsettingsItem=[{leftIcon:g($,"0 0 1024 1024"),leftText:"弹幕透明度",target:Ft},{leftText:"100%",leftIcon:g(et),target:Ft},{leftText:"75%",target:Ft},{leftText:"50%",target:Ft},{leftText:"0",target:Ft}],this.init()}init(){this.initTemplate(),this.initSubsettingsItem(),this.initEvent()}initSubsettingsItem(){this.initBaseSubsettingsItem()}initTemplate(){this.el=o("div.video-subsettings-danmaku-opacity"),this.el.dataset.width="200",this.el.style.display="none"}initEvent(){this.SubsettingsItem.forEach((t,e)=>{0!==e&&(t.instance.el.onclick=()=>{this.subsetting.emit("OpacityChange",.01*parseFloat(t.leftText)),t.instance.leftIconBox.innerHTML="",t.instance.leftIconBox.appendChild(g(et));for(let e=1;e<this.SubsettingsItem.length;e++){let i=this.SubsettingsItem[e];i!==t&&(i.instance.leftIconBox.innerHTML="")}})})}}class zt extends gt{constructor(t,e){super(t,e),this.id="SubsettingsDanmakuRange",this.SubsettingsItem=[{leftIcon:g($,"0 0 1024 1024"),leftText:"弹幕显示范围",target:Ft},{leftText:"1/4",target:Ft},{leftText:"半屏",leftIcon:g(et),target:Ft},{leftText:"3/4",target:Ft},{leftText:"满屏",target:Ft}],this.init()}init(){this.initTemplate(),this.initSubsettingsItem(),this.initEvent()}initSubsettingsItem(){this.initBaseSubsettingsItem()}initTemplate(){this.el=o("div.video-subsettings-danmaku-range"),this.el.dataset.width="200",this.el.style.display="none"}initEvent(){this.SubsettingsItem.forEach((t,e)=>{0!==e&&(t.instance.el.onclick=()=>{this.subsetting.emit("RangeChange",t.leftText),t.instance.leftIconBox.innerHTML="",t.instance.leftIconBox.appendChild(g(et));for(let e=1;e<this.SubsettingsItem.length;e++){let i=this.SubsettingsItem[e];i!==t&&(i.instance.leftIconBox.innerHTML="")}})})}}class Lt extends gt{constructor(t,e){super(t,e),this.id="SubsettingsDanmakuSize",this.SubsettingsItem=[{leftIcon:g($,"0 0 1024 1024"),leftText:"字体大小",target:Ft},{leftText:"极小",target:Ft},{leftText:"小",target:Ft},{leftText:"适中",leftIcon:g(et),target:Ft},{leftText:"大",target:Ft},{leftText:"极大",target:Ft}],this.init()}init(){this.initTemplate(),this.initSubsettingsItem(),this.initEvent()}initSubsettingsItem(){this.initBaseSubsettingsItem()}initTemplate(){this.el=o("div.video-subsettings-danmaku-size"),this.el.dataset.width="200",this.el.style.display="none"}initEvent(){this.SubsettingsItem.forEach((t,e)=>{0!==e&&(t.instance.el.onclick=()=>{this.subsetting.emit("SizeChange",t.leftText),t.instance.leftIconBox.innerHTML="",t.instance.leftIconBox.appendChild(g(et));for(let e=1;e<this.SubsettingsItem.length;e++){let i=this.SubsettingsItem[e];i!==t&&(i.instance.leftIconBox.innerHTML="")}})})}}class Ft extends gt{constructor(t,e){super(t,e),this.id="SubsettingsDanmakuMain",this.SubsettingsItem=[{leftIcon:g($,"0 0 1024 1024"),leftText:"弹幕设置",target:yt},{leftText:"弹幕速度",rightTip:"适中",rightIcon:g(Z,"0 0 1024 1024")},{leftText:"弹幕透明度",rightTip:"100%",rightIcon:g(Z,"0 0 1024 1024"),target:Rt},{leftText:"字体大小",rightTip:"适中",rightIcon:g(Z,"0 0 1024 1024"),target:Lt},{leftText:"显示范围",rightTip:"半屏",rightIcon:g(Z,"0 0 1024 1024"),target:zt}],this.init()}init(){this.initTemplate(),this.initEvent(),this.initSubsettingsItem()}initSubsettingsItem(){this.initBaseSubsettingsItem()}initTemplate(){this.el=o("div.video-subsettings-danmaku-main"),this.el.dataset.width="250",this.el.style.display="none"}initEvent(){this.subsetting.on("OpacityChange",t=>{this.player.danmakuController.setOpacity(t),this.SubsettingsItem[2].instance.rightTipBox.innerText=100*t+"%"}),this.subsetting.on("RangeChange",t=>{let e=null;"满屏"===t?e=1:"半屏"===t?e=.5:"1/4"===t?e=1/4:"3/4"===t&&(e=3/4),this.player.danmakuController.setTrackNumber(e),this.SubsettingsItem[4].instance.rightTipBox.innerText=t}),this.subsetting.on("SizeChange",t=>{let e=null;"极小"===t?e=.5:"小"===t?e=.75:"适中"===t?e=1:"大"===t?e=1.25:"极大"===t&&(e=1.5),this.player.danmakuController.setFontSize(e),this.SubsettingsItem[3].instance.rightTipBox.innerText=t})}}class Mt{constructor(t){this.id="DanmakuSettings",this.player=t,this.init()}init(){this.initTemplate()}initTemplate(){this.subsettingsMain=yt.instance,this.subsettingsMain.registerSubsettingsItem({leftIcon:b(["M714.752 555.008h-112.64v-26.624h61.44c24.576 0 36.864-14.336 36.864-36.864v-147.456c0-34.816-20.48-38.912-32.768-38.912h-16.384c6.144-8.192 10.24-14.336 14.336-20.48 8.192-14.336 4.096-24.576-8.192-32.768-12.288-6.144-24.576-2.048-32.768 8.192-2.048 2.048-6.144 8.192-8.192 12.288-10.24 16.384-18.432 26.624-20.48 32.768H552.96c-8.192-14.336-18.432-30.72-28.672-47.104-8.192-10.24-20.48-12.288-32.768-6.144-12.288 8.192-16.384 20.48-8.192 32.768 4.096 4.096 8.192 12.288 14.336 22.528h-8.192c-12.288-2.048-20.48 2.048-26.624 6.144-6.144 6.144-8.192 16.384-8.192 28.672V491.52c0 12.288 2.048 22.528 8.192 28.672 6.144 6.144 16.384 8.192 26.624 8.192H552.96v28.672h-102.4c-4.096 0-8.192 0-12.288 6.144v-43.008c0-28.672-16.384-36.864-28.672-36.864h-51.2s-2.048-2.048 0-10.24l2.048-45.056c0-4.096 0-8.192 2.048-8.192H395.264c8.192 0 16.384-2.048 20.48-6.144 6.144-6.144 10.24-16.384 10.24-32.768V307.2c0-14.336-2.048-24.576-10.24-30.72-6.144-6.144-16.384-10.24-30.72-10.24h-65.536c-8.192 0-20.48 2.048-22.528 22.528 0 14.336 6.144 22.528 20.48 24.576h53.248c6.144 0 10.24 2.048 10.24 12.288v30.72c0 14.336-6.144 16.384-12.288 16.384h-22.528c-12.288 0-20.48 2.048-26.624 8.192-6.144 6.144-8.192 16.384-8.192 28.672l-2.048 86.016c0 10.24 2.048 20.48 8.192 24.576 6.144 6.144 14.336 8.192 24.576 8.192h40.96c4.096 0 6.144 0 6.144 2.048 2.048 2.048 4.096 4.096 2.048 14.336 0 2.048 0 8.192-2.048 16.384-2.048 43.008-6.144 59.392-8.192 65.536-6.144 12.288-26.624 6.144-43.008 0-18.432-6.144-26.624 2.048-32.768 10.24-6.144 14.336-2.048 26.624 12.288 32.768 47.104 16.384 79.872 14.336 100.352-8.192 6.144-6.144 14.336-20.48 18.432-67.584 4.096 6.144 10.24 8.192 14.336 8.192h102.4v69.632c0 6.144 2.048 20.48 24.576 20.48 14.336 0 22.528-8.192 22.528-20.48v-69.632h110.592c6.144 0 18.432-2.048 20.48-22.528 2.048-20.48-8.192-24.576-16.384-24.576z m-151.552-65.536h-53.248c-10.24 2.048-14.336-6.144-12.288-18.432v-34.816h65.536v53.248z m0-90.112h-65.536v-43.008c-2.048-10.24 2.048-14.336 12.288-12.288h53.248v55.296z m32.768-53.248h51.2c10.24-2.048 14.336 2.048 14.336 12.288v43.008h-65.536v-55.296z m0 141.312v-53.248h65.536V471.04c0 10.24-6.144 16.384-16.384 16.384h-49.152z","M724.992 145.408H299.008C200.704 145.408 122.88 223.232 122.88 321.536v288.768c0 96.256 77.824 176.128 176.128 176.128h106.496l83.968 83.968c6.144 6.144 14.336 8.192 22.528 8.192s16.384-2.048 22.528-8.192l83.968-83.968h106.496c96.256 0 176.128-77.824 176.128-176.128V321.536c0-98.304-77.824-176.128-176.128-176.128zM839.68 610.304c0 63.488-51.2 114.688-114.688 114.688h-118.784c-4.096 0-8.192 0-10.24 2.048-4.096 2.048-8.192 4.096-10.24 6.144L512 804.864l-71.68-71.68c-2.048-2.048-6.144-6.144-10.24-6.144-4.096-2.048-8.192-2.048-10.24-2.048h-118.784c-63.488 0-114.688-51.2-114.688-114.688V321.536c0-63.488 51.2-114.688 114.688-114.688h428.032c63.488 0 114.688 51.2 114.688 114.688v288.768z"],"0 0 1024 1024"),leftText:"弹幕设置",rightTip:"更多",rightIcon:g(Z,"0 0 1024 1024"),target:Ft})}}const Pt=Object.create(null);Pt.open="0",Pt.close="1",Pt.ping="2",Pt.pong="3",Pt.message="4",Pt.upgrade="5",Pt.noop="6";const Nt=Object.create(null);Object.keys(Pt).forEach(t=>{Nt[Pt[t]]=t});const Jt={type:"error",data:"parser error"},Yt="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Gt="function"==typeof ArrayBuffer,Ht=({type:t,data:e},i,n)=>{return Yt&&e instanceof Blob?i?n(e):Kt(e,n):Gt&&(e instanceof ArrayBuffer||(s=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer))?i?n(e):Kt(new Blob([e]),n):n(Pt[t]+(e||""));var s},Kt=(t,e)=>{const i=new FileReader;return i.onload=function(){const t=i.result.split(",")[1];e("b"+(t||""))},i.readAsDataURL(t)},jt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wt="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let t=0;t<jt.length;t++)Wt[jt.charCodeAt(t)]=t;const Xt="function"==typeof ArrayBuffer,Zt=(t,e)=>{if("string"!=typeof t)return{type:"message",data:te(t,e)};const i=t.charAt(0);if("b"===i)return{type:"message",data:$t(t.substring(1),e)};return Nt[i]?t.length>1?{type:Nt[i],data:t.substring(1)}:{type:Nt[i]}:Jt},$t=(t,e)=>{if(Xt){const i=(t=>{let e,i,n,s,A,r=.75*t.length,o=t.length,a=0;"="===t[t.length-1]&&(r--,"="===t[t.length-2]&&r--);const h=new ArrayBuffer(r),l=new Uint8Array(h);for(e=0;e<o;e+=4)i=Wt[t.charCodeAt(e)],n=Wt[t.charCodeAt(e+1)],s=Wt[t.charCodeAt(e+2)],A=Wt[t.charCodeAt(e+3)],l[a++]=i<<2|n>>4,l[a++]=(15&n)<<4|s>>2,l[a++]=(3&s)<<6|63&A;return h})(t);return te(i,e)}return{base64:!0,data:t}},te=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}},ee=String.fromCharCode(30);function ie(t){if(t)return function(t){for(var e in ie.prototype)t[e]=ie.prototype[e];return t}(t)}ie.prototype.on=ie.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},ie.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},ie.prototype.off=ie.prototype.removeListener=ie.prototype.removeAllListeners=ie.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var s=0;s<n.length;s++)if((i=n[s])===e||i.fn===e){n.splice(s,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},ie.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(i){n=0;for(var s=(i=i.slice(0)).length;n<s;++n)i[n].apply(this,e)}return this},ie.prototype.emitReserved=ie.prototype.emit,ie.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},ie.prototype.hasListeners=function(t){return!!this.listeners(t).length};const ne="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function se(t,...e){return e.reduce((e,i)=>(t.hasOwnProperty(i)&&(e[i]=t[i]),e),{})}const Ae=ne.setTimeout,re=ne.clearTimeout;function oe(t,e){e.useNativeTimers?(t.setTimeoutFn=Ae.bind(ne),t.clearTimeoutFn=re.bind(ne)):(t.setTimeoutFn=ne.setTimeout.bind(ne),t.clearTimeoutFn=ne.clearTimeout.bind(ne))}class ae extends Error{constructor(t,e,i){super(t),this.description=e,this.context=i,this.type="TransportError"}}class he extends ie{constructor(t){super(),this.writable=!1,oe(this,t),this.opts=t,this.query=t.query,this.socket=t.socket}onError(t,e,i){return super.emitReserved("error",new ae(t,e,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=Zt(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}}const le="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),de={};let pe,ce=0,ue=0;function fe(t){let e="";do{e=le[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function ge(){const t=fe(+new Date);return t!==pe?(ce=0,pe=t):t+"."+fe(ce++)}for(;ue<64;ue++)de[le[ue]]=ue;function me(t){let e="";for(let i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e}let be=!1;try{be="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){}const ye=be;function ve(t){const e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||ye))return new XMLHttpRequest}catch(t){}if(!e)try{return new(ne[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}function _e(){}const Ee=null!=new ve({xdomain:!1}).responseType;class Be extends ie{constructor(t,e){super(),oe(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=se(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new ve(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(t){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof e.status?e.status:0)},0))},e.send(this.data)}catch(t){return void this.setTimeoutFn(()=>{this.onError(t)},0)}"undefined"!=typeof document&&(this.index=Be.requestsCount++,Be.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=_e,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete Be.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(Be.requestsCount=0,Be.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",Ce);else if("function"==typeof addEventListener){addEventListener("onpagehide"in ne?"pagehide":"unload",Ce,!1)}function Ce(){for(let t in Be.requests)Be.requests.hasOwnProperty(t)&&Be.requests[t].abort()}var we="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},qe=[],Ve=[],xe="undefined"!=typeof Uint8Array?Uint8Array:Array,Ie=!1;function ke(){Ie=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,i=t.length;e<i;++e)qe[e]=t[e],Ve[t.charCodeAt(e)]=e;Ve["-".charCodeAt(0)]=62,Ve["_".charCodeAt(0)]=63}function Se(t,e,i){for(var n,s,A=[],r=e;r<i;r+=3)n=(t[r]<<16)+(t[r+1]<<8)+t[r+2],A.push(qe[(s=n)>>18&63]+qe[s>>12&63]+qe[s>>6&63]+qe[63&s]);return A.join("")}function Qe(t){var e;Ie||ke();for(var i=t.length,n=i%3,s="",A=[],r=0,o=i-n;r<o;r+=16383)A.push(Se(t,r,r+16383>o?o:r+16383));return 1===n?(e=t[i-1],s+=qe[e>>2],s+=qe[e<<4&63],s+="=="):2===n&&(e=(t[i-2]<<8)+t[i-1],s+=qe[e>>10],s+=qe[e>>4&63],s+=qe[e<<2&63],s+="="),A.push(s),A.join("")}function Ue(t,e,i,n,s){var A,r,o=8*s-n-1,a=(1<<o)-1,h=a>>1,l=-7,d=i?s-1:0,p=i?-1:1,c=t[e+d];for(d+=p,A=c&(1<<-l)-1,c>>=-l,l+=o;l>0;A=256*A+t[e+d],d+=p,l-=8);for(r=A&(1<<-l)-1,A>>=-l,l+=n;l>0;r=256*r+t[e+d],d+=p,l-=8);if(0===A)A=1-h;else{if(A===a)return r?NaN:1/0*(c?-1:1);r+=Math.pow(2,n),A-=h}return(c?-1:1)*r*Math.pow(2,A-n)}function Te(t,e,i,n,s,A){var r,o,a,h=8*A-s-1,l=(1<<h)-1,d=l>>1,p=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,c=n?0:A-1,u=n?1:-1,f=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,r=l):(r=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-r))<1&&(r--,a*=2),(e+=r+d>=1?p/a:p*Math.pow(2,1-d))*a>=2&&(r++,a/=2),r+d>=l?(o=0,r=l):r+d>=1?(o=(e*a-1)*Math.pow(2,s),r+=d):(o=e*Math.pow(2,d-1)*Math.pow(2,s),r=0));s>=8;t[i+c]=255&o,c+=u,o/=256,s-=8);for(r=r<<s|o,h+=s;h>0;t[i+c]=255&r,c+=u,r/=256,h-=8);t[i+c-u]|=128*f}var De={}.toString,Oe=Array.isArray||function(t){return"[object Array]"==De.call(t)};function Re(){return Le.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function ze(t,e){if(Re()<e)throw new RangeError("Invalid typed array length");return Le.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=Le.prototype:(null===t&&(t=new Le(e)),t.length=e),t}function Le(t,e,i){if(!(Le.TYPED_ARRAY_SUPPORT||this instanceof Le))return new Le(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return Pe(this,t)}return Fe(this,t,e,i)}function Fe(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,n){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n);Le.TYPED_ARRAY_SUPPORT?(t=e).__proto__=Le.prototype:t=Ne(t,e);return t}(t,e,i,n):"string"==typeof e?function(t,e,i){"string"==typeof i&&""!==i||(i="utf8");if(!Le.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|Ge(e,i),s=(t=ze(t,n)).write(e,i);s!==n&&(t=t.slice(0,s));return t}(t,e,i):function(t,e){if(Ye(e)){var i=0|Je(e.length);return 0===(t=ze(t,i)).length||e.copy(t,0,0,i),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?ze(t,0):Ne(t,e);if("Buffer"===e.type&&Oe(e.data))return Ne(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function Me(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function Pe(t,e){if(Me(e),t=ze(t,e<0?0:0|Je(e)),!Le.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function Ne(t,e){var i=e.length<0?0:0|Je(e.length);t=ze(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function Je(t){if(t>=Re())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Re().toString(16)+" bytes");return 0|t}function Ye(t){return!(null==t||!t._isBuffer)}function Ge(t,e){if(Ye(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return bi(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return yi(t).length;default:if(n)return bi(t).length;e=(""+e).toLowerCase(),n=!0}}function He(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return oi(this,e,i);case"utf8":case"utf-8":return si(this,e,i);case"ascii":return Ai(this,e,i);case"latin1":case"binary":return ri(this,e,i);case"base64":return ni(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ai(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function Ke(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function je(t,e,i,n,s){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=s?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(s)return-1;i=t.length-1}else if(i<0){if(!s)return-1;i=0}if("string"==typeof e&&(e=Le.from(e,n)),Ye(e))return 0===e.length?-1:We(t,e,i,n,s);if("number"==typeof e)return e&=255,Le.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):We(t,[e],i,n,s);throw new TypeError("val must be string, number or Buffer")}function We(t,e,i,n,s){var A,r=1,o=t.length,a=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;r=2,o/=2,a/=2,i/=2}function h(t,e){return 1===r?t[e]:t.readUInt16BE(e*r)}if(s){var l=-1;for(A=i;A<o;A++)if(h(t,A)===h(e,-1===l?0:A-l)){if(-1===l&&(l=A),A-l+1===a)return l*r}else-1!==l&&(A-=A-l),l=-1}else for(i+a>o&&(i=o-a),A=i;A>=0;A--){for(var d=!0,p=0;p<a;p++)if(h(t,A+p)!==h(e,p)){d=!1;break}if(d)return A}return-1}function Xe(t,e,i,n){i=Number(i)||0;var s=t.length-i;n?(n=Number(n))>s&&(n=s):n=s;var A=e.length;if(A%2!=0)throw new TypeError("Invalid hex string");n>A/2&&(n=A/2);for(var r=0;r<n;++r){var o=parseInt(e.substr(2*r,2),16);if(isNaN(o))return r;t[i+r]=o}return r}function Ze(t,e,i,n){return vi(bi(e,t.length-i),t,i,n)}function $e(t,e,i,n){return vi(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function ti(t,e,i,n){return $e(t,e,i,n)}function ei(t,e,i,n){return vi(yi(e),t,i,n)}function ii(t,e,i,n){return vi(function(t,e){for(var i,n,s,A=[],r=0;r<t.length&&!((e-=2)<0);++r)i=t.charCodeAt(r),n=i>>8,s=i%256,A.push(s),A.push(n);return A}(e,t.length-i),t,i,n)}function ni(t,e,i){return 0===e&&i===t.length?Qe(t):Qe(t.slice(e,i))}function si(t,e,i){i=Math.min(t.length,i);for(var n=[],s=e;s<i;){var A,r,o,a,h=t[s],l=null,d=h>239?4:h>223?3:h>191?2:1;if(s+d<=i)switch(d){case 1:h<128&&(l=h);break;case 2:128==(192&(A=t[s+1]))&&(a=(31&h)<<6|63&A)>127&&(l=a);break;case 3:A=t[s+1],r=t[s+2],128==(192&A)&&128==(192&r)&&(a=(15&h)<<12|(63&A)<<6|63&r)>2047&&(a<55296||a>57343)&&(l=a);break;case 4:A=t[s+1],r=t[s+2],o=t[s+3],128==(192&A)&&128==(192&r)&&128==(192&o)&&(a=(15&h)<<18|(63&A)<<12|(63&r)<<6|63&o)>65535&&a<1114112&&(l=a)}null===l?(l=65533,d=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),s+=d}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return i}(n)}Le.TYPED_ARRAY_SUPPORT=void 0===we.TYPED_ARRAY_SUPPORT||we.TYPED_ARRAY_SUPPORT,Re(),Le.poolSize=8192,Le._augment=function(t){return t.__proto__=Le.prototype,t},Le.from=function(t,e,i){return Fe(null,t,e,i)},Le.TYPED_ARRAY_SUPPORT&&(Le.prototype.__proto__=Uint8Array.prototype,Le.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Le[Symbol.species]),Le.alloc=function(t,e,i){return function(t,e,i,n){return Me(e),e<=0?ze(t,e):void 0!==i?"string"==typeof n?ze(t,e).fill(i,n):ze(t,e).fill(i):ze(t,e)}(null,t,e,i)},Le.allocUnsafe=function(t){return Pe(null,t)},Le.allocUnsafeSlow=function(t){return Pe(null,t)},Le.isBuffer=function(t){return null!=t&&(!!t._isBuffer||_i(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&_i(t.slice(0,0))}(t))},Le.compare=function(t,e){if(!Ye(t)||!Ye(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,s=0,A=Math.min(i,n);s<A;++s)if(t[s]!==e[s]){i=t[s],n=e[s];break}return i<n?-1:n<i?1:0},Le.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Le.concat=function(t,e){if(!Oe(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Le.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=Le.allocUnsafe(e),s=0;for(i=0;i<t.length;++i){var A=t[i];if(!Ye(A))throw new TypeError('"list" argument must be an Array of Buffers');A.copy(n,s),s+=A.length}return n},Le.byteLength=Ge,Le.prototype._isBuffer=!0,Le.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Ke(this,e,e+1);return this},Le.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Ke(this,e,e+3),Ke(this,e+1,e+2);return this},Le.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Ke(this,e,e+7),Ke(this,e+1,e+6),Ke(this,e+2,e+5),Ke(this,e+3,e+4);return this},Le.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?si(this,0,t):He.apply(this,arguments)},Le.prototype.equals=function(t){if(!Ye(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Le.compare(this,t)},Le.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},Le.prototype.compare=function(t,e,i,n,s){if(!Ye(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),e<0||i>t.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&e>=i)return 0;if(n>=s)return-1;if(e>=i)return 1;if(this===t)return 0;for(var A=(s>>>=0)-(n>>>=0),r=(i>>>=0)-(e>>>=0),o=Math.min(A,r),a=this.slice(n,s),h=t.slice(e,i),l=0;l<o;++l)if(a[l]!==h[l]){A=a[l],r=h[l];break}return A<r?-1:r<A?1:0},Le.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},Le.prototype.indexOf=function(t,e,i){return je(this,t,e,i,!0)},Le.prototype.lastIndexOf=function(t,e,i){return je(this,t,e,i,!1)},Le.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var s=this.length-e;if((void 0===i||i>s)&&(i=s),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var A=!1;;)switch(n){case"hex":return Xe(this,t,e,i);case"utf8":case"utf-8":return Ze(this,t,e,i);case"ascii":return $e(this,t,e,i);case"latin1":case"binary":return ti(this,t,e,i);case"base64":return ei(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ii(this,t,e,i);default:if(A)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),A=!0}},Le.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ai(t,e,i){var n="";i=Math.min(t.length,i);for(var s=e;s<i;++s)n+=String.fromCharCode(127&t[s]);return n}function ri(t,e,i){var n="";i=Math.min(t.length,i);for(var s=e;s<i;++s)n+=String.fromCharCode(t[s]);return n}function oi(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var s="",A=e;A<i;++A)s+=mi(t[A]);return s}function ai(t,e,i){for(var n=t.slice(e,i),s="",A=0;A<n.length;A+=2)s+=String.fromCharCode(n[A]+256*n[A+1]);return s}function hi(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function li(t,e,i,n,s,A){if(!Ye(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>s||e<A)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function di(t,e,i,n){e<0&&(e=65535+e+1);for(var s=0,A=Math.min(t.length-i,2);s<A;++s)t[i+s]=(e&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function pi(t,e,i,n){e<0&&(e=4294967295+e+1);for(var s=0,A=Math.min(t.length-i,4);s<A;++s)t[i+s]=e>>>8*(n?s:3-s)&255}function ci(t,e,i,n,s,A){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function ui(t,e,i,n,s){return s||ci(t,0,i,4),Te(t,e,i,n,23,4),i+4}function fi(t,e,i,n,s){return s||ci(t,0,i,8),Te(t,e,i,n,52,8),i+8}Le.prototype.slice=function(t,e){var i,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),Le.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=Le.prototype;else{var s=e-t;i=new Le(s,void 0);for(var A=0;A<s;++A)i[A]=this[A+t]}return i},Le.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||hi(t,e,this.length);for(var n=this[t],s=1,A=0;++A<e&&(s*=256);)n+=this[t+A]*s;return n},Le.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||hi(t,e,this.length);for(var n=this[t+--e],s=1;e>0&&(s*=256);)n+=this[t+--e]*s;return n},Le.prototype.readUInt8=function(t,e){return e||hi(t,1,this.length),this[t]},Le.prototype.readUInt16LE=function(t,e){return e||hi(t,2,this.length),this[t]|this[t+1]<<8},Le.prototype.readUInt16BE=function(t,e){return e||hi(t,2,this.length),this[t]<<8|this[t+1]},Le.prototype.readUInt32LE=function(t,e){return e||hi(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Le.prototype.readUInt32BE=function(t,e){return e||hi(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Le.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||hi(t,e,this.length);for(var n=this[t],s=1,A=0;++A<e&&(s*=256);)n+=this[t+A]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*e)),n},Le.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||hi(t,e,this.length);for(var n=e,s=1,A=this[t+--n];n>0&&(s*=256);)A+=this[t+--n]*s;return A>=(s*=128)&&(A-=Math.pow(2,8*e)),A},Le.prototype.readInt8=function(t,e){return e||hi(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Le.prototype.readInt16LE=function(t,e){e||hi(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},Le.prototype.readInt16BE=function(t,e){e||hi(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},Le.prototype.readInt32LE=function(t,e){return e||hi(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Le.prototype.readInt32BE=function(t,e){return e||hi(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Le.prototype.readFloatLE=function(t,e){return e||hi(t,4,this.length),Ue(this,t,!0,23,4)},Le.prototype.readFloatBE=function(t,e){return e||hi(t,4,this.length),Ue(this,t,!1,23,4)},Le.prototype.readDoubleLE=function(t,e){return e||hi(t,8,this.length),Ue(this,t,!0,52,8)},Le.prototype.readDoubleBE=function(t,e){return e||hi(t,8,this.length),Ue(this,t,!1,52,8)},Le.prototype.writeUIntLE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||li(this,t,e,i,Math.pow(2,8*i)-1,0);var s=1,A=0;for(this[e]=255&t;++A<i&&(s*=256);)this[e+A]=t/s&255;return e+i},Le.prototype.writeUIntBE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||li(this,t,e,i,Math.pow(2,8*i)-1,0);var s=i-1,A=1;for(this[e+s]=255&t;--s>=0&&(A*=256);)this[e+s]=t/A&255;return e+i},Le.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||li(this,t,e,1,255,0),Le.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},Le.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||li(this,t,e,2,65535,0),Le.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):di(this,t,e,!0),e+2},Le.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||li(this,t,e,2,65535,0),Le.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):di(this,t,e,!1),e+2},Le.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||li(this,t,e,4,4294967295,0),Le.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):pi(this,t,e,!0),e+4},Le.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||li(this,t,e,4,4294967295,0),Le.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):pi(this,t,e,!1),e+4},Le.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var s=Math.pow(2,8*i-1);li(this,t,e,i,s-1,-s)}var A=0,r=1,o=0;for(this[e]=255&t;++A<i&&(r*=256);)t<0&&0===o&&0!==this[e+A-1]&&(o=1),this[e+A]=(t/r>>0)-o&255;return e+i},Le.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var s=Math.pow(2,8*i-1);li(this,t,e,i,s-1,-s)}var A=i-1,r=1,o=0;for(this[e+A]=255&t;--A>=0&&(r*=256);)t<0&&0===o&&0!==this[e+A+1]&&(o=1),this[e+A]=(t/r>>0)-o&255;return e+i},Le.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||li(this,t,e,1,127,-128),Le.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},Le.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||li(this,t,e,2,32767,-32768),Le.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):di(this,t,e,!0),e+2},Le.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||li(this,t,e,2,32767,-32768),Le.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):di(this,t,e,!1),e+2},Le.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||li(this,t,e,4,2147483647,-2147483648),Le.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):pi(this,t,e,!0),e+4},Le.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||li(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),Le.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):pi(this,t,e,!1),e+4},Le.prototype.writeFloatLE=function(t,e,i){return ui(this,t,e,!0,i)},Le.prototype.writeFloatBE=function(t,e,i){return ui(this,t,e,!1,i)},Le.prototype.writeDoubleLE=function(t,e,i){return fi(this,t,e,!0,i)},Le.prototype.writeDoubleBE=function(t,e,i){return fi(this,t,e,!1,i)},Le.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var s,A=n-i;if(this===t&&i<e&&e<n)for(s=A-1;s>=0;--s)t[s+e]=this[s+i];else if(A<1e3||!Le.TYPED_ARRAY_SUPPORT)for(s=0;s<A;++s)t[s+e]=this[s+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+A),e);return A},Le.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var s=t.charCodeAt(0);s<256&&(t=s)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Le.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var A;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(A=e;A<i;++A)this[A]=t;else{var r=Ye(t)?t:bi(new Le(t,n).toString()),o=r.length;for(A=0;A<i-e;++A)this[A+e]=r[A%o]}return this};var gi=/[^+\/0-9A-Za-z-_]/g;function mi(t){return t<16?"0"+t.toString(16):t.toString(16)}function bi(t,e){var i;e=e||1/0;for(var n=t.length,s=null,A=[],r=0;r<n;++r){if((i=t.charCodeAt(r))>55295&&i<57344){if(!s){if(i>56319){(e-=3)>-1&&A.push(239,191,189);continue}if(r+1===n){(e-=3)>-1&&A.push(239,191,189);continue}s=i;continue}if(i<56320){(e-=3)>-1&&A.push(239,191,189),s=i;continue}i=65536+(s-55296<<10|i-56320)}else s&&(e-=3)>-1&&A.push(239,191,189);if(s=null,i<128){if((e-=1)<0)break;A.push(i)}else if(i<2048){if((e-=2)<0)break;A.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;A.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;A.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return A}function yi(t){return function(t){var e,i,n,s,A,r;Ie||ke();var o=t.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");A="="===t[o-2]?2:"="===t[o-1]?1:0,r=new xe(3*o/4-A),n=A>0?o-4:o;var a=0;for(e=0,i=0;e<n;e+=4,i+=3)s=Ve[t.charCodeAt(e)]<<18|Ve[t.charCodeAt(e+1)]<<12|Ve[t.charCodeAt(e+2)]<<6|Ve[t.charCodeAt(e+3)],r[a++]=s>>16&255,r[a++]=s>>8&255,r[a++]=255&s;return 2===A?(s=Ve[t.charCodeAt(e)]<<2|Ve[t.charCodeAt(e+1)]>>4,r[a++]=255&s):1===A&&(s=Ve[t.charCodeAt(e)]<<10|Ve[t.charCodeAt(e+1)]<<4|Ve[t.charCodeAt(e+2)]>>2,r[a++]=s>>8&255,r[a++]=255&s),r}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(gi,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function vi(t,e,i,n){for(var s=0;s<n&&!(s+i>=e.length||s>=t.length);++s)e[s+i]=t[s];return s}function _i(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}const Ei="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),Bi=ne.WebSocket||ne.MozWebSocket,Ci="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const wi={websocket:class extends he{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,i=Ci?{}:se(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=Ci?new Bi(t,e,i):e?new Bi(t,e):new Bi(t)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const i=t[e],n=e===t.length-1;Ht(i,this.supportsBinary,t=>{try{this.ws.send(t)}catch(t){}n&&Ei(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let i="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(i=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=ge()),this.supportsBinary||(t.b64=1);const n=me(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(n.length?"?"+n:"")}check(){return!!Bi}},polling:class extends he{constructor(t){if(super(t),this.polling=!1,"undefined"!=typeof location){const e="https:"===location.protocol;let i=location.port;i||(i=e?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||i!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=Ee&&!e}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){((t,e)=>{const i=t.split(ee),n=[];for(let t=0;t<i.length;t++){const s=Zt(i[t],e);if(n.push(s),"error"===s.type)break}return n})(t,this.socket.binaryType).forEach(t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,((t,e)=>{const i=t.length,n=new Array(i);let s=0;t.forEach((t,A)=>{Ht(t,!1,t=>{n[A]=t,++s===i&&e(n.join(ee))})})})(t,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let i="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=ge()),this.supportsBinary||t.sid||(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(i=":"+this.opts.port);const n=me(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(n.length?"?"+n:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new Be(this.uri(),t)}doWrite(t,e){const i=this.request({method:"POST",data:t});i.on("success",e),i.on("error",(t,e)=>{this.onError("xhr post error",t,e)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(t,e)=>{this.onError("xhr poll error",t,e)}),this.pollXhr=t}}},qi=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Vi=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function xi(t){const e=t,i=t.indexOf("["),n=t.indexOf("]");-1!=i&&-1!=n&&(t=t.substring(0,i)+t.substring(i,n).replace(/:/g,";")+t.substring(n,t.length));let s=qi.exec(t||""),A={},r=14;for(;r--;)A[Vi[r]]=s[r]||"";return-1!=i&&-1!=n&&(A.source=e,A.host=A.host.substring(1,A.host.length-1).replace(/;/g,":"),A.authority=A.authority.replace("[","").replace("]","").replace(/;/g,":"),A.ipv6uri=!0),A.pathNames=function(t,e){const i=e.replace(/\/{2,9}/g,"/").split("/");"/"!=e.slice(0,1)&&0!==e.length||i.splice(0,1);"/"==e.slice(-1)&&i.splice(i.length-1,1);return i}(0,A.path),A.queryKey=function(t,e){const i={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,n){e&&(i[e]=n)})),i}(0,A.query),A}class Ii extends ie{constructor(t,e={}){super(),this.writeBuffer=[],t&&"object"==typeof t&&(e=t,t=null),t?(t=xi(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=xi(e.host).host),oe(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(t){let e={},i=t.split("&");for(let t=0,n=i.length;t<n;t++){let n=i[t].split("=");e[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return e}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);const i=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new wi[t](i)}open(){let t;if(this.opts.rememberUpgrade&&Ii.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(t){let e=this.createTransport(t),i=!1;Ii.priorWebsocketSuccess=!1;const n=()=>{i||(e.send([{type:"ping",data:"probe"}]),e.once("packet",t=>{if(!i)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;Ii.priorWebsocketSuccess="websocket"===e.name,this.transport.pause(()=>{i||"closed"!==this.readyState&&(h(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}}))};function s(){i||(i=!0,h(),e.close(),e=null)}const A=t=>{const i=new Error("probe error: "+t);i.transport=e.name,s(),this.emitReserved("upgradeError",i)};function r(){A("transport closed")}function o(){A("socket closed")}function a(t){e&&t.name!==e.name&&s()}const h=()=>{e.removeListener("open",n),e.removeListener("error",A),e.removeListener("close",r),this.off("close",o),this.off("upgrading",a)};e.once("open",n),e.once("error",A),e.once("close",r),this.once("close",o),this.once("upgrading",a),e.open()}onOpen(){if(this.readyState="open",Ii.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let i=0;i<this.writeBuffer.length;i++){const n=this.writeBuffer[i].data;if(n&&(t+="string"==typeof(e=n)?function(t){let e=0,i=0;for(let n=0,s=t.length;n<s;n++)e=t.charCodeAt(n),e<128?i+=1:e<2048?i+=2:e<55296||e>=57344?i+=3:(n++,i+=4);return i}(e):Math.ceil(1.33*(e.byteLength||e.size))),i>0&&t>this.maxPayload)return this.writeBuffer.slice(0,i);t+=2}var e;return this.writeBuffer}write(t,e,i){return this.sendPacket("message",t,e,i),this}send(t,e,i){return this.sendPacket("message",t,e,i),this}sendPacket(t,e,i,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof i&&(n=i,i=null),"closing"===this.readyState||"closed"===this.readyState)return;(i=i||{}).compress=!1!==i.compress;const s={type:t,data:e,options:i};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},i=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}onError(t){Ii.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let i=0;const n=t.length;for(;i<n;i++)~this.transports.indexOf(t[i])&&e.push(t[i]);return e}}Ii.protocol=4;const ki="function"==typeof ArrayBuffer,Si=Object.prototype.toString,Qi="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Si.call(Blob),Ui="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Si.call(File);function Ti(t){return ki&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||Qi&&t instanceof Blob||Ui&&t instanceof File}function Di(t){const e=[],i=t.data,n=t;return n.data=function t(e,i){if(!e)return e;if(Ti(e)){const t={_placeholder:!0,num:i.length};return i.push(e),t}if(Array.isArray(e)){const n=new Array(e.length);for(let s=0;s<e.length;s++)n[s]=t(e[s],i);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=t(e[s],i));return n}return e}(i,e),n.attachments=e.length,{packet:n,buffers:e}}function Oi(t,e){return t.data=function t(e,i){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<i.length)return i[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=t(e[n],i);else if("object"==typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=t(e[n],i));return e}(t.data,e),delete t.attachments,t}var Ri;!function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(Ri||(Ri={}));class zi extends ie{constructor(t){super(),this.reviver=t}add(t){let e;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const i=e.type===Ri.BINARY_EVENT;i||e.type===Ri.BINARY_ACK?(e.type=i?Ri.EVENT:Ri.ACK,this.reconstructor=new Li(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!Ti(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const i={type:Number(t.charAt(0))};if(void 0===Ri[i.type])throw new Error("unknown packet type "+i.type);if(i.type===Ri.BINARY_EVENT||i.type===Ri.BINARY_ACK){const n=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const s=t.substring(n,e);if(s!=Number(s)||"-"!==t.charAt(e))throw new Error("Illegal attachments");i.attachments=Number(s)}if("/"===t.charAt(e+1)){const n=e+1;for(;++e;){if(","===t.charAt(e))break;if(e===t.length)break}i.nsp=t.substring(n,e)}else i.nsp="/";const n=t.charAt(e+1);if(""!==n&&Number(n)==n){const n=e+1;for(;++e;){const i=t.charAt(e);if(null==i||Number(i)!=i){--e;break}if(e===t.length)break}i.id=Number(t.substring(n,e+1))}if(t.charAt(++e)){const n=this.tryParse(t.substr(e));if(!zi.isPayloadValid(i.type,n))throw new Error("invalid payload");i.data=n}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}}static isPayloadValid(t,e){switch(t){case Ri.CONNECT:return"object"==typeof e;case Ri.DISCONNECT:return void 0===e;case Ri.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case Ri.EVENT:case Ri.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case Ri.ACK:case Ri.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Li{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=Oi(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}var Fi=Object.freeze({__proto__:null,protocol:5,get PacketType(){return Ri},Encoder:class{constructor(t){this.replacer=t}encode(t){return t.type!==Ri.EVENT&&t.type!==Ri.ACK||!function t(e,i){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let i=0,n=e.length;i<n;i++)if(t(e[i]))return!0;return!1}if(Ti(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return t(e.toJSON(),!0);for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t(e[i]))return!0;return!1}(t)?[this.encodeAsString(t)]:this.encodeAsBinary({type:t.type===Ri.EVENT?Ri.BINARY_EVENT:Ri.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id})}encodeAsString(t){let e=""+t.type;return t.type!==Ri.BINARY_EVENT&&t.type!==Ri.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=Di(t),i=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(i),n}},Decoder:zi});function Mi(t,e,i){return t.on(e,i),function(){t.off(e,i)}}const Pi=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Ni extends ie{constructor(t,e,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Mi(t,"open",this.onopen.bind(this)),Mi(t,"packet",this.onpacket.bind(this)),Mi(t,"error",this.onerror.bind(this)),Mi(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(Pi.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const i={type:Ri.EVENT,data:e,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]){const t=this.ids++,n=e.pop();this._registerAckCallback(t,n),i.id=t}const n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(t,e){var i;const n=null!==(i=this.flags.timeout)&&void 0!==i?i:this._opts.ackTimeout;if(void 0===n)return void(this.acks[t]=e);const s=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))},n);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(s),e.apply(this,[null,...t])}}emitWithAck(t,...e){const i=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise((n,s)=>{e.push((t,e)=>i?t?s(t):n(e):n(t)),this.emit(t,...e)})}_addToQueue(t){let e;"function"==typeof t[t.length-1]&&(e=t.pop());const i={id:this.ids++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((t,...n)=>{if(i!==this._queue[0])return;return null!==t?i.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(t)):(this._queue.shift(),e&&e(null,...n)),i.pending=!1,this._drainQueue()}),this._queue.push(i),this._drainQueue()}_drainQueue(){if(0===this._queue.length)return;const t=this._queue[0];if(t.pending)return;t.pending=!0,t.tryCount++;const e=this.ids;this.ids=t.id,this.flags=t.flags,this.emit.apply(this,t.args),this.ids=e}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:Ri.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Ri.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ri.EVENT:case Ri.BINARY_EVENT:this.onevent(t);break;case Ri.ACK:case Ri.BINARY_ACK:this.onack(t);break;case Ri.DISCONNECT:this.ondisconnect();break;case Ri.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const i of e)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&"string"==typeof t[t.length-1]&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let i=!1;return function(...n){i||(i=!0,e.packet({type:Ri.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ri.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const i of e)i.apply(this,t.data)}}}function Ji(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Ji.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},Ji.prototype.reset=function(){this.attempts=0},Ji.prototype.setMin=function(t){this.ms=t},Ji.prototype.setMax=function(t){this.max=t},Ji.prototype.setJitter=function(t){this.jitter=t};class Yi extends ie{constructor(t,e){var i;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,oe(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(i=e.randomizationFactor)&&void 0!==i?i:.5),this.backoff=new Ji({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const n=e.parser||Fi;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Ii(this.uri,this.opts);const e=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const n=Mi(e,"open",(function(){i.onopen(),t&&t()})),s=Mi(e,"error",e=>{i.cleanup(),i._readyState="closed",this.emitReserved("error",e),t?t(e):i.maybeReconnectOnOpen()});if(!1!==this._timeout){const t=this._timeout;0===t&&n();const i=this.setTimeoutFn(()=>{n(),e.close(),e.emit("error",new Error("timeout"))},t);this.opts.autoUnref&&i.unref(),this.subs.push((function(){clearTimeout(i)}))}return this.subs.push(n),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Mi(t,"ping",this.onping.bind(this)),Mi(t,"data",this.ondata.bind(this)),Mi(t,"error",this.onerror.bind(this)),Mi(t,"close",this.onclose.bind(this)),Mi(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}ondecoded(t){Ei(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];return i||(i=new Ni(this,t,e),this.nsps[t]=i),this._autoConnect&&i.connect(),i}_destroy(t){const e=Object.keys(this.nsps);for(const t of e){if(this.nsps[t].active)return}this._close()}_packet(t){const e=this.encoder.encode(t);for(let i=0;i<e.length;i++)this.engine.write(e[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()}))},e);this.opts.autoUnref&&i.unref(),this.subs.push((function(){clearTimeout(i)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Gi={};function Hi(t,e){"object"==typeof t&&(e=t,t=void 0);const i=function(t,e="",i){let n=t;i=i||"undefined"!=typeof location&&location,null==t&&(t=i.protocol+"//"+i.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?i.protocol+t:i.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==i?i.protocol+"//"+t:"https://"+t),n=xi(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+e,n.href=n.protocol+"://"+s+(i&&i.port===n.port?"":":"+n.port),n}(t,(e=e||{}).path||"/socket.io"),n=i.source,s=i.id,A=i.path,r=Gi[s]&&A in Gi[s].nsps;let o;return e.forceNew||e["force new connection"]||!1===e.multiplex||r?o=new Yi(n,e):(Gi[s]||(Gi[s]=new Yi(n,e)),o=Gi[s]),i.query&&!e.query&&(e.query=i.queryKey),o.socket(i.path,e)}Object.assign(Hi,{Manager:Yi,Socket:Ni,io:Hi,connect:Hi});class Ki{constructor(t){this.config=Object.assign({baseURL:"https://loaclhost/",timeout:2e3,headers:{}},t)}get(t,e){return new Promise((i,n)=>{let s=new AbortController,A=`${this.config.baseURL}${t}`,r=setTimeout(()=>{s.abort()},this.config.timeout);if(e.query){A+="?";for(let t in e.query)A+=`${t}=${e.query[t]}&`;A=A.slice(0,A.length-1)}fetch(A,{method:"GET",mode:"cors",headers:this.config.header,signal:s.signal}).then(t=>(!1===t.ok&&(window.clearTimeout(r),n("error")),t.json()),t=>{window.clearTimeout(r),n(t)}).then(t=>{window.clearTimeout(r),i(t)})})}}class ji{constructor(t,e){var i;this.player=t,this.video=t.video,this.container=t.el,this.options=Object.assign({type:"http"},e),this.instance=new Ki({baseURL:"",timeout:null!==(i=this.options.timeout)&&void 0!==i?i:1e3}),this.init()}init(){this.onTimeupdate=this.onTimeupdate.bind(this),this.el=o("div.video-danmaku-container"),this.el.style.backgroundColor="#000",this.danmakuLoading=o("div"),h(this.danmakuLoading,["video-danmaku-loading-base","video-danmaku-loading","video-danmaku-shaking"]),this.danmakuLoading.innerHTML="<span>弹幕数据加载中...</span>",this.container.appendChild(this.el),this.el.appendChild(this.danmakuLoading),this.danmaku=new Ut(this.el,this.player),this.initTemlate(),this.initializeEvent(),"websocket"===this.options.type?this.initWebSocket():this.initHTTP()}initWebSocket(){const t=Hi(this.options.api,{transports:["websocket","polling"]});t.on("connect",()=>{this.setDanmakuSuccess(),this.player.video.addEventListener("timeupdate",e=>{t.emit(n.REQUEST_DANMAKU_DATA,{time:this.player.video.currentTime})}),t.on(n.SEND_DANMAKU_DATA,t=>{console.log(`接受到数据${JSON.stringify(t)},当前时间${this.player.video.currentTime}`);for(let e of t)this.danmaku.addData(e)})}),t.io.on("error",()=>{this.setDanmakuFail()}),t.connect()}initHTTP(){this.instance.get(this.options.api,{query:{time:0}}).then(t=>{this.setDanmakuSuccess(),this.player.video.addEventListener("timeupdate",this.onTimeupdate)},t=>{this.setDanmakuFail()})}setDanmakuFail(){this.el.style.backgroundColor="",this.danmakuLoading.childNodes[0].innerText="弹幕加载失败",l(this.danmakuLoading,["video-danmaku-loading","video-danmaku-shaking"]),setTimeout(()=>{h(this.danmakuLoading,["video-danmaku-loading-hide"])},3e3)}setDanmakuSuccess(){this.el.style.backgroundColor="",this.danmakuLoading.childNodes[0].innerText="弹幕加载成功",l(this.danmakuLoading,["video-danmaku-loading","video-danmaku-shaking"]),setTimeout(()=>{h(this.danmakuLoading,["video-danmaku-loading-hide"])},3e3)}initTemlate(){let t=this;this.danmakuInput=new Dt(this.player,null,"div"),this.danmakuSettings=new Mt(this.player),this.danmakuOpenClose=new Ot(this.player,null,"div"),this.player.use({install(e){e.mountComponent(t.danmakuOpenClose.id,t.danmakuOpenClose,{mode:{type:"BottomToolBar",pos:"medium"}}),e.mountComponent(t.danmakuInput.id,t.danmakuInput,{mode:{type:"BottomToolBar",pos:"medium"}})}})}initializeEvent(){this.video.addEventListener("seeking",t=>{this.onSeeked(t)}),this.video.addEventListener("seeked",t=>{this.onSeeked(t)}),this.video.addEventListener("waiting",()=>{this.danmaku.pause()}),this.video.addEventListener("abort",()=>{this.danmaku.flush()}),this.video.addEventListener("play",()=>{this.video.seeking||this.danmaku.resume()}),this.video.addEventListener("pause",()=>{this.video.seeking||this.danmaku.pause()}),this.video.addEventListener("canplay",()=>{this.danmaku.resume()}),this.video.addEventListener("timeupdate",()=>{this.danmaku.setPaused(!1)}),this.danmakuInput.on("sendData",(function(t){})),this.player.on("closeDanmaku",()=>{this.danmaku.close()}),this.player.on("openDanmaku",()=>{this.danmaku.open()}),this.player.on(n.RESIZE,()=>{this.setTrackNumber(),this.setRollDistance()})}onTimeupdate(t){this.instance.get(this.options.api,{query:{time:this.player.video.currentTime}}).then(t=>{for(let e of t)this.danmaku.addData(e)})}onSeeked(t){this.danmaku.flush()}setTrackNumber(t){this.danmaku.setTrackNumber(t||null)}setRollDistance(){this.danmaku.setRollDistance()}setOpacity(t){this.danmaku.setOpacity(t)}setFontSize(t){this.danmaku.setFontSize(t)}}Tt(".Niplayer_video-wrapper {\n  width: 100%;\n  height: 100%;\n  background-color: #000;\n  position: relative;\n  overflow: hidden;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  -webkit-transform: all 0.5s ease;\n          transform: all 0.5s ease;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.Niplayer_video-wrapper .pauseIcon {\n  position: absolute;\n  right: 10px;\n  bottom: calc(1.875rem + 0.625rem);\n}\n.Niplayer_video-wrapper .pauseIcon img {\n  width: 6.25rem;\n  height: auto;\n}\n.Niplayer_video-wrapper:focus {\n  outline: none;\n}\n.Niplayer_video-wrapper video {\n  max-width: 100%;\n  max-height: 100%;\n  outline: none;\n  -ms-touch-action: none;\n      touch-action: none;\n  -o-object-fit: cover;\n     object-fit: cover;\n  cursor: pointer;\n}\n.Niplayer_video-wrapper video:focus {\n  outline: none;\n}\n.Niplayer_video-wrapper .video-context-menu-info {\n  width: 31.25rem;\n  background-color: #000000e6;\n  padding: 0.625rem 1.25rem;\n  font-family: Noto Sans CJK SC DemiLight, Roboto, Segoe UI, Tahoma, Arial, Helvetica, sans-serif;\n  font-size: 0.875rem;\n  position: absolute;\n  top: 50px;\n  left: 50px;\n  color: #fff;\n  z-index: 5002;\n  border-radius: 10px;\n}\n.Niplayer_video-wrapper .video-context-menu-info .video-context-menu-infoTitleBox {\n  position: relative;\n}\n.Niplayer_video-wrapper .video-context-menu-info .video-context-menu-infoTitleBox .video-context-menu-infoTitle {\n  text-align: center;\n  font-size: 1.125rem;\n  border-bottom: 1px solid #fff;\n  width: 100%;\n}\n.Niplayer_video-wrapper .video-context-menu-info .video-context-menu-infoTitleBox .close {\n  position: absolute;\n  right: 5px;\n  top: 0px;\n  cursor: pointer;\n  font-size: 1rem;\n}\n.Niplayer_video-wrapper .video-context-menu-info .video-context-menu-infoItem {\n  margin-top: 10px;\n}\n.Niplayer_video-wrapper .video-context-menu-info .video-context-menu-infoItem .video-context-menu-infoSubtitle {\n  font-size: 0.875rem;\n  color: #fff;\n  text-align: right;\n}\n.Niplayer_video-wrapper .video-context-menu-info .video-context-menu-infoItem .video-context-menu-infoDesc {\n  margin-right: 10px;\n  text-align: left;\n  color: #fff;\n  opacity: 0.7;\n}\n.Niplayer_video-wrapper .video-context-menu {\n  display: none;\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 12.5rem;\n  border-radius: 3px;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  padding: 0.3125rem 0;\n  -webkit-backdrop-filter: saturate(180%) blur(20px);\n          backdrop-filter: saturate(180%) blur(20px);\n  background-color: #000000b3 !important;\n  z-index: 4002;\n}\n.Niplayer_video-wrapper .video-context-menu:last-child {\n  border-bottom: none !important;\n}\n.Niplayer_video-wrapper .video-context-menu .video-context-menu-item {\n  cursor: pointer;\n  color: #fff;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  text-shadow: 0 0 2px #00000080;\n  border-bottom: 1px solid #ffffff1a;\n  padding: 0.625rem 0.9375rem;\n  font-size: 0.75rem;\n  display: block;\n  overflow: hidden;\n}\n.Niplayer_video-wrapper .video-context-menu .video-context-menu-item:hover {\n  background-color: #ffffff1a;\n  color: #f00;\n}\n.Niplayer_video-wrapper .video-texttrack-container-showtoolbar {\n  bottom: calc(3.125rem + 0.3125rem) !important;\n}\n.Niplayer_video-wrapper .video-texttrack-container {\n  -webkit-transition: all 0.5s;\n  transition: all 0.5s;\n  position: absolute;\n  bottom: 0.3125rem;\n  color: #fe9200;\n  font-size: 1.25rem;\n}\n.Niplayer_video-wrapper .video-texttrack-container p {\n  word-break: break-all;\n  height: -webkit-fit-content;\n  height: -moz-fit-content;\n  height: fit-content;\n  margin: 5px 0 0;\n  line-height: 1.2;\n}\n.Niplayer_video-wrapper .video-toast-wrapper {\n  position: absolute;\n  text-align: center;\n  top: 0;\n  opacity: 0;\n  background-color: rgba(0, 0, 0, 0.75);\n  -webkit-transition: all 0.5s ease;\n  transition: all 0.5s ease;\n  border-radius: 10px;\n}\n.Niplayer_video-wrapper .video-toast-animate {\n  opacity: 1;\n}\n.Niplayer_video-wrapper .video-topbar {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 2.1875rem;\n  color: #fff;\n  -webkit-transition: all 0.3s ease;\n  transition: all 0.3s ease;\n  z-index: 4001;\n  padding: 0.3125rem 0.3125rem 0 0.3125rem;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n  -webkit-justify-content: space-between;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n  -webkit-flex-direction: row-reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n  height: 100%;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set {\n  height: auto;\n  max-height: 300px;\n  -webkit-backdrop-filter: saturate(180%) blur(20px);\n          backdrop-filter: saturate(180%) blur(20px);\n  border-radius: 3px;\n  font-size: 0.8125rem;\n  -webkit-transition: all 0.2s;\n  transition: all 0.2s;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-main,\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-subtitle,\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-playrate,\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-danmaku-main,\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-danmaku-opacity,\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-danmaku-range,\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-danmaku-size {\n  width: 100%;\n  -webkit-backdrop-filter: saturate(180%) blur(20px);\n          backdrop-filter: saturate(180%) blur(20px);\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-item {\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  height: 2.1875rem;\n  cursor: pointer;\n  color: #fffc;\n  -webkit-box-pack: justify;\n  -webkit-justify-content: space-between;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  line-height: 1;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  overflow: hidden;\n  width: 100%;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-item:hover {\n  color: #f00;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft {\n  white-space: nowrap;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft .video-subsettings-itemleft-icon {\n  height: 1.5rem;\n  width: 1.5rem;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-right: 10px;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft .video-subsettings-itemleft-icon svg {\n  height: 100%;\n  width: 100%;\n  fill: #fff;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft .video-subsettings-itemleft-text {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright {\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright .video-subsettings-itemright-tip {\n  white-space: nowrap;\n  color: #ffffff80;\n  margin-right: 5px;\n  font-size: 0.75rem;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright .video-subsettings-itemright-icon {\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  height: 1.5rem;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright .video-subsettings-itemright-icon svg {\n  width: 100%;\n  height: 100%;\n  fill: #fff;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings svg {\n  -webkit-transition: -webkit-transform 0.5s ease;\n  transition: -webkit-transform 0.5s ease;\n  transition: transform 0.5s ease;\n  transition: transform 0.5s ease, -webkit-transform 0.5s ease;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings .video-subsettings-set {\n  right: 0;\n  left: auto !important;\n  -webkit-transform: translateX(0) !important;\n          transform: translateX(0) !important;\n}\n.Niplayer_video-wrapper .video-topbar .video-topbar-right .video-subsettings-animate {\n  -webkit-transform: rotate(360deg);\n          transform: rotate(360deg);\n}\n.Niplayer_video-wrapper .video-topbar-hidden {\n  display: none;\n}\n.Niplayer_video-wrapper .video-toolbar {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  color: #fff;\n  padding: 0 0 0.625rem 0;\n  -webkit-transition: all 0.3s ease;\n  transition: all 0.3s ease;\n  z-index: 4001;\n  background-image: -webkit-gradient(linear, left bottom, left top, from(#000), color-stop(#0006), to(#0000));\n  background-image: linear-gradient(to top, #000, #0006, #0000);\n  background-position: bottom;\n  background-repeat: repeat-x;\n}\n.Niplayer_video-wrapper .video-toolbar .video-mediumbar {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n.Niplayer_video-wrapper .video-toolbar .video-mediumbar .video-mediumbar-left,\n.Niplayer_video-wrapper .video-toolbar .video-mediumbar .video-mediumbar-right {\n  height: 100%;\n}\n.Niplayer_video-wrapper .video-toolbar .video-mediumbar .video-mediumbar-medium {\n  -webkit-box-flex: 1;\n  -webkit-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n}\n.Niplayer_video-wrapper .video-toolbar .video-mediumbar .video-mediumbar-medium .video-progress {\n  width: calc(100% - 1.125rem);\n  margin: 0 auto;\n  height: 0.1875rem;\n  -webkit-transition: height 0.5s ease;\n  transition: height 0.5s ease;\n  background-color: hsla(0, 0%, 100%, 0.2);\n  cursor: pointer;\n  position: relative;\n}\n.Niplayer_video-wrapper .video-toolbar .video-mediumbar .video-mediumbar-medium .video-progress .video-progress-pretime {\n  position: absolute;\n  left: 0;\n  top: -28px;\n  height: 0.9375rem;\n  width: 2.1875rem;\n  background-color: rgba(0, 0, 0, 0.6);\n  color: #fff;\n  line-height: 15px;\n  text-align: center;\n  font-size: 0.625rem;\n  display: none;\n  z-index: 4002;\n}\n.Niplayer_video-wrapper .video-toolbar .video-mediumbar .video-mediumbar-medium .video-progress .video-progress-thumbnails {\n  position: absolute;\n  left: 0;\n  bottom: 15px;\n  width: 160px;\n  height: 90px;\n  background-color: rgba(255, 255, 255, 0.5);\n  display: none;\n  overflow: hidden;\n}\n.Niplayer_video-wrapper .video-toolbar .video-mediumbar .video-mediumbar-medium .video-progress .video-progress-buffered {\n  left: 0;\n  height: 100%;\n  width: 0;\n  position: absolute;\n  background-color: hsla(0, 0%, 100%, 0.3);\n  border-top-right-radius: 3px;\n  border-bottom-right-radius: 3px;\n}\n.Niplayer_video-wrapper .video-toolbar .video-mediumbar .video-mediumbar-medium .video-progress .video-progress-completed {\n  position: absolute;\n  background-color: #f00;\n  height: 100%;\n  border-top-right-radius: 3px;\n  border-bottom-right-radius: 3px;\n  left: 0;\n  width: 0;\n  z-index: 4002;\n}\n.Niplayer_video-wrapper .video-toolbar .video-mediumbar .video-mediumbar-medium .video-progress .video-progress-dot-hidden {\n  opacity: 0;\n}\n.Niplayer_video-wrapper .video-toolbar .video-mediumbar .video-mediumbar-medium .video-progress .video-progress-dot {\n  position: absolute;\n  left: 0px;\n  height: 0.75rem;\n  width: 0.75rem;\n  border-radius: 100%;\n  background-color: #f00;\n  cursor: pointer;\n  z-index: 4002;\n  top: 50%;\n  -webkit-transform: translateY(-50%);\n          transform: translateY(-50%);\n  -webkit-transition: opacity 0.6s ease;\n  transition: opacity 0.6s ease;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: justify;\n  -webkit-justify-content: space-between;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  padding: 0.625rem 0.3125rem 0 0.3125rem;\n  position: relative;\n  height: 1.875rem;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-left {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  height: 100%;\n  position: relative;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-left .video-start-pause {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  height: 100%;\n  margin-right: 5px;\n  cursor: pointer;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-left .video-volume {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  position: relative;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-left .video-volume .video-volume-set {\n  position: absolute;\n  width: 2rem;\n  height: 6.25rem;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-left .video-volume .video-volume-set .video-volume-show {\n  width: 100%;\n  height: 0.9375rem;\n  line-height: 15px;\n  text-align: center;\n  font-size: 0.75rem;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-left .video-volume .video-volume-set .video-volume-progress {\n  border-radius: 2px;\n  width: 0.1875rem;\n  padding-top: 5px;\n  height: calc(100% - 0.9375rem - 0.3125rem);\n  margin-left: 50%;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  background-color: #fff;\n  position: relative;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: reverse;\n  -webkit-flex-direction: column-reverse;\n      -ms-flex-direction: column-reverse;\n          flex-direction: column-reverse;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-left .video-volume .video-volume-set .video-volume-progress .video-volume-completed {\n  height: 50%;\n  background-color: #f00;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-left .video-volume .video-volume-set .video-volume-progress .video-volume-dot {\n  width: 0.75rem;\n  height: 0.75rem;\n  border-radius: 50%;\n  background-color: #f00;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  z-index: 4002;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-left .video-duration-time {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  font-size: 0.75rem;\n  opacity: 0.7;\n  margin-left: 0.3125rem;\n  height: 100%;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-left .video-duration-time:hover {\n  opacity: 1;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-medium {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-flex: 1;\n  -webkit-flex-grow: 1;\n      -ms-flex-positive: 1;\n          flex-grow: 1;\n  height: 100%;\n  position: relative;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  position: relative;\n  margin-right: 10px;\n  height: 100%;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-controller {\n  margin-left: 0.3125rem;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-playrate {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-right: 5px;\n  position: relative;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-playrate .video-playrate-set {\n  width: 4.375rem;\n  padding: 0;\n  margin: 0;\n  text-align: center;\n  list-style: none;\n  outline: none;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-playrate .video-playrate-set li {\n  color: #fff;\n  text-align: center;\n  height: 1.625rem;\n  line-height: 26px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  cursor: pointer;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-playrate .video-playrate-set li:hover {\n  background-color: #c9ccd0;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set {\n  height: auto;\n  max-height: 300px;\n  -webkit-backdrop-filter: saturate(180%) blur(20px);\n          backdrop-filter: saturate(180%) blur(20px);\n  border-radius: 3px;\n  font-size: 0.8125rem;\n  -webkit-transition: all 0.2s;\n  transition: all 0.2s;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-main,\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-subtitle,\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-playrate,\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-danmaku-main,\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-danmaku-opacity,\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-danmaku-range,\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-danmaku-size {\n  width: 100%;\n  -webkit-backdrop-filter: saturate(180%) blur(20px);\n          backdrop-filter: saturate(180%) blur(20px);\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-item {\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  height: 2.1875rem;\n  cursor: pointer;\n  color: #fffc;\n  -webkit-box-pack: justify;\n  -webkit-justify-content: space-between;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  line-height: 1;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  overflow: hidden;\n  width: 100%;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-item:hover {\n  color: #f00;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft {\n  white-space: nowrap;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft .video-subsettings-itemleft-icon {\n  height: 1.5rem;\n  width: 1.5rem;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-right: 10px;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft .video-subsettings-itemleft-icon svg {\n  height: 100%;\n  width: 100%;\n  fill: #fff;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft .video-subsettings-itemleft-text {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright {\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright .video-subsettings-itemright-tip {\n  white-space: nowrap;\n  color: #ffffff80;\n  margin-right: 5px;\n  font-size: 0.75rem;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright .video-subsettings-itemright-icon {\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  height: 1.5rem;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright .video-subsettings-itemright-icon svg {\n  width: 100%;\n  height: 100%;\n  fill: #fff;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings svg {\n  -webkit-transition: -webkit-transform 0.5s ease;\n  transition: -webkit-transform 0.5s ease;\n  transition: transform 0.5s ease;\n  transition: transform 0.5s ease, -webkit-transform 0.5s ease;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-subsettings-animate {\n  -webkit-transform: rotate(360deg);\n          transform: rotate(360deg);\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-screenshot svg {\n  -webkit-transition: -webkit-transform 0.25s ease;\n  transition: -webkit-transform 0.25s ease;\n  transition: transform 0.25s ease;\n  transition: transform 0.25s ease, -webkit-transform 0.25s ease;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-screenshot-animate {\n  -webkit-transform: scale(0.85);\n          transform: scale(0.85);\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-videoshot svg {\n  -webkit-transition: -webkit-transform 0.3s ease;\n  transition: -webkit-transform 0.3s ease;\n  transition: transform 0.3s ease;\n  transition: transform 0.3s ease, -webkit-transform 0.3s ease;\n}\n.Niplayer_video-wrapper .video-toolbar .video-bottombar .video-bottombar-right .video-videoshot-animate {\n  -webkit-transform: scale(0.75);\n          transform: scale(0.75);\n}\n.Niplayer_video-wrapper .video-toolbar-hidden {\n  -webkit-transform: translateY(47px);\n          transform: translateY(2.9375rem);\n}\n.Niplayer_video-wrapper .video-mask {\n  position: absolute;\n  background: transparent;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n}\n.Niplayer_video-wrapper .video-loading {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  z-index: 4000;\n  background-color: rgba(0, 0, 0, 0.4);\n  left: 0;\n  top: 0;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.Niplayer_video-wrapper .video-loading .video-loading-loadingbox {\n  height: 1.875rem;\n  width: 1.875rem;\n  border: 2px solid #fff;\n  border-top-color: transparent;\n  border-radius: 100%;\n  -webkit-animation: circle infinite 0.75s linear;\n          animation: circle infinite 0.75s linear;\n}\n.Niplayer_video-wrapper .video-loading .video-loading-errorbox {\n  height: 1.875rem;\n  width: 1.875rem;\n  background-color: red;\n}\n.Niplayer_video-wrapper .video-loading .video-loading-msgbox {\n  padding: 0 0.3125rem;\n  color: #fff;\n  font-size: 0.8125rem;\n  margin-top: 10px;\n}\n@-webkit-keyframes circle {\n  0% {\n    -webkit-transform: rotate(0);\n            transform: rotate(0);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes circle {\n  0% {\n    -webkit-transform: rotate(0);\n            transform: rotate(0);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.video-switch-on {\n  fill: #007aff !important;\n}\n.video-switch-off {\n  fill: #fff !important;\n}\n.Nplayer_controller {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  min-width: 1.875rem;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  padding: 0.25rem;\n  height: 100%;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  cursor: pointer;\n  color: #fff;\n  opacity: 0.9;\n  position: relative;\n}\n.Nplayer_controller:hover svg {\n  opacity: 1 !important;\n}\n.Nplayer_controller:hover .video-controller-span {\n  opacity: 1;\n}\n.Nplayer_controller .video-controller-span,\n.Nplayer_controller span {\n  width: 100%;\n  height: 100%;\n  font-weight: 550;\n  color: #fff;\n  padding: 0 0.3125rem;\n  font-size: 0.875rem;\n  line-height: 22px;\n  opacity: 0.85;\n}\n.Nplayer_controller .video-icon {\n  height: 100%;\n  width: 100%;\n}\n.Nplayer_controller .video-icon svg {\n  height: 100%;\n  width: 100%;\n  opacity: 0.8;\n}\n.Nplayer_controller .video-icon svg path {\n  fill: #fff;\n}\n.Nplayer_controller .video-set-hidden {\n  display: none !important;\n}\n.Nplayer_subsettings .video-subsettings-set {\n  height: auto;\n  max-height: 300px;\n  -webkit-backdrop-filter: saturate(180%) blur(20px);\n          backdrop-filter: saturate(180%) blur(20px);\n  border-radius: 3px;\n  font-size: 0.8125rem;\n  -webkit-transition: all 0.2s;\n  transition: all 0.2s;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-main,\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-subtitle,\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-playrate,\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-danmaku-main,\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-danmaku-opacity,\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-danmaku-range,\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-danmaku-size {\n  width: 100%;\n  -webkit-backdrop-filter: saturate(180%) blur(20px);\n          backdrop-filter: saturate(180%) blur(20px);\n}\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-item {\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  height: 2.1875rem;\n  cursor: pointer;\n  color: #fffc;\n  -webkit-box-pack: justify;\n  -webkit-justify-content: space-between;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  line-height: 1;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  overflow: hidden;\n  width: 100%;\n}\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-item:hover {\n  color: #f00;\n}\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft {\n  white-space: nowrap;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft .video-subsettings-itemleft-icon {\n  height: 1.5rem;\n  width: 1.5rem;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-right: 10px;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft .video-subsettings-itemleft-icon svg {\n  height: 100%;\n  width: 100%;\n  fill: #fff;\n}\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemleft .video-subsettings-itemleft-text {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright {\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright .video-subsettings-itemright-tip {\n  white-space: nowrap;\n  color: #ffffff80;\n  margin-right: 5px;\n  font-size: 0.75rem;\n}\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright .video-subsettings-itemright-icon {\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  height: 1.5rem;\n}\n.Nplayer_subsettings .video-subsettings-set .video-subsettings-item .video-subsettings-itemright .video-subsettings-itemright-icon svg {\n  width: 100%;\n  height: 100%;\n  fill: #fff;\n}\n.Nplayer_subsettings svg {\n  -webkit-transition: -webkit-transform 0.5s ease;\n  transition: -webkit-transform 0.5s ease;\n  transition: transform 0.5s ease;\n  transition: transform 0.5s ease, -webkit-transform 0.5s ease;\n}\n.video-controller {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  min-width: 1.875rem;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  padding: 0.25rem;\n  height: 100%;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  cursor: pointer;\n  color: #fff;\n  opacity: 0.9;\n  position: relative;\n}\n.video-controller:hover svg {\n  opacity: 1 !important;\n}\n.video-controller:hover .video-controller-span {\n  opacity: 1;\n}\n.video-controller .video-controller-span,\n.video-controller span {\n  width: 100%;\n  height: 100%;\n  font-weight: 550;\n  color: #fff;\n  padding: 0 0.3125rem;\n  font-size: 0.875rem;\n  line-height: 22px;\n  opacity: 0.85;\n}\n.video-controller .video-icon {\n  height: 100%;\n  width: 100%;\n}\n.video-controller .video-icon svg {\n  height: 100%;\n  width: 100%;\n  opacity: 0.8;\n}\n.video-controller .video-icon svg path {\n  fill: #fff;\n}\n.video-controller .video-set-hidden {\n  display: none !important;\n}\n.video-controller .video-set {\n  bottom: 3rem;\n  position: absolute;\n  background: rgba(21, 21, 21, 0.9);\n  text-align: center;\n  border-radius: 2px;\n  padding: 0.3125rem 0.3125rem;\n  left: 50%;\n  white-space: nowrap;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  -webkit-animation: slideIn 0.5s ease;\n          animation: slideIn 0.5s ease;\n  font-size: 0.8125rem;\n}\n@-webkit-keyframes slideIn {\n  from {\n    -webkit-transform: translate(-50%, 10px);\n            transform: translate(-50%, 0.625rem);\n  }\n  to {\n    -webkit-transform: translate(-50%, 0);\n            transform: translate(-50%, 0);\n  }\n}\n@keyframes slideIn {\n  from {\n    -webkit-transform: translate(-50%, 10px);\n            transform: translate(-50%, 0.625rem);\n  }\n  to {\n    -webkit-transform: translate(-50%, 0);\n            transform: translate(-50%, 0);\n  }\n}\n.video-topbar-controller {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  min-width: 1.875rem;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  padding: 0.25rem;\n  height: 100%;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  cursor: pointer;\n  color: #fff;\n  opacity: 0.9;\n  position: relative;\n}\n.video-topbar-controller:hover svg {\n  opacity: 1 !important;\n}\n.video-topbar-controller:hover .video-controller-span {\n  opacity: 1;\n}\n.video-topbar-controller .video-controller-span,\n.video-topbar-controller span {\n  width: 100%;\n  height: 100%;\n  font-weight: 550;\n  color: #fff;\n  padding: 0 0.3125rem;\n  font-size: 0.875rem;\n  line-height: 22px;\n  opacity: 0.85;\n}\n.video-topbar-controller .video-icon {\n  height: 100%;\n  width: 100%;\n}\n.video-topbar-controller .video-icon svg {\n  height: 100%;\n  width: 100%;\n  opacity: 0.8;\n}\n.video-topbar-controller .video-icon svg path {\n  fill: #fff;\n}\n.video-topbar-controller .video-set-hidden {\n  display: none !important;\n}\n.video-topbar-controller .video-set {\n  top: 32px;\n  position: absolute;\n  background: rgba(21, 21, 21, 0.9);\n  text-align: center;\n  border-radius: 2px;\n  padding: 0.3125rem 0.3125rem;\n  left: 50%;\n  white-space: nowrap;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  -webkit-animation: slideIn 0.5s ease;\n          animation: slideIn 0.5s ease;\n}\n.flex-vertical-center {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.flex-vertical-horizontal-center {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.flex-horizontal-center {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.toast-icon {\n  width: 1.5rem;\n  height: 1.5rem;\n  fill: #fff;\n  margin-right: 10px;\n}\n.toast-content {\n  text-align: center;\n  color: #fff;\n  font-size: 0.875rem;\n  border-radius: 5px;\n  padding: 0.625rem 1.25rem;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.toast-content svg {\n  width: 1.5rem;\n  height: 1.5rem;\n  fill: #fff;\n  margin-right: 10px;\n}\n.video-wrapper-fullpage {\n  position: fixed !important;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  z-index: 4000;\n}\n.fullscreen-mask {\n  position: fixed;\n  left: 0;\n  top: 0;\n  width: 100vw;\n  height: 100vh;\n  background: #000;\n  z-index: 4000;\n}\n.video-cross-screen {\n  position: fixed;\n  top: -375px;\n  left: 50%;\n  background: #000;\n  -webkit-transform-origin: 0;\n          transform-origin: 0;\n  -webkit-transform: rotate(90deg) translate3d(0, 0, 0);\n          transform: rotate(90deg) translate3d(0, 0, 0);\n}\n.video-screenshot-toast {\n  text-align: center;\n  color: #fff;\n  font-size: 0.875rem;\n  border-radius: 5px;\n  padding: 0.625rem 1.25rem;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.video-screenshot-toast svg {\n  width: 1.5rem;\n  height: 1.5rem;\n  fill: #fff;\n  margin-right: 10px;\n}\n.video-videoshot-inprogress-toast,\n.video-videoshot-success-toast {\n  text-align: center;\n  color: #fff;\n  font-size: 0.875rem;\n  border-radius: 5px;\n  padding: 0.625rem 1.25rem;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.video-videoshot-inprogress-toast svg,\n.video-videoshot-success-toast svg {\n  width: 1.5rem;\n  height: 1.5rem;\n  fill: #fff;\n  margin-right: 10px;\n}\n.video-videoshot-inprogress-toast svg {\n  -webkit-animation: countdown 0.5s ease infinite;\n          animation: countdown 0.5s ease infinite;\n}\n@-webkit-keyframes countdown {\n  0% {\n    -webkit-transform: rotate(0);\n            transform: rotate(0);\n  }\n  50% {\n    -webkit-transform: rotate(180deg);\n            transform: rotate(180deg);\n  }\n  100% {\n    -webkit-transform: rotate(180deg);\n            transform: rotate(180deg);\n  }\n}\n@keyframes countdown {\n  0% {\n    -webkit-transform: rotate(0);\n            transform: rotate(0);\n  }\n  50% {\n    -webkit-transform: rotate(180deg);\n            transform: rotate(180deg);\n  }\n  100% {\n    -webkit-transform: rotate(180deg);\n            transform: rotate(180deg);\n  }\n}\n");var Wi={};!function(t){var e,i,n=(e=new Date,i=4,{setLogLevel:function(t){i=t==this.debug?1:t==this.info?2:t==this.warn?3:(this.error,4)},debug:function(t,s){void 0===console.debug&&(console.debug=console.log),1>=i&&console.debug("["+n.getDurationString(new Date-e,1e3)+"]","["+t+"]",s)},log:function(t,e){this.debug(t.msg)},info:function(t,s){2>=i&&console.info("["+n.getDurationString(new Date-e,1e3)+"]","["+t+"]",s)},warn:function(t,s){3>=i&&console.warn("["+n.getDurationString(new Date-e,1e3)+"]","["+t+"]",s)},error:function(t,s){4>=i&&console.error("["+n.getDurationString(new Date-e,1e3)+"]","["+t+"]",s)}});n.getDurationString=function(t,e){var i;function n(t,e){for(var i=(""+t).split(".");i[0].length<e;)i[0]="0"+i[0];return i.join(".")}t<0?(i=!0,t=-t):i=!1;var s=t/(e||1),A=Math.floor(s/3600);s-=3600*A;var r=Math.floor(s/60),o=1e3*(s-=60*r);return o-=1e3*(s=Math.floor(s)),o=Math.floor(o),(i?"-":"")+A+":"+n(r,2)+":"+n(s,2)+"."+n(o,3)},n.printRanges=function(t){var e=t.length;if(e>0){for(var i="",s=0;s<e;s++)s>0&&(i+=","),i+="["+n.getDurationString(t.start(s))+","+n.getDurationString(t.end(s))+"]";return i}return"(empty)"},t.Log=n;var s=function(t){if(!(t instanceof ArrayBuffer))throw"Needs an array buffer";this.buffer=t,this.dataview=new DataView(t),this.position=0};s.prototype.getPosition=function(){return this.position},s.prototype.getEndPosition=function(){return this.buffer.byteLength},s.prototype.getLength=function(){return this.buffer.byteLength},s.prototype.seek=function(t){var e=Math.max(0,Math.min(this.buffer.byteLength,t));return this.position=isNaN(e)||!isFinite(e)?0:e,!0},s.prototype.isEos=function(){return this.getPosition()>=this.getEndPosition()},s.prototype.readAnyInt=function(t,e){var i=0;if(this.position+t<=this.buffer.byteLength){switch(t){case 1:i=e?this.dataview.getInt8(this.position):this.dataview.getUint8(this.position);break;case 2:i=e?this.dataview.getInt16(this.position):this.dataview.getUint16(this.position);break;case 3:if(e)throw"No method for reading signed 24 bits values";i=this.dataview.getUint8(this.position)<<16,i|=this.dataview.getUint8(this.position+1)<<8,i|=this.dataview.getUint8(this.position+2);break;case 4:i=e?this.dataview.getInt32(this.position):this.dataview.getUint32(this.position);break;case 8:if(e)throw"No method for reading signed 64 bits values";i=this.dataview.getUint32(this.position)<<32,i|=this.dataview.getUint32(this.position+4);break;default:throw"readInt method not implemented for size: "+t}return this.position+=t,i}throw"Not enough bytes in buffer"},s.prototype.readUint8=function(){return this.readAnyInt(1,!1)},s.prototype.readUint16=function(){return this.readAnyInt(2,!1)},s.prototype.readUint24=function(){return this.readAnyInt(3,!1)},s.prototype.readUint32=function(){return this.readAnyInt(4,!1)},s.prototype.readUint64=function(){return this.readAnyInt(8,!1)},s.prototype.readString=function(t){if(this.position+t<=this.buffer.byteLength){for(var e="",i=0;i<t;i++)e+=String.fromCharCode(this.readUint8());return e}throw"Not enough bytes in buffer"},s.prototype.readCString=function(){for(var t=[];;){var e=this.readUint8();if(0===e)break;t.push(e)}return String.fromCharCode.apply(null,t)},s.prototype.readInt8=function(){return this.readAnyInt(1,!0)},s.prototype.readInt16=function(){return this.readAnyInt(2,!0)},s.prototype.readInt32=function(){return this.readAnyInt(4,!0)},s.prototype.readInt64=function(){return this.readAnyInt(8,!1)},s.prototype.readUint8Array=function(t){for(var e=new Uint8Array(t),i=0;i<t;i++)e[i]=this.readUint8();return e},s.prototype.readInt16Array=function(t){for(var e=new Int16Array(t),i=0;i<t;i++)e[i]=this.readInt16();return e},s.prototype.readUint16Array=function(t){for(var e=new Int16Array(t),i=0;i<t;i++)e[i]=this.readUint16();return e},s.prototype.readUint32Array=function(t){for(var e=new Uint32Array(t),i=0;i<t;i++)e[i]=this.readUint32();return e},s.prototype.readInt32Array=function(t){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=this.readInt32();return e},t.MP4BoxStream=s;var A=function(t,e,i){this._byteOffset=e||0,t instanceof ArrayBuffer?this.buffer=t:"object"==typeof t?(this.dataView=t,e&&(this._byteOffset+=e)):this.buffer=new ArrayBuffer(t||0),this.position=0,this.endianness=null==i?A.LITTLE_ENDIAN:i};A.prototype={},A.prototype.getPosition=function(){return this.position},A.prototype._realloc=function(t){if(this._dynamicSize){var e=this._byteOffset+this.position+t,i=this._buffer.byteLength;if(e<=i)e>this._byteLength&&(this._byteLength=e);else{for(i<1&&(i=1);e>i;)i*=2;var n=new ArrayBuffer(i),s=new Uint8Array(this._buffer);new Uint8Array(n,0,s.length).set(s),this.buffer=n,this._byteLength=e}}},A.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var t=new ArrayBuffer(this._byteLength),e=new Uint8Array(t),i=new Uint8Array(this._buffer,0,e.length);e.set(i),this.buffer=t}},A.BIG_ENDIAN=!1,A.LITTLE_ENDIAN=!0,A.prototype._byteLength=0,Object.defineProperty(A.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(A.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(t){this._buffer=t,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(A.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(t){this._byteOffset=t,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(A.prototype,"dataView",{get:function(){return this._dataView},set:function(t){this._byteOffset=t.byteOffset,this._buffer=t.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+t.byteLength}}),A.prototype.seek=function(t){var e=Math.max(0,Math.min(this.byteLength,t));this.position=isNaN(e)||!isFinite(e)?0:e},A.prototype.isEof=function(){return this.position>=this._byteLength},A.prototype.mapUint8Array=function(t){this._realloc(1*t);var e=new Uint8Array(this._buffer,this.byteOffset+this.position,t);return this.position+=1*t,e},A.prototype.readInt32Array=function(t,e){t=null==t?this.byteLength-this.position/4:t;var i=new Int32Array(t);return A.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),A.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},A.prototype.readInt16Array=function(t,e){t=null==t?this.byteLength-this.position/2:t;var i=new Int16Array(t);return A.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),A.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},A.prototype.readInt8Array=function(t){t=null==t?this.byteLength-this.position:t;var e=new Int8Array(t);return A.memcpy(e.buffer,0,this.buffer,this.byteOffset+this.position,t*e.BYTES_PER_ELEMENT),this.position+=e.byteLength,e},A.prototype.readUint32Array=function(t,e){t=null==t?this.byteLength-this.position/4:t;var i=new Uint32Array(t);return A.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),A.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},A.prototype.readUint16Array=function(t,e){t=null==t?this.byteLength-this.position/2:t;var i=new Uint16Array(t);return A.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),A.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},A.prototype.readUint8Array=function(t){t=null==t?this.byteLength-this.position:t;var e=new Uint8Array(t);return A.memcpy(e.buffer,0,this.buffer,this.byteOffset+this.position,t*e.BYTES_PER_ELEMENT),this.position+=e.byteLength,e},A.prototype.readFloat64Array=function(t,e){t=null==t?this.byteLength-this.position/8:t;var i=new Float64Array(t);return A.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),A.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},A.prototype.readFloat32Array=function(t,e){t=null==t?this.byteLength-this.position/4:t;var i=new Float32Array(t);return A.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,t*i.BYTES_PER_ELEMENT),A.arrayToNative(i,null==e?this.endianness:e),this.position+=i.byteLength,i},A.prototype.readInt32=function(t){var e=this._dataView.getInt32(this.position,null==t?this.endianness:t);return this.position+=4,e},A.prototype.readInt16=function(t){var e=this._dataView.getInt16(this.position,null==t?this.endianness:t);return this.position+=2,e},A.prototype.readInt8=function(){var t=this._dataView.getInt8(this.position);return this.position+=1,t},A.prototype.readUint32=function(t){var e=this._dataView.getUint32(this.position,null==t?this.endianness:t);return this.position+=4,e},A.prototype.readUint16=function(t){var e=this._dataView.getUint16(this.position,null==t?this.endianness:t);return this.position+=2,e},A.prototype.readUint8=function(){var t=this._dataView.getUint8(this.position);return this.position+=1,t},A.prototype.readFloat32=function(t){var e=this._dataView.getFloat32(this.position,null==t?this.endianness:t);return this.position+=4,e},A.prototype.readFloat64=function(t){var e=this._dataView.getFloat64(this.position,null==t?this.endianness:t);return this.position+=8,e},A.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,A.memcpy=function(t,e,i,n,s){var A=new Uint8Array(t,e,s),r=new Uint8Array(i,n,s);A.set(r)},A.arrayToNative=function(t,e){return e==this.endianness?t:this.flipArrayEndianness(t)},A.nativeToEndian=function(t,e){return this.endianness==e?t:this.flipArrayEndianness(t)},A.flipArrayEndianness=function(t){for(var e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=0;i<t.byteLength;i+=t.BYTES_PER_ELEMENT)for(var n=i+t.BYTES_PER_ELEMENT-1,s=i;n>s;n--,s++){var A=e[s];e[s]=e[n],e[n]=A}return t},A.prototype.failurePosition=0,String.fromCharCodeUint8=function(t){for(var e=[],i=0;i<t.length;i++)e[i]=t[i];return String.fromCharCode.apply(null,e)},A.prototype.readString=function(t,e){return null==e||"ASCII"==e?String.fromCharCodeUint8.apply(null,[this.mapUint8Array(null==t?this.byteLength-this.position:t)]):new TextDecoder(e).decode(this.mapUint8Array(t))},A.prototype.readCString=function(t){var e=this.byteLength-this.position,i=new Uint8Array(this._buffer,this._byteOffset+this.position),n=e;null!=t&&(n=Math.min(t,e));for(var s=0;s<n&&0!==i[s];s++);var A=String.fromCharCodeUint8.apply(null,[this.mapUint8Array(s)]);return null!=t?this.position+=n-s:s!=e&&(this.position+=1),A};var r=Math.pow(2,32);A.prototype.readInt64=function(){return this.readInt32()*r+this.readUint32()},A.prototype.readUint64=function(){return this.readUint32()*r+this.readUint32()},A.prototype.readInt64=function(){return this.readUint32()*r+this.readUint32()},A.prototype.readUint24=function(){return(this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8()},t.DataStream=A,A.prototype.save=function(t){var e=new Blob([this.buffer]);if(!window.URL||!URL.createObjectURL)throw"DataStream.save: Can't create object URL.";var i=window.URL.createObjectURL(e),n=document.createElement("a");document.body.appendChild(n),n.setAttribute("href",i),n.setAttribute("download",t),n.setAttribute("target","_self"),n.click(),window.URL.revokeObjectURL(i)},A.prototype._dynamicSize=!0,Object.defineProperty(A.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(t){t||this._trimAlloc(),this._dynamicSize=t}}),A.prototype.shift=function(t){var e=new ArrayBuffer(this._byteLength-t),i=new Uint8Array(e),n=new Uint8Array(this._buffer,t,i.length);i.set(n),this.buffer=e,this.position-=t},A.prototype.writeInt32Array=function(t,e){if(this._realloc(4*t.length),t instanceof Int32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)A.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt32Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeInt32(t[i],e)},A.prototype.writeInt16Array=function(t,e){if(this._realloc(2*t.length),t instanceof Int16Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)A.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt16Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeInt16(t[i],e)},A.prototype.writeInt8Array=function(t){if(this._realloc(1*t.length),t instanceof Int8Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)A.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt8Array(t.length);else for(var e=0;e<t.length;e++)this.writeInt8(t[e])},A.prototype.writeUint32Array=function(t,e){if(this._realloc(4*t.length),t instanceof Uint32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)A.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint32Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeUint32(t[i],e)},A.prototype.writeUint16Array=function(t,e){if(this._realloc(2*t.length),t instanceof Uint16Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)A.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint16Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeUint16(t[i],e)},A.prototype.writeUint8Array=function(t){if(this._realloc(1*t.length),t instanceof Uint8Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)A.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint8Array(t.length);else for(var e=0;e<t.length;e++)this.writeUint8(t[e])},A.prototype.writeFloat64Array=function(t,e){if(this._realloc(8*t.length),t instanceof Float64Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)A.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapFloat64Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeFloat64(t[i],e)},A.prototype.writeFloat32Array=function(t,e){if(this._realloc(4*t.length),t instanceof Float32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)A.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapFloat32Array(t.length,e);else for(var i=0;i<t.length;i++)this.writeFloat32(t[i],e)},A.prototype.writeInt32=function(t,e){this._realloc(4),this._dataView.setInt32(this.position,t,null==e?this.endianness:e),this.position+=4},A.prototype.writeInt16=function(t,e){this._realloc(2),this._dataView.setInt16(this.position,t,null==e?this.endianness:e),this.position+=2},A.prototype.writeInt8=function(t){this._realloc(1),this._dataView.setInt8(this.position,t),this.position+=1},A.prototype.writeUint32=function(t,e){this._realloc(4),this._dataView.setUint32(this.position,t,null==e?this.endianness:e),this.position+=4},A.prototype.writeUint16=function(t,e){this._realloc(2),this._dataView.setUint16(this.position,t,null==e?this.endianness:e),this.position+=2},A.prototype.writeUint8=function(t){this._realloc(1),this._dataView.setUint8(this.position,t),this.position+=1},A.prototype.writeFloat32=function(t,e){this._realloc(4),this._dataView.setFloat32(this.position,t,null==e?this.endianness:e),this.position+=4},A.prototype.writeFloat64=function(t,e){this._realloc(8),this._dataView.setFloat64(this.position,t,null==e?this.endianness:e),this.position+=8},A.prototype.writeUCS2String=function(t,e,i){null==i&&(i=t.length);for(var n=0;n<t.length&&n<i;n++)this.writeUint16(t.charCodeAt(n),e);for(;n<i;n++)this.writeUint16(0)},A.prototype.writeString=function(t,e,i){var n=0;if(null==e||"ASCII"==e)if(null!=i){var s=Math.min(t.length,i);for(n=0;n<s;n++)this.writeUint8(t.charCodeAt(n));for(;n<i;n++)this.writeUint8(0)}else for(n=0;n<t.length;n++)this.writeUint8(t.charCodeAt(n));else this.writeUint8Array(new TextEncoder(e).encode(t.substring(0,i)))},A.prototype.writeCString=function(t,e){var i=0;if(null!=e){var n=Math.min(t.length,e);for(i=0;i<n;i++)this.writeUint8(t.charCodeAt(i));for(;i<e;i++)this.writeUint8(0)}else{for(i=0;i<t.length;i++)this.writeUint8(t.charCodeAt(i));this.writeUint8(0)}},A.prototype.writeStruct=function(t,e){for(var i=0;i<t.length;i+=2){var n=t[i+1];this.writeType(n,e[t[i]],e)}},A.prototype.writeType=function(t,e,i){var n;if("function"==typeof t)return t(this,e);if("object"==typeof t&&!(t instanceof Array))return t.set(this,e,i);var s=null,r="ASCII",o=this.position;switch("string"==typeof t&&/:/.test(t)&&(n=t.split(":"),t=n[0],s=parseInt(n[1])),"string"==typeof t&&/,/.test(t)&&(n=t.split(","),t=n[0],r=parseInt(n[1])),t){case"uint8":this.writeUint8(e);break;case"int8":this.writeInt8(e);break;case"uint16":this.writeUint16(e,this.endianness);break;case"int16":this.writeInt16(e,this.endianness);break;case"uint32":this.writeUint32(e,this.endianness);break;case"int32":this.writeInt32(e,this.endianness);break;case"float32":this.writeFloat32(e,this.endianness);break;case"float64":this.writeFloat64(e,this.endianness);break;case"uint16be":this.writeUint16(e,A.BIG_ENDIAN);break;case"int16be":this.writeInt16(e,A.BIG_ENDIAN);break;case"uint32be":this.writeUint32(e,A.BIG_ENDIAN);break;case"int32be":this.writeInt32(e,A.BIG_ENDIAN);break;case"float32be":this.writeFloat32(e,A.BIG_ENDIAN);break;case"float64be":this.writeFloat64(e,A.BIG_ENDIAN);break;case"uint16le":this.writeUint16(e,A.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(e,A.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(e,A.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(e,A.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(e,A.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(e,A.LITTLE_ENDIAN);break;case"cstring":this.writeCString(e,s);break;case"string":this.writeString(e,r,s);break;case"u16string":this.writeUCS2String(e,this.endianness,s);break;case"u16stringle":this.writeUCS2String(e,A.LITTLE_ENDIAN,s);break;case"u16stringbe":this.writeUCS2String(e,A.BIG_ENDIAN,s);break;default:if(3==t.length){for(var a=t[1],h=0;h<e.length;h++)this.writeType(a,e[h]);break}this.writeStruct(t,e)}null!=s&&(this.position=o,this._realloc(s),this.position=o+s)},A.prototype.writeUint64=function(t){var e=Math.floor(t/r);this.writeUint32(e),this.writeUint32(4294967295&t)},A.prototype.writeUint24=function(t){this.writeUint8((16711680&t)>>16),this.writeUint8((65280&t)>>8),this.writeUint8(255&t)},A.prototype.adjustUint32=function(t,e){var i=this.position;this.seek(t),this.writeUint32(e),this.seek(i)},A.prototype.mapInt32Array=function(t,e){this._realloc(4*t);var i=new Int32Array(this._buffer,this.byteOffset+this.position,t);return A.arrayToNative(i,null==e?this.endianness:e),this.position+=4*t,i},A.prototype.mapInt16Array=function(t,e){this._realloc(2*t);var i=new Int16Array(this._buffer,this.byteOffset+this.position,t);return A.arrayToNative(i,null==e?this.endianness:e),this.position+=2*t,i},A.prototype.mapInt8Array=function(t){this._realloc(1*t);var e=new Int8Array(this._buffer,this.byteOffset+this.position,t);return this.position+=1*t,e},A.prototype.mapUint32Array=function(t,e){this._realloc(4*t);var i=new Uint32Array(this._buffer,this.byteOffset+this.position,t);return A.arrayToNative(i,null==e?this.endianness:e),this.position+=4*t,i},A.prototype.mapUint16Array=function(t,e){this._realloc(2*t);var i=new Uint16Array(this._buffer,this.byteOffset+this.position,t);return A.arrayToNative(i,null==e?this.endianness:e),this.position+=2*t,i},A.prototype.mapFloat64Array=function(t,e){this._realloc(8*t);var i=new Float64Array(this._buffer,this.byteOffset+this.position,t);return A.arrayToNative(i,null==e?this.endianness:e),this.position+=8*t,i},A.prototype.mapFloat32Array=function(t,e){this._realloc(4*t);var i=new Float32Array(this._buffer,this.byteOffset+this.position,t);return A.arrayToNative(i,null==e?this.endianness:e),this.position+=4*t,i};var o=function(t){this.buffers=[],this.bufferIndex=-1,t&&(this.insertBuffer(t),this.bufferIndex=0)};(o.prototype=new A(new ArrayBuffer,0,A.BIG_ENDIAN)).initialized=function(){var t;return this.bufferIndex>-1||(this.buffers.length>0?0===(t=this.buffers[0]).fileStart?(this.buffer=t,this.bufferIndex=0,n.debug("MultiBufferStream","Stream ready for parsing"),!0):(n.warn("MultiBufferStream","The first buffer should have a fileStart of 0"),this.logBufferLevel(),!1):(n.warn("MultiBufferStream","No buffer to start parsing from"),this.logBufferLevel(),!1))},ArrayBuffer.concat=function(t,e){n.debug("ArrayBuffer","Trying to create a new buffer of size: "+(t.byteLength+e.byteLength));var i=new Uint8Array(t.byteLength+e.byteLength);return i.set(new Uint8Array(t),0),i.set(new Uint8Array(e),t.byteLength),i.buffer},o.prototype.reduceBuffer=function(t,e,i){var n;return(n=new Uint8Array(i)).set(new Uint8Array(t,e,i)),n.buffer.fileStart=t.fileStart+e,n.buffer.usedBytes=0,n.buffer},o.prototype.insertBuffer=function(t){for(var e=!0,i=0;i<this.buffers.length;i++){var s=this.buffers[i];if(t.fileStart<=s.fileStart){if(t.fileStart===s.fileStart){if(t.byteLength>s.byteLength){this.buffers.splice(i,1),i--;continue}n.warn("MultiBufferStream","Buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+") already appended, ignoring")}else t.fileStart+t.byteLength<=s.fileStart||(t=this.reduceBuffer(t,0,s.fileStart-t.fileStart)),n.debug("MultiBufferStream","Appending new buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+")"),this.buffers.splice(i,0,t),0===i&&(this.buffer=t);e=!1;break}if(t.fileStart<s.fileStart+s.byteLength){var A=s.fileStart+s.byteLength-t.fileStart,r=t.byteLength-A;if(!(r>0)){e=!1;break}t=this.reduceBuffer(t,A,r)}}e&&(n.debug("MultiBufferStream","Appending new buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+")"),this.buffers.push(t),0===i&&(this.buffer=t))},o.prototype.logBufferLevel=function(t){var e,i,s,A,r,o=[],a="";for(s=0,A=0,e=0;e<this.buffers.length;e++)i=this.buffers[e],0===e?(r={},o.push(r),r.start=i.fileStart,r.end=i.fileStart+i.byteLength,a+="["+r.start+"-"):r.end===i.fileStart?r.end=i.fileStart+i.byteLength:((r={}).start=i.fileStart,a+=o[o.length-1].end-1+"], ["+r.start+"-",r.end=i.fileStart+i.byteLength,o.push(r)),s+=i.usedBytes,A+=i.byteLength;o.length>0&&(a+=r.end-1+"]");var h=t?n.info:n.debug;0===this.buffers.length?h("MultiBufferStream","No more buffer in memory"):h("MultiBufferStream",this.buffers.length+" stored buffer(s) ("+s+"/"+A+" bytes), continuous ranges: "+a)},o.prototype.cleanBuffers=function(){var t,e;for(t=0;t<this.buffers.length;t++)(e=this.buffers[t]).usedBytes===e.byteLength&&(n.debug("MultiBufferStream","Removing buffer #"+t),this.buffers.splice(t,1),t--)},o.prototype.mergeNextBuffer=function(){var t;if(this.bufferIndex+1<this.buffers.length){if((t=this.buffers[this.bufferIndex+1]).fileStart===this.buffer.fileStart+this.buffer.byteLength){var e=this.buffer.byteLength,i=this.buffer.usedBytes,s=this.buffer.fileStart;return this.buffers[this.bufferIndex]=ArrayBuffer.concat(this.buffer,t),this.buffer=this.buffers[this.bufferIndex],this.buffers.splice(this.bufferIndex+1,1),this.buffer.usedBytes=i,this.buffer.fileStart=s,n.debug("ISOFile","Concatenating buffer for box parsing (length: "+e+"->"+this.buffer.byteLength+")"),!0}return!1}return!1},o.prototype.findPosition=function(t,e,i){var s,A=null,r=-1;for(s=!0===t?0:this.bufferIndex;s<this.buffers.length&&(A=this.buffers[s]).fileStart<=e;)r=s,i&&(A.fileStart+A.byteLength<=e?A.usedBytes=A.byteLength:A.usedBytes=e-A.fileStart,this.logBufferLevel()),s++;return-1!==r&&(A=this.buffers[r]).fileStart+A.byteLength>=e?(n.debug("MultiBufferStream","Found position in existing buffer #"+r),r):-1},o.prototype.findEndContiguousBuf=function(t){var e,i,n,s=void 0!==t?t:this.bufferIndex;if(i=this.buffers[s],this.buffers.length>s+1)for(e=s+1;e<this.buffers.length&&(n=this.buffers[e]).fileStart===i.fileStart+i.byteLength;e++)i=n;return i.fileStart+i.byteLength},o.prototype.getEndFilePositionAfter=function(t){var e=this.findPosition(!0,t,!1);return-1!==e?this.findEndContiguousBuf(e):t},o.prototype.addUsedBytes=function(t){this.buffer.usedBytes+=t,this.logBufferLevel()},o.prototype.setAllUsedBytes=function(){this.buffer.usedBytes=this.buffer.byteLength,this.logBufferLevel()},o.prototype.seek=function(t,e,i){var s;return-1!==(s=this.findPosition(e,t,i))?(this.buffer=this.buffers[s],this.bufferIndex=s,this.position=t-this.buffer.fileStart,n.debug("MultiBufferStream","Repositioning parser at buffer position: "+this.position),!0):(n.debug("MultiBufferStream","Position "+t+" not found in buffered data"),!1)},o.prototype.getPosition=function(){if(-1===this.bufferIndex||null===this.buffers[this.bufferIndex])throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.position},o.prototype.getLength=function(){return this.byteLength},o.prototype.getEndPosition=function(){if(-1===this.bufferIndex||null===this.buffers[this.bufferIndex])throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.byteLength},t.MultiBufferStream=o;var a=function(){var t=[];t[3]="ES_Descriptor",t[4]="DecoderConfigDescriptor",t[5]="DecoderSpecificInfo",t[6]="SLConfigDescriptor",this.getDescriptorName=function(e){return t[e]};var e=this,i={};return this.parseOneDescriptor=function(e){var s,A,r,o=0;for(s=e.readUint8(),r=e.readUint8();128&r;)o=(127&r)<<7,r=e.readUint8();return o+=127&r,n.debug("MPEG4DescriptorParser","Found "+(t[s]||"Descriptor "+s)+", size "+o+" at position "+e.getPosition()),(A=t[s]?new i[t[s]](o):new i.Descriptor(o)).parse(e),A},i.Descriptor=function(t,e){this.tag=t,this.size=e,this.descs=[]},i.Descriptor.prototype.parse=function(t){this.data=t.readUint8Array(this.size)},i.Descriptor.prototype.findDescriptor=function(t){for(var e=0;e<this.descs.length;e++)if(this.descs[e].tag==t)return this.descs[e];return null},i.Descriptor.prototype.parseRemainingDescriptors=function(t){for(var i=t.position;t.position<i+this.size;){var n=e.parseOneDescriptor(t);this.descs.push(n)}},i.ES_Descriptor=function(t){i.Descriptor.call(this,3,t)},i.ES_Descriptor.prototype=new i.Descriptor,i.ES_Descriptor.prototype.parse=function(t){if(this.ES_ID=t.readUint16(),this.flags=t.readUint8(),this.size-=3,128&this.flags?(this.dependsOn_ES_ID=t.readUint16(),this.size-=2):this.dependsOn_ES_ID=0,64&this.flags){var e=t.readUint8();this.URL=t.readString(e),this.size-=e+1}else this.URL="";32&this.flags?(this.OCR_ES_ID=t.readUint16(),this.size-=2):this.OCR_ES_ID=0,this.parseRemainingDescriptors(t)},i.ES_Descriptor.prototype.getOTI=function(t){var e=this.findDescriptor(4);return e?e.oti:0},i.ES_Descriptor.prototype.getAudioConfig=function(t){var e=this.findDescriptor(4);if(!e)return null;var i=e.findDescriptor(5);if(i&&i.data){var n=(248&i.data[0])>>3;return 31===n&&i.data.length>=2&&(n=32+((7&i.data[0])<<3)+((224&i.data[1])>>5)),n}return null},i.DecoderConfigDescriptor=function(t){i.Descriptor.call(this,4,t)},i.DecoderConfigDescriptor.prototype=new i.Descriptor,i.DecoderConfigDescriptor.prototype.parse=function(t){this.oti=t.readUint8(),this.streamType=t.readUint8(),this.bufferSize=t.readUint24(),this.maxBitrate=t.readUint32(),this.avgBitrate=t.readUint32(),this.size-=13,this.parseRemainingDescriptors(t)},i.DecoderSpecificInfo=function(t){i.Descriptor.call(this,5,t)},i.DecoderSpecificInfo.prototype=new i.Descriptor,i.SLConfigDescriptor=function(t){i.Descriptor.call(this,6,t)},i.SLConfigDescriptor.prototype=new i.Descriptor,this};t.MPEG4DescriptorParser=a;var h={ERR_INVALID_DATA:-1,ERR_NOT_ENOUGH_DATA:0,OK:1,BASIC_BOXES:["mdat","idat","free","skip","meco","strk"],FULL_BOXES:["hmhd","nmhd","iods","xml ","bxml","ipro","mere"],CONTAINER_BOXES:[["moov",["trak","pssh"]],["trak"],["edts"],["mdia"],["minf"],["dinf"],["stbl",["sgpd","sbgp"]],["mvex",["trex"]],["moof",["traf"]],["traf",["trun","sgpd","sbgp"]],["vttc"],["tref"],["iref"],["mfra",["tfra"]],["meco"],["hnti"],["hinf"],["strk"],["strd"],["sinf"],["rinf"],["schi"],["trgr"],["udta",["kind"]],["iprp",["ipma"]],["ipco"]],boxCodes:[],fullBoxCodes:[],containerBoxCodes:[],sampleEntryCodes:{},sampleGroupEntryCodes:[],trackGroupTypes:[],UUIDBoxes:{},UUIDs:[],initialize:function(){h.FullBox.prototype=new h.Box,h.ContainerBox.prototype=new h.Box,h.SampleEntry.prototype=new h.Box,h.TrackGroupTypeBox.prototype=new h.FullBox,h.BASIC_BOXES.forEach((function(t){h.createBoxCtor(t)})),h.FULL_BOXES.forEach((function(t){h.createFullBoxCtor(t)})),h.CONTAINER_BOXES.forEach((function(t){h.createContainerBoxCtor(t[0],null,t[1])}))},Box:function(t,e,i){this.type=t,this.size=e,this.uuid=i},FullBox:function(t,e,i){h.Box.call(this,t,e,i),this.flags=0,this.version=0},ContainerBox:function(t,e,i){h.Box.call(this,t,e,i),this.boxes=[]},SampleEntry:function(t,e,i,n){h.ContainerBox.call(this,t,e),this.hdr_size=i,this.start=n},SampleGroupEntry:function(t){this.grouping_type=t},TrackGroupTypeBox:function(t,e){h.FullBox.call(this,t,e)},createBoxCtor:function(t,e){h.boxCodes.push(t),h[t+"Box"]=function(e){h.Box.call(this,t,e)},h[t+"Box"].prototype=new h.Box,e&&(h[t+"Box"].prototype.parse=e)},createFullBoxCtor:function(t,e){h[t+"Box"]=function(e){h.FullBox.call(this,t,e)},h[t+"Box"].prototype=new h.FullBox,h[t+"Box"].prototype.parse=function(t){this.parseFullHeader(t),e&&e.call(this,t)}},addSubBoxArrays:function(t){if(t){this.subBoxNames=t;for(var e=t.length,i=0;i<e;i++)this[t[i]+"s"]=[]}},createContainerBoxCtor:function(t,e,i){h[t+"Box"]=function(e){h.ContainerBox.call(this,t,e),h.addSubBoxArrays.call(this,i)},h[t+"Box"].prototype=new h.ContainerBox,e&&(h[t+"Box"].prototype.parse=e)},createMediaSampleEntryCtor:function(t,e,i){h.sampleEntryCodes[t]=[],h[t+"SampleEntry"]=function(t,e){h.SampleEntry.call(this,t,e),h.addSubBoxArrays.call(this,i)},h[t+"SampleEntry"].prototype=new h.SampleEntry,e&&(h[t+"SampleEntry"].prototype.parse=e)},createSampleEntryCtor:function(t,e,i,n){h.sampleEntryCodes[t].push(e),h[e+"SampleEntry"]=function(i){h[t+"SampleEntry"].call(this,e,i),h.addSubBoxArrays.call(this,n)},h[e+"SampleEntry"].prototype=new h[t+"SampleEntry"],i&&(h[e+"SampleEntry"].prototype.parse=i)},createEncryptedSampleEntryCtor:function(t,e,i){h.createSampleEntryCtor.call(this,t,e,i,["sinf"])},createSampleGroupCtor:function(t,e){h[t+"SampleGroupEntry"]=function(e){h.SampleGroupEntry.call(this,t,e)},h[t+"SampleGroupEntry"].prototype=new h.SampleGroupEntry,e&&(h[t+"SampleGroupEntry"].prototype.parse=e)},createTrackGroupCtor:function(t,e){h[t+"TrackGroupTypeBox"]=function(e){h.TrackGroupTypeBox.call(this,t,e)},h[t+"TrackGroupTypeBox"].prototype=new h.TrackGroupTypeBox,e&&(h[t+"TrackGroupTypeBox"].prototype.parse=e)},createUUIDBox:function(t,e,i,n){h.UUIDs.push(t),h.UUIDBoxes[t]=function(n){e?h.FullBox.call(this,"uuid",n,t):i?h.ContainerBox.call(this,"uuid",n,t):h.Box.call(this,"uuid",n,t)},h.UUIDBoxes[t].prototype=e?new h.FullBox:i?new h.ContainerBox:new h.Box,n&&(h.UUIDBoxes[t].prototype.parse=e?function(t){this.parseFullHeader(t),n&&n.call(this,t)}:n)}};h.initialize(),h.TKHD_FLAG_ENABLED=1,h.TKHD_FLAG_IN_MOVIE=2,h.TKHD_FLAG_IN_PREVIEW=4,h.TFHD_FLAG_BASE_DATA_OFFSET=1,h.TFHD_FLAG_SAMPLE_DESC=2,h.TFHD_FLAG_SAMPLE_DUR=8,h.TFHD_FLAG_SAMPLE_SIZE=16,h.TFHD_FLAG_SAMPLE_FLAGS=32,h.TFHD_FLAG_DUR_EMPTY=65536,h.TFHD_FLAG_DEFAULT_BASE_IS_MOOF=131072,h.TRUN_FLAGS_DATA_OFFSET=1,h.TRUN_FLAGS_FIRST_FLAG=4,h.TRUN_FLAGS_DURATION=256,h.TRUN_FLAGS_SIZE=512,h.TRUN_FLAGS_FLAGS=1024,h.TRUN_FLAGS_CTS_OFFSET=2048,h.Box.prototype.add=function(t){return this.addBox(new h[t+"Box"])},h.Box.prototype.addBox=function(t){return this.boxes.push(t),this[t.type+"s"]?this[t.type+"s"].push(t):this[t.type]=t,t},h.Box.prototype.set=function(t,e){return this[t]=e,this},h.Box.prototype.addEntry=function(t,e){var i=e||"entries";return this[i]||(this[i]=[]),this[i].push(t),this},t.BoxParser=h,h.parseUUID=function(t){return h.parseHex16(t)},h.parseHex16=function(t){for(var e="",i=0;i<16;i++){var n=t.readUint8().toString(16);e+=1===n.length?"0"+n:n}return e},h.parseOneBox=function(t,e,i){var s,A,r,o=t.getPosition(),a=0;if(t.getEndPosition()-o<8)return n.debug("BoxParser","Not enough data in stream to parse the type and size of the box"),{code:h.ERR_NOT_ENOUGH_DATA};if(i&&i<8)return n.debug("BoxParser","Not enough bytes left in the parent box to parse a new box"),{code:h.ERR_NOT_ENOUGH_DATA};var l=t.readUint32(),d=t.readString(4),p=d;if(n.debug("BoxParser","Found box of type '"+d+"' and size "+l+" at position "+o),a=8,"uuid"==d){if(t.getEndPosition()-t.getPosition()<16||i-a<16)return t.seek(o),n.debug("BoxParser","Not enough bytes left in the parent box to parse a UUID box"),{code:h.ERR_NOT_ENOUGH_DATA};a+=16,p=r=h.parseUUID(t)}if(1==l){if(t.getEndPosition()-t.getPosition()<8||i&&i-a<8)return t.seek(o),n.warn("BoxParser",'Not enough data in stream to parse the extended size of the "'+d+'" box'),{code:h.ERR_NOT_ENOUGH_DATA};l=t.readUint64(),a+=8}else if(0===l)if(i)l=i;else if("mdat"!==d)return n.error("BoxParser","Unlimited box size not supported for type: '"+d+"'"),s=new h.Box(d,l),{code:h.OK,box:s,size:s.size};return 0!==l&&l<a?(n.error("BoxParser","Box of type "+d+" has an invalid size "+l+" (too small to be a box)"),{code:h.ERR_NOT_ENOUGH_DATA,type:d,size:l,hdr_size:a,start:o}):0!==l&&i&&l>i?(n.error("BoxParser","Box of type '"+d+"' has a size "+l+" greater than its container size "+i),{code:h.ERR_NOT_ENOUGH_DATA,type:d,size:l,hdr_size:a,start:o}):0!==l&&o+l>t.getEndPosition()?(t.seek(o),n.info("BoxParser","Not enough data in stream to parse the entire '"+d+"' box"),{code:h.ERR_NOT_ENOUGH_DATA,type:d,size:l,hdr_size:a,start:o}):e?{code:h.OK,type:d,size:l,hdr_size:a,start:o}:(h[d+"Box"]?s=new h[d+"Box"](l):"uuid"!==d?(n.warn("BoxParser","Unknown box type: '"+d+"'"),(s=new h.Box(d,l)).has_unparsed_data=!0):h.UUIDBoxes[r]?s=new h.UUIDBoxes[r](l):(n.warn("BoxParser","Unknown uuid type: '"+r+"'"),(s=new h.Box(d,l)).uuid=r,s.has_unparsed_data=!0),s.hdr_size=a,s.start=o,s.write===h.Box.prototype.write&&"mdat"!==s.type&&(n.info("BoxParser","'"+p+"' box writing not yet implemented, keeping unparsed data in memory for later write"),s.parseDataAndRewind(t)),s.parse(t),(A=t.getPosition()-(s.start+s.size))<0?(n.warn("BoxParser","Parsing of box '"+p+"' did not read the entire indicated box data size (missing "+-A+" bytes), seeking forward"),t.seek(s.start+s.size)):A>0&&(n.error("BoxParser","Parsing of box '"+p+"' read "+A+" more bytes than the indicated box data size, seeking backwards"),0!==s.size&&t.seek(s.start+s.size)),{code:h.OK,box:s,size:s.size})},h.Box.prototype.parse=function(t){"mdat"!=this.type?this.data=t.readUint8Array(this.size-this.hdr_size):0===this.size?t.seek(t.getEndPosition()):t.seek(this.start+this.size)},h.Box.prototype.parseDataAndRewind=function(t){this.data=t.readUint8Array(this.size-this.hdr_size),t.position-=this.size-this.hdr_size},h.FullBox.prototype.parseDataAndRewind=function(t){this.parseFullHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size),this.hdr_size-=4,t.position-=this.size-this.hdr_size},h.FullBox.prototype.parseFullHeader=function(t){this.version=t.readUint8(),this.flags=t.readUint24(),this.hdr_size+=4},h.FullBox.prototype.parse=function(t){this.parseFullHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size)},h.ContainerBox.prototype.parse=function(t){for(var e,i;t.getPosition()<this.start+this.size;){if((e=h.parseOneBox(t,!1,this.size-(t.getPosition()-this.start))).code!==h.OK)return;if(i=e.box,this.boxes.push(i),this.subBoxNames&&-1!=this.subBoxNames.indexOf(i.type))this[this.subBoxNames[this.subBoxNames.indexOf(i.type)]+"s"].push(i);else{var s="uuid"!==i.type?i.type:i.uuid;this[s]?n.warn("Box of type "+s+" already stored in field of this type"):this[s]=i}}},h.Box.prototype.parseLanguage=function(t){this.language=t.readUint16();var e=[];e[0]=this.language>>10&31,e[1]=this.language>>5&31,e[2]=31&this.language,this.languageString=String.fromCharCode(e[0]+96,e[1]+96,e[2]+96)},h.SAMPLE_ENTRY_TYPE_VISUAL="Visual",h.SAMPLE_ENTRY_TYPE_AUDIO="Audio",h.SAMPLE_ENTRY_TYPE_HINT="Hint",h.SAMPLE_ENTRY_TYPE_METADATA="Metadata",h.SAMPLE_ENTRY_TYPE_SUBTITLE="Subtitle",h.SAMPLE_ENTRY_TYPE_SYSTEM="System",h.SAMPLE_ENTRY_TYPE_TEXT="Text",h.SampleEntry.prototype.parseHeader=function(t){t.readUint8Array(6),this.data_reference_index=t.readUint16(),this.hdr_size+=8},h.SampleEntry.prototype.parse=function(t){this.parseHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size)},h.SampleEntry.prototype.parseDataAndRewind=function(t){this.parseHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size),this.hdr_size-=8,t.position-=this.size-this.hdr_size},h.SampleEntry.prototype.parseFooter=function(t){h.ContainerBox.prototype.parse.call(this,t)},h.createMediaSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_HINT),h.createMediaSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_METADATA),h.createMediaSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_SUBTITLE),h.createMediaSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_SYSTEM),h.createMediaSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_TEXT),h.createMediaSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,(function(t){var e;this.parseHeader(t),t.readUint16(),t.readUint16(),t.readUint32Array(3),this.width=t.readUint16(),this.height=t.readUint16(),this.horizresolution=t.readUint32(),this.vertresolution=t.readUint32(),t.readUint32(),this.frame_count=t.readUint16(),e=Math.min(31,t.readUint8()),this.compressorname=t.readString(e),e<31&&t.readString(31-e),this.depth=t.readUint16(),t.readUint16(),this.parseFooter(t)})),h.createMediaSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_AUDIO,(function(t){this.parseHeader(t),t.readUint32Array(2),this.channel_count=t.readUint16(),this.samplesize=t.readUint16(),t.readUint16(),t.readUint16(),this.samplerate=t.readUint32()/65536,this.parseFooter(t)})),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"avc1"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"avc2"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"avc3"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"avc4"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"av01"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"hvc1"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"hev1"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"vvc1"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"vvi1"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"vvs1"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"vvcN"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"vp08"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"vp09"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_AUDIO,"mp4a"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_AUDIO,"ac-3"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_AUDIO,"ec-3"),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_AUDIO,"Opus"),h.createEncryptedSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_VISUAL,"encv"),h.createEncryptedSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_AUDIO,"enca"),h.createEncryptedSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_SUBTITLE,"encu"),h.createEncryptedSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_SYSTEM,"encs"),h.createEncryptedSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_TEXT,"enct"),h.createEncryptedSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_METADATA,"encm"),h.createBoxCtor("a1lx",(function(t){var e=16*(1+(1&(1&t.readUint8())));this.layer_size=[];for(var i=0;i<3;i++)this.layer_size[i]=16==e?t.readUint16():t.readUint32()})),h.createBoxCtor("a1op",(function(t){this.op_index=t.readUint8()})),h.createFullBoxCtor("auxC",(function(t){this.aux_type=t.readCString();var e=this.size-this.hdr_size-(this.aux_type.length+1);this.aux_subtype=t.readUint8Array(e)})),h.createBoxCtor("av1C",(function(t){var e=t.readUint8();if(e>>7&!1)n.error("av1C marker problem");else if(this.version=127&e,1===this.version)if(e=t.readUint8(),this.seq_profile=e>>5&7,this.seq_level_idx_0=31&e,e=t.readUint8(),this.seq_tier_0=e>>7&1,this.high_bitdepth=e>>6&1,this.twelve_bit=e>>5&1,this.monochrome=e>>4&1,this.chroma_subsampling_x=e>>3&1,this.chroma_subsampling_y=e>>2&1,this.chroma_sample_position=3&e,e=t.readUint8(),this.reserved_1=e>>5&7,0===this.reserved_1){if(this.initial_presentation_delay_present=e>>4&1,1===this.initial_presentation_delay_present)this.initial_presentation_delay_minus_one=15&e;else if(this.reserved_2=15&e,0!==this.reserved_2)return void n.error("av1C reserved_2 parsing problem");var i=this.size-this.hdr_size-4;this.configOBUs=t.readUint8Array(i)}else n.error("av1C reserved_1 parsing problem");else n.error("av1C version "+this.version+" not supported")})),h.createBoxCtor("avcC",(function(t){var e,i;for(this.configurationVersion=t.readUint8(),this.AVCProfileIndication=t.readUint8(),this.profile_compatibility=t.readUint8(),this.AVCLevelIndication=t.readUint8(),this.lengthSizeMinusOne=3&t.readUint8(),this.nb_SPS_nalus=31&t.readUint8(),i=this.size-this.hdr_size-6,this.SPS=[],e=0;e<this.nb_SPS_nalus;e++)this.SPS[e]={},this.SPS[e].length=t.readUint16(),this.SPS[e].nalu=t.readUint8Array(this.SPS[e].length),i-=2+this.SPS[e].length;for(this.nb_PPS_nalus=t.readUint8(),i--,this.PPS=[],e=0;e<this.nb_PPS_nalus;e++)this.PPS[e]={},this.PPS[e].length=t.readUint16(),this.PPS[e].nalu=t.readUint8Array(this.PPS[e].length),i-=2+this.PPS[e].length;i>0&&(this.ext=t.readUint8Array(i))})),h.createBoxCtor("btrt",(function(t){this.bufferSizeDB=t.readUint32(),this.maxBitrate=t.readUint32(),this.avgBitrate=t.readUint32()})),h.createBoxCtor("clap",(function(t){this.cleanApertureWidthN=t.readUint32(),this.cleanApertureWidthD=t.readUint32(),this.cleanApertureHeightN=t.readUint32(),this.cleanApertureHeightD=t.readUint32(),this.horizOffN=t.readUint32(),this.horizOffD=t.readUint32(),this.vertOffN=t.readUint32(),this.vertOffD=t.readUint32()})),h.createBoxCtor("clli",(function(t){this.max_content_light_level=t.readUint16(),this.max_pic_average_light_level=t.readUint16()})),h.createFullBoxCtor("co64",(function(t){var e,i;if(e=t.readUint32(),this.chunk_offsets=[],0===this.version)for(i=0;i<e;i++)this.chunk_offsets.push(t.readUint64())})),h.createFullBoxCtor("CoLL",(function(t){this.maxCLL=t.readUint16(),this.maxFALL=t.readUint16()})),h.createBoxCtor("colr",(function(t){if(this.colour_type=t.readString(4),"nclx"===this.colour_type){this.colour_primaries=t.readUint16(),this.transfer_characteristics=t.readUint16(),this.matrix_coefficients=t.readUint16();var e=t.readUint8();this.full_range_flag=e>>7}else("rICC"===this.colour_type||"prof"===this.colour_type)&&(this.ICC_profile=t.readUint8Array(this.size-4))})),h.createFullBoxCtor("cprt",(function(t){this.parseLanguage(t),this.notice=t.readCString()})),h.createFullBoxCtor("cslg",(function(t){0===this.version&&(this.compositionToDTSShift=t.readInt32(),this.leastDecodeToDisplayDelta=t.readInt32(),this.greatestDecodeToDisplayDelta=t.readInt32(),this.compositionStartTime=t.readInt32(),this.compositionEndTime=t.readInt32())})),h.createFullBoxCtor("ctts",(function(t){var e,i;if(e=t.readUint32(),this.sample_counts=[],this.sample_offsets=[],0===this.version)for(i=0;i<e;i++){this.sample_counts.push(t.readUint32());var s=t.readInt32();s<0&&n.warn("BoxParser","ctts box uses negative values without using version 1"),this.sample_offsets.push(s)}else if(1==this.version)for(i=0;i<e;i++)this.sample_counts.push(t.readUint32()),this.sample_offsets.push(t.readInt32())})),h.createBoxCtor("dac3",(function(t){var e=t.readUint8(),i=t.readUint8(),n=t.readUint8();this.fscod=e>>6,this.bsid=e>>1&31,this.bsmod=(1&e)<<2|i>>6&3,this.acmod=i>>3&7,this.lfeon=i>>2&1,this.bit_rate_code=3&i|n>>5&7})),h.createBoxCtor("dec3",(function(t){var e=t.readUint16();this.data_rate=e>>3,this.num_ind_sub=7&e,this.ind_subs=[];for(var i=0;i<this.num_ind_sub+1;i++){var n={};this.ind_subs.push(n);var s=t.readUint8(),A=t.readUint8(),r=t.readUint8();n.fscod=s>>6,n.bsid=s>>1&31,n.bsmod=(1&s)<<4|A>>4&15,n.acmod=A>>1&7,n.lfeon=1&A,n.num_dep_sub=r>>1&15,n.num_dep_sub>0&&(n.chan_loc=(1&r)<<8|t.readUint8())}})),h.createFullBoxCtor("dfLa",(function(t){var e=[],i=["STREAMINFO","PADDING","APPLICATION","SEEKTABLE","VORBIS_COMMENT","CUESHEET","PICTURE","RESERVED"];for(this.parseFullHeader(t);;){var n=t.readUint8(),s=Math.min(127&n,i.length-1);if(s?t.readUint8Array(t.readUint24()):(t.readUint8Array(13),this.samplerate=t.readUint32()>>12,t.readUint8Array(20)),e.push(i[s]),128&n)break}this.numMetadataBlocks=e.length+" ("+e.join(", ")+")"})),h.createBoxCtor("dimm",(function(t){this.bytessent=t.readUint64()})),h.createBoxCtor("dmax",(function(t){this.time=t.readUint32()})),h.createBoxCtor("dmed",(function(t){this.bytessent=t.readUint64()})),h.createBoxCtor("dOps",(function(t){if(this.Version=t.readUint8(),this.OutputChannelCount=t.readUint8(),this.PreSkip=t.readUint16(),this.InputSampleRate=t.readUint32(),this.OutputGain=t.readInt16(),this.ChannelMappingFamily=t.readUint8(),0!==this.ChannelMappingFamily){this.StreamCount=t.readUint8(),this.CoupledCount=t.readUint8(),this.ChannelMapping=[];for(var e=0;e<this.OutputChannelCount;e++)this.ChannelMapping[e]=t.readUint8()}})),h.createFullBoxCtor("dref",(function(t){var e,i;this.entries=[];for(var n=t.readUint32(),s=0;s<n;s++){if((e=h.parseOneBox(t,!1,this.size-(t.getPosition()-this.start))).code!==h.OK)return;i=e.box,this.entries.push(i)}})),h.createBoxCtor("drep",(function(t){this.bytessent=t.readUint64()})),h.createFullBoxCtor("elng",(function(t){this.extended_language=t.readString(this.size-this.hdr_size)})),h.createFullBoxCtor("elst",(function(t){this.entries=[];for(var e=t.readUint32(),i=0;i<e;i++){var n={};this.entries.push(n),1===this.version?(n.segment_duration=t.readUint64(),n.media_time=t.readInt64()):(n.segment_duration=t.readUint32(),n.media_time=t.readInt32()),n.media_rate_integer=t.readInt16(),n.media_rate_fraction=t.readInt16()}})),h.createFullBoxCtor("emsg",(function(t){1==this.version?(this.timescale=t.readUint32(),this.presentation_time=t.readUint64(),this.event_duration=t.readUint32(),this.id=t.readUint32(),this.scheme_id_uri=t.readCString(),this.value=t.readCString()):(this.scheme_id_uri=t.readCString(),this.value=t.readCString(),this.timescale=t.readUint32(),this.presentation_time_delta=t.readUint32(),this.event_duration=t.readUint32(),this.id=t.readUint32());var e=this.size-this.hdr_size-(16+(this.scheme_id_uri.length+1)+(this.value.length+1));1==this.version&&(e-=4),this.message_data=t.readUint8Array(e)})),h.createFullBoxCtor("esds",(function(t){var e=t.readUint8Array(this.size-this.hdr_size);if(void 0!==a){var i=new a;this.esd=i.parseOneDescriptor(new A(e.buffer,0,A.BIG_ENDIAN))}})),h.createBoxCtor("fiel",(function(t){this.fieldCount=t.readUint8(),this.fieldOrdering=t.readUint8()})),h.createBoxCtor("frma",(function(t){this.data_format=t.readString(4)})),h.createBoxCtor("ftyp",(function(t){var e=this.size-this.hdr_size;this.major_brand=t.readString(4),this.minor_version=t.readUint32(),e-=8,this.compatible_brands=[];for(var i=0;e>=4;)this.compatible_brands[i]=t.readString(4),e-=4,i++})),h.createFullBoxCtor("hdlr",(function(t){0===this.version&&(t.readUint32(),this.handler=t.readString(4),t.readUint32Array(3),this.name=t.readString(this.size-this.hdr_size-20),"\0"===this.name[this.name.length-1]&&(this.name=this.name.slice(0,-1)))})),h.createBoxCtor("hvcC",(function(t){var e,i,n,s;this.configurationVersion=t.readUint8(),s=t.readUint8(),this.general_profile_space=s>>6,this.general_tier_flag=(32&s)>>5,this.general_profile_idc=31&s,this.general_profile_compatibility=t.readUint32(),this.general_constraint_indicator=t.readUint8Array(6),this.general_level_idc=t.readUint8(),this.min_spatial_segmentation_idc=4095&t.readUint16(),this.parallelismType=3&t.readUint8(),this.chroma_format_idc=3&t.readUint8(),this.bit_depth_luma_minus8=7&t.readUint8(),this.bit_depth_chroma_minus8=7&t.readUint8(),this.avgFrameRate=t.readUint16(),s=t.readUint8(),this.constantFrameRate=s>>6,this.numTemporalLayers=(13&s)>>3,this.temporalIdNested=(4&s)>>2,this.lengthSizeMinusOne=3&s,this.nalu_arrays=[];var A=t.readUint8();for(e=0;e<A;e++){var r=[];this.nalu_arrays.push(r),s=t.readUint8(),r.completeness=(128&s)>>7,r.nalu_type=63&s;var o=t.readUint16();for(i=0;i<o;i++){var a={};r.push(a),n=t.readUint16(),a.data=t.readUint8Array(n)}}})),h.createFullBoxCtor("iinf",(function(t){var e;0===this.version?this.entry_count=t.readUint16():this.entry_count=t.readUint32(),this.item_infos=[];for(var i=0;i<this.entry_count;i++){if((e=h.parseOneBox(t,!1,this.size-(t.getPosition()-this.start))).code!==h.OK)return;"infe"!==e.box.type&&n.error("BoxParser","Expected 'infe' box, got "+e.box.type),this.item_infos[i]=e.box}})),h.createFullBoxCtor("iloc",(function(t){var e;e=t.readUint8(),this.offset_size=e>>4&15,this.length_size=15&e,e=t.readUint8(),this.base_offset_size=e>>4&15,1===this.version||2===this.version?this.index_size=15&e:this.index_size=0,this.items=[];var i=0;if(this.version<2)i=t.readUint16();else{if(2!==this.version)throw"version of iloc box not supported";i=t.readUint32()}for(var n=0;n<i;n++){var s={};if(this.items.push(s),this.version<2)s.item_ID=t.readUint16();else{if(2!==this.version)throw"version of iloc box not supported";s.item_ID=t.readUint16()}switch(1===this.version||2===this.version?s.construction_method=15&t.readUint16():s.construction_method=0,s.data_reference_index=t.readUint16(),this.base_offset_size){case 0:s.base_offset=0;break;case 4:s.base_offset=t.readUint32();break;case 8:s.base_offset=t.readUint64();break;default:throw"Error reading base offset size"}var A=t.readUint16();s.extents=[];for(var r=0;r<A;r++){var o={};if(s.extents.push(o),1===this.version||2===this.version)switch(this.index_size){case 0:o.extent_index=0;break;case 4:o.extent_index=t.readUint32();break;case 8:o.extent_index=t.readUint64();break;default:throw"Error reading extent index"}switch(this.offset_size){case 0:o.extent_offset=0;break;case 4:o.extent_offset=t.readUint32();break;case 8:o.extent_offset=t.readUint64();break;default:throw"Error reading extent index"}switch(this.length_size){case 0:o.extent_length=0;break;case 4:o.extent_length=t.readUint32();break;case 8:o.extent_length=t.readUint64();break;default:throw"Error reading extent index"}}}})),h.createBoxCtor("imir",(function(t){var e=t.readUint8();this.reserved=e>>7,this.axis=1&e})),h.createFullBoxCtor("infe",(function(t){if(0!==this.version&&1!==this.version||(this.item_ID=t.readUint16(),this.item_protection_index=t.readUint16(),this.item_name=t.readCString(),this.content_type=t.readCString(),this.content_encoding=t.readCString()),1===this.version)return this.extension_type=t.readString(4),n.warn("BoxParser","Cannot parse extension type"),void t.seek(this.start+this.size);this.version>=2&&(2===this.version?this.item_ID=t.readUint16():3===this.version&&(this.item_ID=t.readUint32()),this.item_protection_index=t.readUint16(),this.item_type=t.readString(4),this.item_name=t.readCString(),"mime"===this.item_type?(this.content_type=t.readCString(),this.content_encoding=t.readCString()):"uri "===this.item_type&&(this.item_uri_type=t.readCString()))})),h.createFullBoxCtor("ipma",(function(t){var e,i;for(entry_count=t.readUint32(),this.associations=[],e=0;e<entry_count;e++){var n={};this.associations.push(n),this.version<1?n.id=t.readUint16():n.id=t.readUint32();var s=t.readUint8();for(n.props=[],i=0;i<s;i++){var A=t.readUint8(),r={};n.props.push(r),r.essential=(128&A)>>7==1,1&this.flags?r.property_index=(127&A)<<8|t.readUint8():r.property_index=127&A}}})),h.createFullBoxCtor("iref",(function(t){var e,i;for(this.references=[];t.getPosition()<this.start+this.size;){if((e=h.parseOneBox(t,!0,this.size-(t.getPosition()-this.start))).code!==h.OK)return;(i=0===this.version?new h.SingleItemTypeReferenceBox(e.type,e.size,e.hdr_size,e.start):new h.SingleItemTypeReferenceBoxLarge(e.type,e.size,e.hdr_size,e.start)).write===h.Box.prototype.write&&"mdat"!==i.type&&(n.warn("BoxParser",i.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),i.parseDataAndRewind(t)),i.parse(t),this.references.push(i)}})),h.createBoxCtor("irot",(function(t){this.angle=3&t.readUint8()})),h.createFullBoxCtor("ispe",(function(t){this.image_width=t.readUint32(),this.image_height=t.readUint32()})),h.createFullBoxCtor("kind",(function(t){this.schemeURI=t.readCString(),this.value=t.readCString()})),h.createFullBoxCtor("leva",(function(t){var e=t.readUint8();this.levels=[];for(var i=0;i<e;i++){var s={};this.levels[i]=s,s.track_ID=t.readUint32();var A=t.readUint8();switch(s.padding_flag=A>>7,s.assignment_type=127&A,s.assignment_type){case 0:s.grouping_type=t.readString(4);break;case 1:s.grouping_type=t.readString(4),s.grouping_type_parameter=t.readUint32();break;case 2:case 3:break;case 4:s.sub_track_id=t.readUint32();break;default:n.warn("BoxParser","Unknown leva assignement type")}}})),h.createBoxCtor("lsel",(function(t){this.layer_id=t.readUint16()})),h.createBoxCtor("maxr",(function(t){this.period=t.readUint32(),this.bytes=t.readUint32()})),h.createBoxCtor("mdcv",(function(t){this.display_primaries=[],this.display_primaries[0]={},this.display_primaries[0].x=t.readUint16(),this.display_primaries[0].y=t.readUint16(),this.display_primaries[1]={},this.display_primaries[1].x=t.readUint16(),this.display_primaries[1].y=t.readUint16(),this.display_primaries[2]={},this.display_primaries[2].x=t.readUint16(),this.display_primaries[2].y=t.readUint16(),this.white_point={},this.white_point.x=t.readUint16(),this.white_point.y=t.readUint16(),this.max_display_mastering_luminance=t.readUint32(),this.min_display_mastering_luminance=t.readUint32()})),h.createFullBoxCtor("mdhd",(function(t){1==this.version?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.timescale=t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.timescale=t.readUint32(),this.duration=t.readUint32()),this.parseLanguage(t),t.readUint16()})),h.createFullBoxCtor("mehd",(function(t){1&this.flags&&(n.warn("BoxParser","mehd box incorrectly uses flags set to 1, converting version to 1"),this.version=1),1==this.version?this.fragment_duration=t.readUint64():this.fragment_duration=t.readUint32()})),h.createFullBoxCtor("meta",(function(t){this.boxes=[],h.ContainerBox.prototype.parse.call(this,t)})),h.createFullBoxCtor("mfhd",(function(t){this.sequence_number=t.readUint32()})),h.createFullBoxCtor("mfro",(function(t){this._size=t.readUint32()})),h.createFullBoxCtor("mvhd",(function(t){1==this.version?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.timescale=t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.timescale=t.readUint32(),this.duration=t.readUint32()),this.rate=t.readUint32(),this.volume=t.readUint16()>>8,t.readUint16(),t.readUint32Array(2),this.matrix=t.readUint32Array(9),t.readUint32Array(6),this.next_track_id=t.readUint32()})),h.createBoxCtor("npck",(function(t){this.packetssent=t.readUint32()})),h.createBoxCtor("nump",(function(t){this.packetssent=t.readUint64()})),h.createFullBoxCtor("padb",(function(t){var e=t.readUint32();this.padbits=[];for(var i=0;i<Math.floor((e+1)/2);i++)this.padbits=t.readUint8()})),h.createBoxCtor("pasp",(function(t){this.hSpacing=t.readUint32(),this.vSpacing=t.readUint32()})),h.createBoxCtor("payl",(function(t){this.text=t.readString(this.size-this.hdr_size)})),h.createBoxCtor("payt",(function(t){this.payloadID=t.readUint32();var e=t.readUint8();this.rtpmap_string=t.readString(e)})),h.createFullBoxCtor("pdin",(function(t){var e=(this.size-this.hdr_size)/8;this.rate=[],this.initial_delay=[];for(var i=0;i<e;i++)this.rate[i]=t.readUint32(),this.initial_delay[i]=t.readUint32()})),h.createFullBoxCtor("pitm",(function(t){0===this.version?this.item_id=t.readUint16():this.item_id=t.readUint32()})),h.createFullBoxCtor("pixi",(function(t){var e;for(this.num_channels=t.readUint8(),this.bits_per_channels=[],e=0;e<this.num_channels;e++)this.bits_per_channels[e]=t.readUint8()})),h.createBoxCtor("pmax",(function(t){this.bytes=t.readUint32()})),h.createFullBoxCtor("prft",(function(t){this.ref_track_id=t.readUint32(),this.ntp_timestamp=t.readUint64(),0===this.version?this.media_time=t.readUint32():this.media_time=t.readUint64()})),h.createFullBoxCtor("pssh",(function(t){if(this.system_id=h.parseHex16(t),this.version>0){var e=t.readUint32();this.kid=[];for(var i=0;i<e;i++)this.kid[i]=h.parseHex16(t)}var n=t.readUint32();n>0&&(this.data=t.readUint8Array(n))})),h.createFullBoxCtor("clef",(function(t){this.width=t.readUint32(),this.height=t.readUint32()})),h.createFullBoxCtor("enof",(function(t){this.width=t.readUint32(),this.height=t.readUint32()})),h.createFullBoxCtor("prof",(function(t){this.width=t.readUint32(),this.height=t.readUint32()})),h.createContainerBoxCtor("tapt",null,["clef","prof","enof"]),h.createBoxCtor("rtp ",(function(t){this.descriptionformat=t.readString(4),this.sdptext=t.readString(this.size-this.hdr_size-4)})),h.createFullBoxCtor("saio",(function(t){1&this.flags&&(this.aux_info_type=t.readUint32(),this.aux_info_type_parameter=t.readUint32());var e=t.readUint32();this.offset=[];for(var i=0;i<e;i++)0===this.version?this.offset[i]=t.readUint32():this.offset[i]=t.readUint64()})),h.createFullBoxCtor("saiz",(function(t){1&this.flags&&(this.aux_info_type=t.readUint32(),this.aux_info_type_parameter=t.readUint32()),this.default_sample_info_size=t.readUint8();var e=t.readUint32();if(this.sample_info_size=[],0===this.default_sample_info_size)for(var i=0;i<e;i++)this.sample_info_size[i]=t.readUint8()})),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_METADATA,"mett",(function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)})),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_METADATA,"metx",(function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.namespace=t.readCString(),this.schema_location=t.readCString(),this.parseFooter(t)})),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_SUBTITLE,"sbtt",(function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)})),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_SUBTITLE,"stpp",(function(t){this.parseHeader(t),this.namespace=t.readCString(),this.schema_location=t.readCString(),this.auxiliary_mime_types=t.readCString(),this.parseFooter(t)})),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_SUBTITLE,"stxt",(function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)})),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_SUBTITLE,"tx3g",(function(t){this.parseHeader(t),this.displayFlags=t.readUint32(),this.horizontal_justification=t.readInt8(),this.vertical_justification=t.readInt8(),this.bg_color_rgba=t.readUint8Array(4),this.box_record=t.readInt16Array(4),this.style_record=t.readUint8Array(12),this.parseFooter(t)})),h.createSampleEntryCtor(h.SAMPLE_ENTRY_TYPE_METADATA,"wvtt",(function(t){this.parseHeader(t),this.parseFooter(t)})),h.createSampleGroupCtor("alst",(function(t){var e,i=t.readUint16();for(this.first_output_sample=t.readUint16(),this.sample_offset=[],e=0;e<i;e++)this.sample_offset[e]=t.readUint32();var n=this.description_length-4-4*i;for(this.num_output_samples=[],this.num_total_samples=[],e=0;e<n/4;e++)this.num_output_samples[e]=t.readUint16(),this.num_total_samples[e]=t.readUint16()})),h.createSampleGroupCtor("avll",(function(t){this.layerNumber=t.readUint8(),this.accurateStatisticsFlag=t.readUint8(),this.avgBitRate=t.readUint16(),this.avgFrameRate=t.readUint16()})),h.createSampleGroupCtor("avss",(function(t){this.subSequenceIdentifier=t.readUint16(),this.layerNumber=t.readUint8();var e=t.readUint8();this.durationFlag=e>>7,this.avgRateFlag=e>>6&1,this.durationFlag&&(this.duration=t.readUint32()),this.avgRateFlag&&(this.accurateStatisticsFlag=t.readUint8(),this.avgBitRate=t.readUint16(),this.avgFrameRate=t.readUint16()),this.dependency=[];for(var i=t.readUint8(),n=0;n<i;n++){var s={};this.dependency.push(s),s.subSeqDirectionFlag=t.readUint8(),s.layerNumber=t.readUint8(),s.subSequenceIdentifier=t.readUint16()}})),h.createSampleGroupCtor("dtrt",(function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")})),h.createSampleGroupCtor("mvif",(function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")})),h.createSampleGroupCtor("prol",(function(t){this.roll_distance=t.readInt16()})),h.createSampleGroupCtor("rap ",(function(t){var e=t.readUint8();this.num_leading_samples_known=e>>7,this.num_leading_samples=127&e})),h.createSampleGroupCtor("rash",(function(t){if(this.operation_point_count=t.readUint16(),this.description_length!==2+(1===this.operation_point_count?2:6*this.operation_point_count)+9)n.warn("BoxParser","Mismatch in "+this.grouping_type+" sample group length"),this.data=t.readUint8Array(this.description_length-2);else{if(1===this.operation_point_count)this.target_rate_share=t.readUint16();else{this.target_rate_share=[],this.available_bitrate=[];for(var e=0;e<this.operation_point_count;e++)this.available_bitrate[e]=t.readUint32(),this.target_rate_share[e]=t.readUint16()}this.maximum_bitrate=t.readUint32(),this.minimum_bitrate=t.readUint32(),this.discard_priority=t.readUint8()}})),h.createSampleGroupCtor("roll",(function(t){this.roll_distance=t.readInt16()})),h.SampleGroupEntry.prototype.parse=function(t){n.warn("BoxParser","Unknown Sample Group type: "+this.grouping_type),this.data=t.readUint8Array(this.description_length)},h.createSampleGroupCtor("scif",(function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")})),h.createSampleGroupCtor("scnm",(function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")})),h.createSampleGroupCtor("seig",(function(t){this.reserved=t.readUint8();var e=t.readUint8();this.crypt_byte_block=e>>4,this.skip_byte_block=15&e,this.isProtected=t.readUint8(),this.Per_Sample_IV_Size=t.readUint8(),this.KID=h.parseHex16(t),this.constant_IV_size=0,this.constant_IV=0,1===this.isProtected&&0===this.Per_Sample_IV_Size&&(this.constant_IV_size=t.readUint8(),this.constant_IV=t.readUint8Array(this.constant_IV_size))})),h.createSampleGroupCtor("stsa",(function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")})),h.createSampleGroupCtor("sync",(function(t){var e=t.readUint8();this.NAL_unit_type=63&e})),h.createSampleGroupCtor("tele",(function(t){var e=t.readUint8();this.level_independently_decodable=e>>7})),h.createSampleGroupCtor("tsas",(function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")})),h.createSampleGroupCtor("tscl",(function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")})),h.createSampleGroupCtor("vipr",(function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")})),h.createFullBoxCtor("sbgp",(function(t){this.grouping_type=t.readString(4),1===this.version?this.grouping_type_parameter=t.readUint32():this.grouping_type_parameter=0,this.entries=[];for(var e=t.readUint32(),i=0;i<e;i++){var n={};this.entries.push(n),n.sample_count=t.readInt32(),n.group_description_index=t.readInt32()}})),h.createFullBoxCtor("schm",(function(t){this.scheme_type=t.readString(4),this.scheme_version=t.readUint32(),1&this.flags&&(this.scheme_uri=t.readString(this.size-this.hdr_size-8))})),h.createBoxCtor("sdp ",(function(t){this.sdptext=t.readString(this.size-this.hdr_size)})),h.createFullBoxCtor("sdtp",(function(t){var e,i=this.size-this.hdr_size;this.is_leading=[],this.sample_depends_on=[],this.sample_is_depended_on=[],this.sample_has_redundancy=[];for(var n=0;n<i;n++)e=t.readUint8(),this.is_leading[n]=e>>6,this.sample_depends_on[n]=e>>4&3,this.sample_is_depended_on[n]=e>>2&3,this.sample_has_redundancy[n]=3&e})),h.createFullBoxCtor("senc"),h.createFullBoxCtor("sgpd",(function(t){this.grouping_type=t.readString(4),n.debug("BoxParser","Found Sample Groups of type "+this.grouping_type),1===this.version?this.default_length=t.readUint32():this.default_length=0,this.version>=2&&(this.default_group_description_index=t.readUint32()),this.entries=[];for(var e=t.readUint32(),i=0;i<e;i++){var s;s=h[this.grouping_type+"SampleGroupEntry"]?new h[this.grouping_type+"SampleGroupEntry"](this.grouping_type):new h.SampleGroupEntry(this.grouping_type),this.entries.push(s),1===this.version&&0===this.default_length?s.description_length=t.readUint32():s.description_length=this.default_length,s.write===h.SampleGroupEntry.prototype.write&&(n.info("BoxParser","SampleGroup for type "+this.grouping_type+" writing not yet implemented, keeping unparsed data in memory for later write"),s.data=t.readUint8Array(s.description_length),t.position-=s.description_length),s.parse(t)}})),h.createFullBoxCtor("sidx",(function(t){this.reference_ID=t.readUint32(),this.timescale=t.readUint32(),0===this.version?(this.earliest_presentation_time=t.readUint32(),this.first_offset=t.readUint32()):(this.earliest_presentation_time=t.readUint64(),this.first_offset=t.readUint64()),t.readUint16(),this.references=[];for(var e=t.readUint16(),i=0;i<e;i++){var n={};this.references.push(n);var s=t.readUint32();n.reference_type=s>>31&1,n.referenced_size=2147483647&s,n.subsegment_duration=t.readUint32(),s=t.readUint32(),n.starts_with_SAP=s>>31&1,n.SAP_type=s>>28&7,n.SAP_delta_time=268435455&s}})),h.SingleItemTypeReferenceBox=function(t,e,i,n){h.Box.call(this,t,e),this.hdr_size=i,this.start=n},h.SingleItemTypeReferenceBox.prototype=new h.Box,h.SingleItemTypeReferenceBox.prototype.parse=function(t){this.from_item_ID=t.readUint16();var e=t.readUint16();this.references=[];for(var i=0;i<e;i++)this.references[i]=t.readUint16()},h.SingleItemTypeReferenceBoxLarge=function(t,e,i,n){h.Box.call(this,t,e),this.hdr_size=i,this.start=n},h.SingleItemTypeReferenceBoxLarge.prototype=new h.Box,h.SingleItemTypeReferenceBoxLarge.prototype.parse=function(t){this.from_item_ID=t.readUint32();var e=t.readUint16();this.references=[];for(var i=0;i<e;i++)this.references[i]=t.readUint32()},h.createFullBoxCtor("SmDm",(function(t){this.primaryRChromaticity_x=t.readUint16(),this.primaryRChromaticity_y=t.readUint16(),this.primaryGChromaticity_x=t.readUint16(),this.primaryGChromaticity_y=t.readUint16(),this.primaryBChromaticity_x=t.readUint16(),this.primaryBChromaticity_y=t.readUint16(),this.whitePointChromaticity_x=t.readUint16(),this.whitePointChromaticity_y=t.readUint16(),this.luminanceMax=t.readUint32(),this.luminanceMin=t.readUint32()})),h.createFullBoxCtor("smhd",(function(t){this.balance=t.readUint16(),t.readUint16()})),h.createFullBoxCtor("ssix",(function(t){this.subsegments=[];for(var e=t.readUint32(),i=0;i<e;i++){var n={};this.subsegments.push(n),n.ranges=[];for(var s=t.readUint32(),A=0;A<s;A++){var r={};n.ranges.push(r),r.level=t.readUint8(),r.range_size=t.readUint24()}}})),h.createFullBoxCtor("stco",(function(t){var e;if(e=t.readUint32(),this.chunk_offsets=[],0===this.version)for(var i=0;i<e;i++)this.chunk_offsets.push(t.readUint32())})),h.createFullBoxCtor("stdp",(function(t){var e=(this.size-this.hdr_size)/2;this.priority=[];for(var i=0;i<e;i++)this.priority[i]=t.readUint16()})),h.createFullBoxCtor("sthd"),h.createFullBoxCtor("stri",(function(t){this.switch_group=t.readUint16(),this.alternate_group=t.readUint16(),this.sub_track_id=t.readUint32();var e=(this.size-this.hdr_size-8)/4;this.attribute_list=[];for(var i=0;i<e;i++)this.attribute_list[i]=t.readUint32()})),h.createFullBoxCtor("stsc",(function(t){var e,i;if(e=t.readUint32(),this.first_chunk=[],this.samples_per_chunk=[],this.sample_description_index=[],0===this.version)for(i=0;i<e;i++)this.first_chunk.push(t.readUint32()),this.samples_per_chunk.push(t.readUint32()),this.sample_description_index.push(t.readUint32())})),h.createFullBoxCtor("stsd",(function(t){var e,i,s,A;for(this.entries=[],s=t.readUint32(),e=1;e<=s;e++){if((i=h.parseOneBox(t,!0,this.size-(t.getPosition()-this.start))).code!==h.OK)return;h[i.type+"SampleEntry"]?((A=new h[i.type+"SampleEntry"](i.size)).hdr_size=i.hdr_size,A.start=i.start):(n.warn("BoxParser","Unknown sample entry type: "+i.type),A=new h.SampleEntry(i.type,i.size,i.hdr_size,i.start)),A.write===h.SampleEntry.prototype.write&&(n.info("BoxParser","SampleEntry "+A.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),A.parseDataAndRewind(t)),A.parse(t),this.entries.push(A)}})),h.createFullBoxCtor("stsg",(function(t){this.grouping_type=t.readUint32();var e=t.readUint16();this.group_description_index=[];for(var i=0;i<e;i++)this.group_description_index[i]=t.readUint32()})),h.createFullBoxCtor("stsh",(function(t){var e,i;if(e=t.readUint32(),this.shadowed_sample_numbers=[],this.sync_sample_numbers=[],0===this.version)for(i=0;i<e;i++)this.shadowed_sample_numbers.push(t.readUint32()),this.sync_sample_numbers.push(t.readUint32())})),h.createFullBoxCtor("stss",(function(t){var e,i;if(i=t.readUint32(),0===this.version)for(this.sample_numbers=[],e=0;e<i;e++)this.sample_numbers.push(t.readUint32())})),h.createFullBoxCtor("stsz",(function(t){var e;if(this.sample_sizes=[],0===this.version)for(this.sample_size=t.readUint32(),this.sample_count=t.readUint32(),e=0;e<this.sample_count;e++)0===this.sample_size?this.sample_sizes.push(t.readUint32()):this.sample_sizes[e]=this.sample_size})),h.createFullBoxCtor("stts",(function(t){var e,i,s;if(e=t.readUint32(),this.sample_counts=[],this.sample_deltas=[],0===this.version)for(i=0;i<e;i++)this.sample_counts.push(t.readUint32()),(s=t.readInt32())<0&&(n.warn("BoxParser","File uses negative stts sample delta, using value 1 instead, sync may be lost!"),s=1),this.sample_deltas.push(s)})),h.createFullBoxCtor("stvi",(function(t){var e=t.readUint32();this.single_view_allowed=3&e,this.stereo_scheme=t.readUint32();var i,n,s=t.readUint32();for(this.stereo_indication_type=t.readString(s),this.boxes=[];t.getPosition()<this.start+this.size;){if((i=h.parseOneBox(t,!1,this.size-(t.getPosition()-this.start))).code!==h.OK)return;n=i.box,this.boxes.push(n),this[n.type]=n}})),h.createBoxCtor("styp",(function(t){h.ftypBox.prototype.parse.call(this,t)})),h.createFullBoxCtor("stz2",(function(t){var e,i;if(this.sample_sizes=[],0===this.version)if(this.reserved=t.readUint24(),this.field_size=t.readUint8(),i=t.readUint32(),4===this.field_size)for(e=0;e<i;e+=2){var s=t.readUint8();this.sample_sizes[e]=s>>4&15,this.sample_sizes[e+1]=15&s}else if(8===this.field_size)for(e=0;e<i;e++)this.sample_sizes[e]=t.readUint8();else if(16===this.field_size)for(e=0;e<i;e++)this.sample_sizes[e]=t.readUint16();else n.error("BoxParser","Error in length field in stz2 box")})),h.createFullBoxCtor("subs",(function(t){var e,i,n,s;for(n=t.readUint32(),this.entries=[],e=0;e<n;e++){var A={};if(this.entries[e]=A,A.sample_delta=t.readUint32(),A.subsamples=[],(s=t.readUint16())>0)for(i=0;i<s;i++){var r={};A.subsamples.push(r),1==this.version?r.size=t.readUint32():r.size=t.readUint16(),r.priority=t.readUint8(),r.discardable=t.readUint8(),r.codec_specific_parameters=t.readUint32()}}})),h.createFullBoxCtor("tenc",(function(t){if(t.readUint8(),0===this.version)t.readUint8();else{var e=t.readUint8();this.default_crypt_byte_block=e>>4&15,this.default_skip_byte_block=15&e}this.default_isProtected=t.readUint8(),this.default_Per_Sample_IV_Size=t.readUint8(),this.default_KID=h.parseHex16(t),1===this.default_isProtected&&0===this.default_Per_Sample_IV_Size&&(this.default_constant_IV_size=t.readUint8(),this.default_constant_IV=t.readUint8Array(this.default_constant_IV_size))})),h.createFullBoxCtor("tfdt",(function(t){1==this.version?this.baseMediaDecodeTime=t.readUint64():this.baseMediaDecodeTime=t.readUint32()})),h.createFullBoxCtor("tfhd",(function(t){var e=0;this.track_id=t.readUint32(),this.size-this.hdr_size>e&&this.flags&h.TFHD_FLAG_BASE_DATA_OFFSET?(this.base_data_offset=t.readUint64(),e+=8):this.base_data_offset=0,this.size-this.hdr_size>e&&this.flags&h.TFHD_FLAG_SAMPLE_DESC?(this.default_sample_description_index=t.readUint32(),e+=4):this.default_sample_description_index=0,this.size-this.hdr_size>e&&this.flags&h.TFHD_FLAG_SAMPLE_DUR?(this.default_sample_duration=t.readUint32(),e+=4):this.default_sample_duration=0,this.size-this.hdr_size>e&&this.flags&h.TFHD_FLAG_SAMPLE_SIZE?(this.default_sample_size=t.readUint32(),e+=4):this.default_sample_size=0,this.size-this.hdr_size>e&&this.flags&h.TFHD_FLAG_SAMPLE_FLAGS?(this.default_sample_flags=t.readUint32(),e+=4):this.default_sample_flags=0})),h.createFullBoxCtor("tfra",(function(t){this.track_ID=t.readUint32(),t.readUint24();var e=t.readUint8();this.length_size_of_traf_num=e>>4&3,this.length_size_of_trun_num=e>>2&3,this.length_size_of_sample_num=3&e,this.entries=[];for(var i=t.readUint32(),n=0;n<i;n++)1===this.version?(this.time=t.readUint64(),this.moof_offset=t.readUint64()):(this.time=t.readUint32(),this.moof_offset=t.readUint32()),this.traf_number=t["readUint"+8*(this.length_size_of_traf_num+1)](),this.trun_number=t["readUint"+8*(this.length_size_of_trun_num+1)](),this.sample_number=t["readUint"+8*(this.length_size_of_sample_num+1)]()})),h.createFullBoxCtor("tkhd",(function(t){1==this.version?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.track_id=t.readUint32(),t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.track_id=t.readUint32(),t.readUint32(),this.duration=t.readUint32()),t.readUint32Array(2),this.layer=t.readInt16(),this.alternate_group=t.readInt16(),this.volume=t.readInt16()>>8,t.readUint16(),this.matrix=t.readInt32Array(9),this.width=t.readUint32(),this.height=t.readUint32()})),h.createBoxCtor("tmax",(function(t){this.time=t.readUint32()})),h.createBoxCtor("tmin",(function(t){this.time=t.readUint32()})),h.createBoxCtor("totl",(function(t){this.bytessent=t.readUint32()})),h.createBoxCtor("tpay",(function(t){this.bytessent=t.readUint32()})),h.createBoxCtor("tpyl",(function(t){this.bytessent=t.readUint64()})),h.TrackGroupTypeBox.prototype.parse=function(t){this.parseFullHeader(t),this.track_group_id=t.readUint32()},h.createTrackGroupCtor("msrc"),h.TrackReferenceTypeBox=function(t,e,i,n){h.Box.call(this,t,e),this.hdr_size=i,this.start=n},h.TrackReferenceTypeBox.prototype=new h.Box,h.TrackReferenceTypeBox.prototype.parse=function(t){this.track_ids=t.readUint32Array((this.size-this.hdr_size)/4)},h.trefBox.prototype.parse=function(t){for(var e,i;t.getPosition()<this.start+this.size;){if((e=h.parseOneBox(t,!0,this.size-(t.getPosition()-this.start))).code!==h.OK)return;(i=new h.TrackReferenceTypeBox(e.type,e.size,e.hdr_size,e.start)).write===h.Box.prototype.write&&"mdat"!==i.type&&(n.info("BoxParser","TrackReference "+i.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),i.parseDataAndRewind(t)),i.parse(t),this.boxes.push(i)}},h.createFullBoxCtor("trep",(function(t){for(this.track_ID=t.readUint32(),this.boxes=[];t.getPosition()<this.start+this.size;){if(ret=h.parseOneBox(t,!1,this.size-(t.getPosition()-this.start)),ret.code!==h.OK)return;box=ret.box,this.boxes.push(box)}})),h.createFullBoxCtor("trex",(function(t){this.track_id=t.readUint32(),this.default_sample_description_index=t.readUint32(),this.default_sample_duration=t.readUint32(),this.default_sample_size=t.readUint32(),this.default_sample_flags=t.readUint32()})),h.createBoxCtor("trpy",(function(t){this.bytessent=t.readUint64()})),h.createFullBoxCtor("trun",(function(t){var e=0;if(this.sample_count=t.readUint32(),e+=4,this.size-this.hdr_size>e&&this.flags&h.TRUN_FLAGS_DATA_OFFSET?(this.data_offset=t.readInt32(),e+=4):this.data_offset=0,this.size-this.hdr_size>e&&this.flags&h.TRUN_FLAGS_FIRST_FLAG?(this.first_sample_flags=t.readUint32(),e+=4):this.first_sample_flags=0,this.sample_duration=[],this.sample_size=[],this.sample_flags=[],this.sample_composition_time_offset=[],this.size-this.hdr_size>e)for(var i=0;i<this.sample_count;i++)this.flags&h.TRUN_FLAGS_DURATION&&(this.sample_duration[i]=t.readUint32()),this.flags&h.TRUN_FLAGS_SIZE&&(this.sample_size[i]=t.readUint32()),this.flags&h.TRUN_FLAGS_FLAGS&&(this.sample_flags[i]=t.readUint32()),this.flags&h.TRUN_FLAGS_CTS_OFFSET&&(0===this.version?this.sample_composition_time_offset[i]=t.readUint32():this.sample_composition_time_offset[i]=t.readInt32())})),h.createFullBoxCtor("tsel",(function(t){this.switch_group=t.readUint32();var e=(this.size-this.hdr_size-4)/4;this.attribute_list=[];for(var i=0;i<e;i++)this.attribute_list[i]=t.readUint32()})),h.createFullBoxCtor("txtC",(function(t){this.config=t.readCString()})),h.createFullBoxCtor("url ",(function(t){1!==this.flags&&(this.location=t.readCString())})),h.createFullBoxCtor("urn ",(function(t){this.name=t.readCString(),this.size-this.hdr_size-this.name.length-1>0&&(this.location=t.readCString())})),h.createUUIDBox("a5d40b30e81411ddba2f0800200c9a66",!0,!1,(function(t){this.LiveServerManifest=t.readString(this.size-this.hdr_size).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")})),h.createUUIDBox("d08a4f1810f34a82b6c832d8aba183d3",!0,!1,(function(t){this.system_id=h.parseHex16(t);var e=t.readUint32();e>0&&(this.data=t.readUint8Array(e))})),h.createUUIDBox("a2394f525a9b4f14a2446c427c648df4",!0,!1),h.createUUIDBox("8974dbce7be74c5184f97148f9882554",!0,!1,(function(t){this.default_AlgorithmID=t.readUint24(),this.default_IV_size=t.readUint8(),this.default_KID=h.parseHex16(t)})),h.createUUIDBox("d4807ef2ca3946958e5426cb9e46a79f",!0,!1,(function(t){this.fragment_count=t.readUint8(),this.entries=[];for(var e=0;e<this.fragment_count;e++){var i={},n=0,s=0;1===this.version?(n=t.readUint64(),s=t.readUint64()):(n=t.readUint32(),s=t.readUint32()),i.absolute_time=n,i.absolute_duration=s,this.entries.push(i)}})),h.createUUIDBox("6d1d9b0542d544e680e2141daff757b2",!0,!1,(function(t){1===this.version?(this.absolute_time=t.readUint64(),this.duration=t.readUint64()):(this.absolute_time=t.readUint32(),this.duration=t.readUint32())})),h.createFullBoxCtor("vmhd",(function(t){this.graphicsmode=t.readUint16(),this.opcolor=t.readUint16Array(3)})),h.createFullBoxCtor("vpcC",(function(t){var e;1===this.version?(this.profile=t.readUint8(),this.level=t.readUint8(),e=t.readUint8(),this.bitDepth=e>>4,this.chromaSubsampling=e>>1&7,this.videoFullRangeFlag=1&e,this.colourPrimaries=t.readUint8(),this.transferCharacteristics=t.readUint8(),this.matrixCoefficients=t.readUint8(),this.codecIntializationDataSize=t.readUint16(),this.codecIntializationData=t.readUint8Array(this.codecIntializationDataSize)):(this.profile=t.readUint8(),this.level=t.readUint8(),e=t.readUint8(),this.bitDepth=e>>4&15,this.colorSpace=15&e,e=t.readUint8(),this.chromaSubsampling=e>>4&15,this.transferFunction=e>>1&7,this.videoFullRangeFlag=1&e,this.codecIntializationDataSize=t.readUint16(),this.codecIntializationData=t.readUint8Array(this.codecIntializationDataSize))})),h.createBoxCtor("vttC",(function(t){this.text=t.readString(this.size-this.hdr_size)})),h.createFullBoxCtor("vvcC",(function(t){var e,i,n={held_bits:void 0,num_held_bits:0,stream_read_1_bytes:function(t){this.held_bits=t.readUint8(),this.num_held_bits=8},stream_read_2_bytes:function(t){this.held_bits=t.readUint16(),this.num_held_bits=16},extract_bits:function(t){var e=this.held_bits>>this.num_held_bits-t&(1<<t)-1;return this.num_held_bits-=t,e}};if(n.stream_read_1_bytes(t),n.extract_bits(5),this.lengthSizeMinusOne=n.extract_bits(2),this.ptl_present_flag=n.extract_bits(1),this.ptl_present_flag){if(n.stream_read_2_bytes(t),this.ols_idx=n.extract_bits(9),this.num_sublayers=n.extract_bits(3),this.constant_frame_rate=n.extract_bits(2),this.chroma_format_idc=n.extract_bits(2),n.stream_read_1_bytes(t),this.bit_depth_minus8=n.extract_bits(3),n.extract_bits(5),n.stream_read_2_bytes(t),n.extract_bits(2),this.num_bytes_constraint_info=n.extract_bits(6),this.general_profile_idc=n.extract_bits(7),this.general_tier_flag=n.extract_bits(1),this.general_level_idc=t.readUint8(),n.stream_read_1_bytes(t),this.ptl_frame_only_constraint_flag=n.extract_bits(1),this.ptl_multilayer_enabled_flag=n.extract_bits(1),this.general_constraint_info=new Uint8Array(this.num_bytes_constraint_info),this.num_bytes_constraint_info){for(e=0;e<this.num_bytes_constraint_info-1;e++){var s=n.extract_bits(6);n.stream_read_1_bytes(t);var A=n.extract_bits(2);this.general_constraint_info[e]=s<<2|A}this.general_constraint_info[this.num_bytes_constraint_info-1]=n.extract_bits(6)}else n.extract_bits(6);for(n.stream_read_1_bytes(t),this.ptl_sublayer_present_mask=0,i=this.num_sublayers-2;i>=0;--i){var r=n.extract_bits(1);this.ptl_sublayer_present_mask|=r<<i}for(i=this.num_sublayers;i<=8&&this.num_sublayers>1;++i)n.extract_bits(1);for(i=this.num_sublayers-2;i>=0;--i)this.ptl_sublayer_present_mask&1<<i&&(this.sublayer_level_idc[i]=t.readUint8());if(this.ptl_num_sub_profiles=t.readUint8(),this.general_sub_profile_idc=[],this.ptl_num_sub_profiles)for(e=0;e<this.ptl_num_sub_profiles;e++)this.general_sub_profile_idc.push(t.readUint32());this.max_picture_width=t.readUint16(),this.max_picture_height=t.readUint16(),this.avg_frame_rate=t.readUint16()}this.nalu_arrays=[];var o=t.readUint8();for(e=0;e<o;e++){var a=[];this.nalu_arrays.push(a),n.stream_read_1_bytes(t),a.completeness=n.extract_bits(1),n.extract_bits(2),a.nalu_type=n.extract_bits(5);var h=1;for(13!=a.nalu_type&&12!=a.nalu_type&&(h=t.readUint16()),i=0;i<h;i++){var l=t.readUint16();a.push({data:t.readUint8Array(l),length:l})}}})),h.createFullBoxCtor("vvnC",(function(t){var e=strm.readUint8();this.lengthSizeMinusOne=3&e})),h.SampleEntry.prototype.isVideo=function(){return!1},h.SampleEntry.prototype.isAudio=function(){return!1},h.SampleEntry.prototype.isSubtitle=function(){return!1},h.SampleEntry.prototype.isMetadata=function(){return!1},h.SampleEntry.prototype.isHint=function(){return!1},h.SampleEntry.prototype.getCodec=function(){return this.type.replace(".","")},h.SampleEntry.prototype.getWidth=function(){return""},h.SampleEntry.prototype.getHeight=function(){return""},h.SampleEntry.prototype.getChannelCount=function(){return""},h.SampleEntry.prototype.getSampleRate=function(){return""},h.SampleEntry.prototype.getSampleSize=function(){return""},h.VisualSampleEntry.prototype.isVideo=function(){return!0},h.VisualSampleEntry.prototype.getWidth=function(){return this.width},h.VisualSampleEntry.prototype.getHeight=function(){return this.height},h.AudioSampleEntry.prototype.isAudio=function(){return!0},h.AudioSampleEntry.prototype.getChannelCount=function(){return this.channel_count},h.AudioSampleEntry.prototype.getSampleRate=function(){return this.samplerate},h.AudioSampleEntry.prototype.getSampleSize=function(){return this.samplesize},h.SubtitleSampleEntry.prototype.isSubtitle=function(){return!0},h.MetadataSampleEntry.prototype.isMetadata=function(){return!0},h.decimalToHex=function(t,e){var i=Number(t).toString(16);for(e=null==e?e=2:e;i.length<e;)i="0"+i;return i},h.avc1SampleEntry.prototype.getCodec=h.avc2SampleEntry.prototype.getCodec=h.avc3SampleEntry.prototype.getCodec=h.avc4SampleEntry.prototype.getCodec=function(){var t=h.SampleEntry.prototype.getCodec.call(this);return this.avcC?t+"."+h.decimalToHex(this.avcC.AVCProfileIndication)+h.decimalToHex(this.avcC.profile_compatibility)+h.decimalToHex(this.avcC.AVCLevelIndication):t},h.hev1SampleEntry.prototype.getCodec=h.hvc1SampleEntry.prototype.getCodec=function(){var t,e=h.SampleEntry.prototype.getCodec.call(this);if(this.hvcC){switch(e+=".",this.hvcC.general_profile_space){case 0:e+="";break;case 1:e+="A";break;case 2:e+="B";break;case 3:e+="C"}e+=this.hvcC.general_profile_idc,e+=".";var i=this.hvcC.general_profile_compatibility,n=0;for(t=0;t<32&&(n|=1&i,31!=t);t++)n<<=1,i>>=1;e+=h.decimalToHex(n,0),e+=".",0===this.hvcC.general_tier_flag?e+="L":e+="H",e+=this.hvcC.general_level_idc;var s=!1,A="";for(t=5;t>=0;t--)(this.hvcC.general_constraint_indicator[t]||s)&&(A="."+h.decimalToHex(this.hvcC.general_constraint_indicator[t],0)+A,s=!0);e+=A}return e},h.vvc1SampleEntry.prototype.getCodec=h.vvi1SampleEntry.prototype.getCodec=function(){var t,e=h.SampleEntry.prototype.getCodec.call(this);if(this.vvcC){e+="."+this.vvcC.general_profile_idc,this.vvcC.general_tier_flag?e+=".H":e+=".L",e+=this.vvcC.general_level_idc;var i="";if(this.vvcC.general_constraint_info){var n,s=[],A=0;for(A|=this.vvcC.ptl_frame_only_constraint<<7,A|=this.vvcC.ptl_multilayer_enabled<<6,t=0;t<this.vvcC.general_constraint_info.length;++t)A|=this.vvcC.general_constraint_info[t]>>2&63,s.push(A),A&&(n=t),A=this.vvcC.general_constraint_info[t]>>2&3;if(void 0===n)i=".CA";else{i=".C";var r=0,o=0;for(t=0;t<=n;++t)for(r=r<<8|s[t],o+=8;o>=5;){i+="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"[r>>o-5&31],r&=(1<<(o-=5))-1}o&&(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"[31&(r<<=5-o)])}}e+=i}return e},h.mp4aSampleEntry.prototype.getCodec=function(){var t=h.SampleEntry.prototype.getCodec.call(this);if(this.esds&&this.esds.esd){var e=this.esds.esd.getOTI(),i=this.esds.esd.getAudioConfig();return t+"."+h.decimalToHex(e)+(i?"."+i:"")}return t},h.stxtSampleEntry.prototype.getCodec=function(){var t=h.SampleEntry.prototype.getCodec.call(this);return this.mime_format?t+"."+this.mime_format:t},h.vp08SampleEntry.prototype.getCodec=h.vp09SampleEntry.prototype.getCodec=function(){var t=h.SampleEntry.prototype.getCodec.call(this),e=this.vpcC.level;0==e&&(e="00");var i=this.vpcC.bitDepth;return 8==i&&(i="08"),t+".0"+this.vpcC.profile+"."+e+"."+i},h.av01SampleEntry.prototype.getCodec=function(){var t,e=h.SampleEntry.prototype.getCodec.call(this),i=this.av1C.seq_level_idx_0;return i<10&&(i="0"+i),2===this.av1C.seq_profile&&1===this.av1C.high_bitdepth?t=1===this.av1C.twelve_bit?"12":"10":this.av1C.seq_profile<=2&&(t=1===this.av1C.high_bitdepth?"10":"08"),e+"."+this.av1C.seq_profile+"."+i+(this.av1C.seq_tier_0?"H":"M")+"."+t},h.Box.prototype.writeHeader=function(t,e){this.size+=8,this.size>r&&(this.size+=8),"uuid"===this.type&&(this.size+=16),n.debug("BoxWriter","Writing box "+this.type+" of size: "+this.size+" at position "+t.getPosition()+(e||"")),this.size>r?t.writeUint32(1):(this.sizePosition=t.getPosition(),t.writeUint32(this.size)),t.writeString(this.type,null,4),"uuid"===this.type&&t.writeUint8Array(this.uuid),this.size>r&&t.writeUint64(this.size)},h.FullBox.prototype.writeHeader=function(t){this.size+=4,h.Box.prototype.writeHeader.call(this,t," v="+this.version+" f="+this.flags),t.writeUint8(this.version),t.writeUint24(this.flags)},h.Box.prototype.write=function(t){"mdat"===this.type?this.data&&(this.size=this.data.length,this.writeHeader(t),t.writeUint8Array(this.data)):(this.size=this.data?this.data.length:0,this.writeHeader(t),this.data&&t.writeUint8Array(this.data))},h.ContainerBox.prototype.write=function(t){this.size=0,this.writeHeader(t);for(var e=0;e<this.boxes.length;e++)this.boxes[e]&&(this.boxes[e].write(t),this.size+=this.boxes[e].size);n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},h.TrackReferenceTypeBox.prototype.write=function(t){this.size=4*this.track_ids.length,this.writeHeader(t),t.writeUint32Array(this.track_ids)},h.avcCBox.prototype.write=function(t){var e;for(this.size=7,e=0;e<this.SPS.length;e++)this.size+=2+this.SPS[e].length;for(e=0;e<this.PPS.length;e++)this.size+=2+this.PPS[e].length;for(this.ext&&(this.size+=this.ext.length),this.writeHeader(t),t.writeUint8(this.configurationVersion),t.writeUint8(this.AVCProfileIndication),t.writeUint8(this.profile_compatibility),t.writeUint8(this.AVCLevelIndication),t.writeUint8(this.lengthSizeMinusOne+252),t.writeUint8(this.SPS.length+224),e=0;e<this.SPS.length;e++)t.writeUint16(this.SPS[e].length),t.writeUint8Array(this.SPS[e].nalu);for(t.writeUint8(this.PPS.length),e=0;e<this.PPS.length;e++)t.writeUint16(this.PPS[e].length),t.writeUint8Array(this.PPS[e].nalu);this.ext&&t.writeUint8Array(this.ext)},h.co64Box.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=4+8*this.chunk_offsets.length,this.writeHeader(t),t.writeUint32(this.chunk_offsets.length),e=0;e<this.chunk_offsets.length;e++)t.writeUint64(this.chunk_offsets[e])},h.cslgBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=20,this.writeHeader(t),t.writeInt32(this.compositionToDTSShift),t.writeInt32(this.leastDecodeToDisplayDelta),t.writeInt32(this.greatestDecodeToDisplayDelta),t.writeInt32(this.compositionStartTime),t.writeInt32(this.compositionEndTime)},h.cttsBox.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(t),t.writeUint32(this.sample_counts.length),e=0;e<this.sample_counts.length;e++)t.writeUint32(this.sample_counts[e]),1===this.version?t.writeInt32(this.sample_offsets[e]):t.writeUint32(this.sample_offsets[e])},h.drefBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.entries.length);for(var e=0;e<this.entries.length;e++)this.entries[e].write(t),this.size+=this.entries[e].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},h.elngBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=this.extended_language.length,this.writeHeader(t),t.writeString(this.extended_language)},h.elstBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+12*this.entries.length,this.writeHeader(t),t.writeUint32(this.entries.length);for(var e=0;e<this.entries.length;e++){var i=this.entries[e];t.writeUint32(i.segment_duration),t.writeInt32(i.media_time),t.writeInt16(i.media_rate_integer),t.writeInt16(i.media_rate_fraction)}},h.emsgBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=16+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1),this.writeHeader(t),t.writeCString(this.scheme_id_uri),t.writeCString(this.value),t.writeUint32(this.timescale),t.writeUint32(this.presentation_time_delta),t.writeUint32(this.event_duration),t.writeUint32(this.id),t.writeUint8Array(this.message_data)},h.ftypBox.prototype.write=function(t){this.size=8+4*this.compatible_brands.length,this.writeHeader(t),t.writeString(this.major_brand,null,4),t.writeUint32(this.minor_version);for(var e=0;e<this.compatible_brands.length;e++)t.writeString(this.compatible_brands[e],null,4)},h.hdlrBox.prototype.write=function(t){this.size=20+this.name.length+1,this.version=0,this.flags=0,this.writeHeader(t),t.writeUint32(0),t.writeString(this.handler,null,4),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeCString(this.name)},h.kindBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=this.schemeURI.length+1+(this.value.length+1),this.writeHeader(t),t.writeCString(this.schemeURI),t.writeCString(this.value)},h.mdhdBox.prototype.write=function(t){this.size=20,this.flags=0,this.version=0,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.timescale),t.writeUint32(this.duration),t.writeUint16(this.language),t.writeUint16(0)},h.mehdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.fragment_duration)},h.mfhdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.sequence_number)},h.mvhdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=96,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.timescale),t.writeUint32(this.duration),t.writeUint32(this.rate),t.writeUint16(this.volume<<8),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32Array(this.matrix),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(this.next_track_id)},h.SampleEntry.prototype.writeHeader=function(t){this.size=8,h.Box.prototype.writeHeader.call(this,t),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint16(this.data_reference_index)},h.SampleEntry.prototype.writeFooter=function(t){for(var e=0;e<this.boxes.length;e++)this.boxes[e].write(t),this.size+=this.boxes[e].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},h.SampleEntry.prototype.write=function(t){this.writeHeader(t),t.writeUint8Array(this.data),this.size+=this.data.length,n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},h.VisualSampleEntry.prototype.write=function(t){this.writeHeader(t),this.size+=70,t.writeUint16(0),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint16(this.width),t.writeUint16(this.height),t.writeUint32(this.horizresolution),t.writeUint32(this.vertresolution),t.writeUint32(0),t.writeUint16(this.frame_count),t.writeUint8(Math.min(31,this.compressorname.length)),t.writeString(this.compressorname,null,31),t.writeUint16(this.depth),t.writeInt16(-1),this.writeFooter(t)},h.AudioSampleEntry.prototype.write=function(t){this.writeHeader(t),this.size+=20,t.writeUint32(0),t.writeUint32(0),t.writeUint16(this.channel_count),t.writeUint16(this.samplesize),t.writeUint16(0),t.writeUint16(0),t.writeUint32(this.samplerate<<16),this.writeFooter(t)},h.stppSampleEntry.prototype.write=function(t){this.writeHeader(t),this.size+=this.namespace.length+1+this.schema_location.length+1+this.auxiliary_mime_types.length+1,t.writeCString(this.namespace),t.writeCString(this.schema_location),t.writeCString(this.auxiliary_mime_types),this.writeFooter(t)},h.SampleGroupEntry.prototype.write=function(t){t.writeUint8Array(this.data)},h.sbgpBox.prototype.write=function(t){this.version=1,this.flags=0,this.size=12+8*this.entries.length,this.writeHeader(t),t.writeString(this.grouping_type,null,4),t.writeUint32(this.grouping_type_parameter),t.writeUint32(this.entries.length);for(var e=0;e<this.entries.length;e++){var i=this.entries[e];t.writeInt32(i.sample_count),t.writeInt32(i.group_description_index)}},h.sgpdBox.prototype.write=function(t){var e,i;for(this.flags=0,this.size=12,e=0;e<this.entries.length;e++)i=this.entries[e],1===this.version&&(0===this.default_length&&(this.size+=4),this.size+=i.data.length);for(this.writeHeader(t),t.writeString(this.grouping_type,null,4),1===this.version&&t.writeUint32(this.default_length),this.version>=2&&t.writeUint32(this.default_sample_description_index),t.writeUint32(this.entries.length),e=0;e<this.entries.length;e++)i=this.entries[e],1===this.version&&0===this.default_length&&t.writeUint32(i.description_length),i.write(t)},h.sidxBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=20+12*this.references.length,this.writeHeader(t),t.writeUint32(this.reference_ID),t.writeUint32(this.timescale),t.writeUint32(this.earliest_presentation_time),t.writeUint32(this.first_offset),t.writeUint16(0),t.writeUint16(this.references.length);for(var e=0;e<this.references.length;e++){var i=this.references[e];t.writeUint32(i.reference_type<<31|i.referenced_size),t.writeUint32(i.subsegment_duration),t.writeUint32(i.starts_with_SAP<<31|i.SAP_type<<28|i.SAP_delta_time)}},h.smhdBox.prototype.write=function(t){this.version=0,this.flags=1,this.size=4,this.writeHeader(t),t.writeUint16(this.balance),t.writeUint16(0)},h.stcoBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+4*this.chunk_offsets.length,this.writeHeader(t),t.writeUint32(this.chunk_offsets.length),t.writeUint32Array(this.chunk_offsets)},h.stscBox.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=4+12*this.first_chunk.length,this.writeHeader(t),t.writeUint32(this.first_chunk.length),e=0;e<this.first_chunk.length;e++)t.writeUint32(this.first_chunk[e]),t.writeUint32(this.samples_per_chunk[e]),t.writeUint32(this.sample_description_index[e])},h.stsdBox.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=0,this.writeHeader(t),t.writeUint32(this.entries.length),this.size+=4,e=0;e<this.entries.length;e++)this.entries[e].write(t),this.size+=this.entries[e].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},h.stshBox.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=4+8*this.shadowed_sample_numbers.length,this.writeHeader(t),t.writeUint32(this.shadowed_sample_numbers.length),e=0;e<this.shadowed_sample_numbers.length;e++)t.writeUint32(this.shadowed_sample_numbers[e]),t.writeUint32(this.sync_sample_numbers[e])},h.stssBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+4*this.sample_numbers.length,this.writeHeader(t),t.writeUint32(this.sample_numbers.length),t.writeUint32Array(this.sample_numbers)},h.stszBox.prototype.write=function(t){var e,i=!0;if(this.version=0,this.flags=0,this.sample_sizes.length>0)for(e=0;e+1<this.sample_sizes.length;){if(this.sample_sizes[e+1]!==this.sample_sizes[0]){i=!1;break}e++}else i=!1;this.size=8,i||(this.size+=4*this.sample_sizes.length),this.writeHeader(t),i?t.writeUint32(this.sample_sizes[0]):t.writeUint32(0),t.writeUint32(this.sample_sizes.length),i||t.writeUint32Array(this.sample_sizes)},h.sttsBox.prototype.write=function(t){var e;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(t),t.writeUint32(this.sample_counts.length),e=0;e<this.sample_counts.length;e++)t.writeUint32(this.sample_counts[e]),t.writeUint32(this.sample_deltas[e])},h.tfdtBox.prototype.write=function(t){var e=Math.pow(2,32)-1;this.version=this.baseMediaDecodeTime>e?1:0,this.flags=0,this.size=4,1===this.version&&(this.size+=4),this.writeHeader(t),1===this.version?t.writeUint64(this.baseMediaDecodeTime):t.writeUint32(this.baseMediaDecodeTime)},h.tfhdBox.prototype.write=function(t){this.version=0,this.size=4,this.flags&h.TFHD_FLAG_BASE_DATA_OFFSET&&(this.size+=8),this.flags&h.TFHD_FLAG_SAMPLE_DESC&&(this.size+=4),this.flags&h.TFHD_FLAG_SAMPLE_DUR&&(this.size+=4),this.flags&h.TFHD_FLAG_SAMPLE_SIZE&&(this.size+=4),this.flags&h.TFHD_FLAG_SAMPLE_FLAGS&&(this.size+=4),this.writeHeader(t),t.writeUint32(this.track_id),this.flags&h.TFHD_FLAG_BASE_DATA_OFFSET&&t.writeUint64(this.base_data_offset),this.flags&h.TFHD_FLAG_SAMPLE_DESC&&t.writeUint32(this.default_sample_description_index),this.flags&h.TFHD_FLAG_SAMPLE_DUR&&t.writeUint32(this.default_sample_duration),this.flags&h.TFHD_FLAG_SAMPLE_SIZE&&t.writeUint32(this.default_sample_size),this.flags&h.TFHD_FLAG_SAMPLE_FLAGS&&t.writeUint32(this.default_sample_flags)},h.tkhdBox.prototype.write=function(t){this.version=0,this.size=80,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.track_id),t.writeUint32(0),t.writeUint32(this.duration),t.writeUint32(0),t.writeUint32(0),t.writeInt16(this.layer),t.writeInt16(this.alternate_group),t.writeInt16(this.volume<<8),t.writeUint16(0),t.writeInt32Array(this.matrix),t.writeUint32(this.width),t.writeUint32(this.height)},h.trexBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=20,this.writeHeader(t),t.writeUint32(this.track_id),t.writeUint32(this.default_sample_description_index),t.writeUint32(this.default_sample_duration),t.writeUint32(this.default_sample_size),t.writeUint32(this.default_sample_flags)},h.trunBox.prototype.write=function(t){this.version=0,this.size=4,this.flags&h.TRUN_FLAGS_DATA_OFFSET&&(this.size+=4),this.flags&h.TRUN_FLAGS_FIRST_FLAG&&(this.size+=4),this.flags&h.TRUN_FLAGS_DURATION&&(this.size+=4*this.sample_duration.length),this.flags&h.TRUN_FLAGS_SIZE&&(this.size+=4*this.sample_size.length),this.flags&h.TRUN_FLAGS_FLAGS&&(this.size+=4*this.sample_flags.length),this.flags&h.TRUN_FLAGS_CTS_OFFSET&&(this.size+=4*this.sample_composition_time_offset.length),this.writeHeader(t),t.writeUint32(this.sample_count),this.flags&h.TRUN_FLAGS_DATA_OFFSET&&(this.data_offset_position=t.getPosition(),t.writeInt32(this.data_offset)),this.flags&h.TRUN_FLAGS_FIRST_FLAG&&t.writeUint32(this.first_sample_flags);for(var e=0;e<this.sample_count;e++)this.flags&h.TRUN_FLAGS_DURATION&&t.writeUint32(this.sample_duration[e]),this.flags&h.TRUN_FLAGS_SIZE&&t.writeUint32(this.sample_size[e]),this.flags&h.TRUN_FLAGS_FLAGS&&t.writeUint32(this.sample_flags[e]),this.flags&h.TRUN_FLAGS_CTS_OFFSET&&(0===this.version?t.writeUint32(this.sample_composition_time_offset[e]):t.writeInt32(this.sample_composition_time_offset[e]))},h["url Box"].prototype.write=function(t){this.version=0,this.location?(this.flags=0,this.size=this.location.length+1):(this.flags=1,this.size=0),this.writeHeader(t),this.location&&t.writeCString(this.location)},h["urn Box"].prototype.write=function(t){this.version=0,this.flags=0,this.size=this.name.length+1+(this.location?this.location.length+1:0),this.writeHeader(t),t.writeCString(this.name),this.location&&t.writeCString(this.location)},h.vmhdBox.prototype.write=function(t){this.version=0,this.flags=1,this.size=8,this.writeHeader(t),t.writeUint16(this.graphicsmode),t.writeUint16Array(this.opcolor)},h.cttsBox.prototype.unpack=function(t){var e,i,n;for(n=0,e=0;e<this.sample_counts.length;e++)for(i=0;i<this.sample_counts[e];i++)t[n].pts=t[n].dts+this.sample_offsets[e],n++},h.sttsBox.prototype.unpack=function(t){var e,i,n;for(n=0,e=0;e<this.sample_counts.length;e++)for(i=0;i<this.sample_counts[e];i++)t[n].dts=0===n?0:t[n-1].dts+this.sample_deltas[e],n++},h.stcoBox.prototype.unpack=function(t){var e;for(e=0;e<this.chunk_offsets.length;e++)t[e].offset=this.chunk_offsets[e]},h.stscBox.prototype.unpack=function(t){var e,i,n,s,A;for(s=0,A=0,e=0;e<this.first_chunk.length;e++)for(i=0;i<(e+1<this.first_chunk.length?this.first_chunk[e+1]:1/0);i++)for(A++,n=0;n<this.samples_per_chunk[e];n++){if(!t[s])return;t[s].description_index=this.sample_description_index[e],t[s].chunk_index=A,s++}},h.stszBox.prototype.unpack=function(t){var e;for(e=0;e<this.sample_sizes.length;e++)t[e].size=this.sample_sizes[e]},h.DIFF_BOXES_PROP_NAMES=["boxes","entries","references","subsamples","items","item_infos","extents","associations","subsegments","ranges","seekLists","seekPoints","esd","levels"],h.DIFF_PRIMITIVE_ARRAY_PROP_NAMES=["compatible_brands","matrix","opcolor","sample_counts","sample_counts","sample_deltas","first_chunk","samples_per_chunk","sample_sizes","chunk_offsets","sample_offsets","sample_description_index","sample_duration"],h.boxEqualFields=function(t,e){if(t&&!e)return!1;var i;for(i in t)if(!(h.DIFF_BOXES_PROP_NAMES.indexOf(i)>-1||t[i]instanceof h.Box||e[i]instanceof h.Box||void 0===t[i]||void 0===e[i]||"function"==typeof t[i]||"function"==typeof e[i]||t.subBoxNames&&t.subBoxNames.indexOf(i.slice(0,4))>-1||e.subBoxNames&&e.subBoxNames.indexOf(i.slice(0,4))>-1||"data"===i||"start"===i||"size"===i||"creation_time"===i||"modification_time"===i||h.DIFF_PRIMITIVE_ARRAY_PROP_NAMES.indexOf(i)>-1||t[i]===e[i]))return!1;return!0},h.boxEqual=function(t,e){if(!h.boxEqualFields(t,e))return!1;for(var i=0;i<h.DIFF_BOXES_PROP_NAMES.length;i++){var n=h.DIFF_BOXES_PROP_NAMES[i];if(t[n]&&e[n]&&!h.boxEqual(t[n],e[n]))return!1}return!0};var l=function(){};l.prototype.parseSample=function(t){var e,i={};i.resources=[];var n=new s(t.data.buffer);if(t.subsamples&&0!==t.subsamples.length){if(i.documentString=n.readString(t.subsamples[0].size),t.subsamples.length>1)for(e=1;e<t.subsamples.length;e++)i.resources[e]=n.readUint8Array(t.subsamples[e].size)}else i.documentString=n.readString(t.data.length);return"undefined"!=typeof DOMParser&&(i.document=(new DOMParser).parseFromString(i.documentString,"application/xml")),i};var d=function(){};d.prototype.parseSample=function(t){return new s(t.data.buffer).readString(t.data.length)},d.prototype.parseConfig=function(t){var e=new s(t.buffer);return e.readUint32(),e.readCString()},t.XMLSubtitlein4Parser=l,t.Textin4Parser=d;var p=function(t){this.stream=t||new o,this.boxes=[],this.mdats=[],this.moofs=[],this.isProgressive=!1,this.moovStartFound=!1,this.onMoovStart=null,this.moovStartSent=!1,this.onReady=null,this.readySent=!1,this.onSegment=null,this.onSamples=null,this.onError=null,this.sampleListBuilt=!1,this.fragmentedTracks=[],this.extractedTracks=[],this.isFragmentationInitialized=!1,this.sampleProcessingStarted=!1,this.nextMoofNumber=0,this.itemListBuilt=!1,this.onSidx=null,this.sidxSent=!1};p.prototype.setSegmentOptions=function(t,e,i){var n=this.getTrackById(t);if(n){var s={};this.fragmentedTracks.push(s),s.id=t,s.user=e,s.trak=n,n.nextSample=0,s.segmentStream=null,s.nb_samples=1e3,s.rapAlignement=!0,i&&(i.nbSamples&&(s.nb_samples=i.nbSamples),i.rapAlignement&&(s.rapAlignement=i.rapAlignement))}},p.prototype.unsetSegmentOptions=function(t){for(var e=-1,i=0;i<this.fragmentedTracks.length;i++){this.fragmentedTracks[i].id==t&&(e=i)}e>-1&&this.fragmentedTracks.splice(e,1)},p.prototype.setExtractionOptions=function(t,e,i){var n=this.getTrackById(t);if(n){var s={};this.extractedTracks.push(s),s.id=t,s.user=e,s.trak=n,n.nextSample=0,s.nb_samples=1e3,s.samples=[],i&&i.nbSamples&&(s.nb_samples=i.nbSamples)}},p.prototype.unsetExtractionOptions=function(t){for(var e=-1,i=0;i<this.extractedTracks.length;i++){this.extractedTracks[i].id==t&&(e=i)}e>-1&&this.extractedTracks.splice(e,1)},p.prototype.parse=function(){var t,e;if(!this.restoreParsePosition||this.restoreParsePosition())for(;;){if(this.hasIncompleteMdat&&this.hasIncompleteMdat()){if(this.processIncompleteMdat())continue;return}if(this.saveParsePosition&&this.saveParsePosition(),(t=h.parseOneBox(this.stream,!1)).code===h.ERR_NOT_ENOUGH_DATA){if(this.processIncompleteBox){if(this.processIncompleteBox(t))continue;return}return}var i;switch(i="uuid"!==(e=t.box).type?e.type:e.uuid,this.boxes.push(e),i){case"mdat":this.mdats.push(e);break;case"moof":this.moofs.push(e);break;case"moov":this.moovStartFound=!0,0===this.mdats.length&&(this.isProgressive=!0);default:void 0!==this[i]&&n.warn("ISOFile","Duplicate Box of type: "+i+", overriding previous occurrence"),this[i]=e}this.updateUsedBytes&&this.updateUsedBytes(e,t)}},p.prototype.checkBuffer=function(t){if(null==t)throw"Buffer must be defined and non empty";if(void 0===t.fileStart)throw"Buffer must have a fileStart property";return 0===t.byteLength?(n.warn("ISOFile","Ignoring empty buffer (fileStart: "+t.fileStart+")"),this.stream.logBufferLevel(),!1):(n.info("ISOFile","Processing buffer (fileStart: "+t.fileStart+")"),t.usedBytes=0,this.stream.insertBuffer(t),this.stream.logBufferLevel(),!!this.stream.initialized()||(n.warn("ISOFile","Not ready to start parsing"),!1))},p.prototype.appendBuffer=function(t,e){var i;if(this.checkBuffer(t))return this.parse(),this.moovStartFound&&!this.moovStartSent&&(this.moovStartSent=!0,this.onMoovStart&&this.onMoovStart()),this.moov?(this.sampleListBuilt||(this.buildSampleLists(),this.sampleListBuilt=!0),this.updateSampleLists(),this.onReady&&!this.readySent&&(this.readySent=!0,this.onReady(this.getInfo())),this.processSamples(e),this.nextSeekPosition?(i=this.nextSeekPosition,this.nextSeekPosition=void 0):i=this.nextParsePosition,this.stream.getEndFilePositionAfter&&(i=this.stream.getEndFilePositionAfter(i))):i=this.nextParsePosition?this.nextParsePosition:0,this.sidx&&this.onSidx&&!this.sidxSent&&(this.onSidx(this.sidx),this.sidxSent=!0),this.meta&&(this.flattenItemInfo&&!this.itemListBuilt&&(this.flattenItemInfo(),this.itemListBuilt=!0),this.processItems&&this.processItems(this.onItem)),this.stream.cleanBuffers&&(n.info("ISOFile","Done processing buffer (fileStart: "+t.fileStart+") - next buffer to fetch should have a fileStart position of "+i),this.stream.logBufferLevel(),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0),n.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize())),i},p.prototype.getInfo=function(){var t,e,i,n,s,A,r={},o=new Date("1904-01-01T00:00:00Z").getTime();if(this.moov)for(r.hasMoov=!0,r.duration=this.moov.mvhd.duration,r.timescale=this.moov.mvhd.timescale,r.isFragmented=null!=this.moov.mvex,r.isFragmented&&this.moov.mvex.mehd&&(r.fragment_duration=this.moov.mvex.mehd.fragment_duration),r.isProgressive=this.isProgressive,r.hasIOD=null!=this.moov.iods,r.brands=[],r.brands.push(this.ftyp.major_brand),r.brands=r.brands.concat(this.ftyp.compatible_brands),r.created=new Date(o+1e3*this.moov.mvhd.creation_time),r.modified=new Date(o+1e3*this.moov.mvhd.modification_time),r.tracks=[],r.audioTracks=[],r.videoTracks=[],r.subtitleTracks=[],r.metadataTracks=[],r.hintTracks=[],r.otherTracks=[],t=0;t<this.moov.traks.length;t++){if(A=(i=this.moov.traks[t]).mdia.minf.stbl.stsd.entries[0],n={},r.tracks.push(n),n.id=i.tkhd.track_id,n.name=i.mdia.hdlr.name,n.references=[],i.tref)for(e=0;e<i.tref.boxes.length;e++)s={},n.references.push(s),s.type=i.tref.boxes[e].type,s.track_ids=i.tref.boxes[e].track_ids;i.edts&&(n.edits=i.edts.elst.entries),n.created=new Date(o+1e3*i.tkhd.creation_time),n.modified=new Date(o+1e3*i.tkhd.modification_time),n.movie_duration=i.tkhd.duration,n.movie_timescale=r.timescale,n.layer=i.tkhd.layer,n.alternate_group=i.tkhd.alternate_group,n.volume=i.tkhd.volume,n.matrix=i.tkhd.matrix,n.track_width=i.tkhd.width/65536,n.track_height=i.tkhd.height/65536,n.timescale=i.mdia.mdhd.timescale,n.cts_shift=i.mdia.minf.stbl.cslg,n.duration=i.mdia.mdhd.duration,n.samples_duration=i.samples_duration,n.codec=A.getCodec(),n.kind=i.udta&&i.udta.kinds.length?i.udta.kinds[0]:{schemeURI:"",value:""},n.language=i.mdia.elng?i.mdia.elng.extended_language:i.mdia.mdhd.languageString,n.nb_samples=i.samples.length,n.size=i.samples_size,n.bitrate=8*n.size*n.timescale/n.samples_duration,A.isAudio()?(n.type="audio",r.audioTracks.push(n),n.audio={},n.audio.sample_rate=A.getSampleRate(),n.audio.channel_count=A.getChannelCount(),n.audio.sample_size=A.getSampleSize()):A.isVideo()?(n.type="video",r.videoTracks.push(n),n.video={},n.video.width=A.getWidth(),n.video.height=A.getHeight()):A.isSubtitle()?(n.type="subtitles",r.subtitleTracks.push(n)):A.isHint()?(n.type="metadata",r.hintTracks.push(n)):A.isMetadata()?(n.type="metadata",r.metadataTracks.push(n)):(n.type="metadata",r.otherTracks.push(n))}else r.hasMoov=!1;if(r.mime="",r.hasMoov&&r.tracks){for(r.videoTracks&&r.videoTracks.length>0?r.mime+='video/mp4; codecs="':r.audioTracks&&r.audioTracks.length>0?r.mime+='audio/mp4; codecs="':r.mime+='application/mp4; codecs="',t=0;t<r.tracks.length;t++)0!==t&&(r.mime+=","),r.mime+=r.tracks[t].codec;r.mime+='"; profiles="',r.mime+=this.ftyp.compatible_brands.join(),r.mime+='"'}return r},p.prototype.processSamples=function(t){var e,i;if(this.sampleProcessingStarted){if(this.isFragmentationInitialized&&null!==this.onSegment)for(e=0;e<this.fragmentedTracks.length;e++){var s=this.fragmentedTracks[e];for(i=s.trak;i.nextSample<i.samples.length&&this.sampleProcessingStarted;){n.debug("ISOFile","Creating media fragment on track #"+s.id+" for sample "+i.nextSample);var A=this.createFragment(s.id,i.nextSample,s.segmentStream);if(!A)break;if(s.segmentStream=A,i.nextSample++,(i.nextSample%s.nb_samples==0||t||i.nextSample>=i.samples.length)&&(n.info("ISOFile","Sending fragmented data on track #"+s.id+" for samples ["+Math.max(0,i.nextSample-s.nb_samples)+","+(i.nextSample-1)+"]"),n.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize()),this.onSegment&&this.onSegment(s.id,s.user,s.segmentStream.buffer,i.nextSample,t||i.nextSample>=i.samples.length),s.segmentStream=null,s!==this.fragmentedTracks[e]))break}}if(null!==this.onSamples)for(e=0;e<this.extractedTracks.length;e++){var r=this.extractedTracks[e];for(i=r.trak;i.nextSample<i.samples.length&&this.sampleProcessingStarted;){n.debug("ISOFile","Exporting on track #"+r.id+" sample #"+i.nextSample);var o=this.getSample(i,i.nextSample);if(!o)break;if(i.nextSample++,r.samples.push(o),(i.nextSample%r.nb_samples==0||i.nextSample>=i.samples.length)&&(n.debug("ISOFile","Sending samples on track #"+r.id+" for sample "+i.nextSample),this.onSamples&&this.onSamples(r.id,r.user,r.samples),r.samples=[],r!==this.extractedTracks[e]))break}}}},p.prototype.getBox=function(t){var e=this.getBoxes(t,!0);return e.length?e[0]:null},p.prototype.getBoxes=function(t,e){var i=[];return p._sweep.call(this,t,i,e),i},p._sweep=function(t,e,i){for(var n in this.type&&this.type==t&&e.push(this),this.boxes){if(e.length&&i)return;p._sweep.call(this.boxes[n],t,e,i)}},p.prototype.getTrackSamplesInfo=function(t){var e=this.getTrackById(t);return e?e.samples:void 0},p.prototype.getTrackSample=function(t,e){var i=this.getTrackById(t);return this.getSample(i,e)},p.prototype.releaseUsedSamples=function(t,e){var i=0,s=this.getTrackById(t);s.lastValidSample||(s.lastValidSample=0);for(var A=s.lastValidSample;A<e;A++)i+=this.releaseSample(s,A);n.info("ISOFile","Track #"+t+" released samples up to "+e+" (released size: "+i+", remaining: "+this.samplesDataSize+")"),s.lastValidSample=e},p.prototype.start=function(){this.sampleProcessingStarted=!0,this.processSamples(!1)},p.prototype.stop=function(){this.sampleProcessingStarted=!1},p.prototype.flush=function(){n.info("ISOFile","Flushing remaining samples"),this.updateSampleLists(),this.processSamples(!0),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0)},p.prototype.seekTrack=function(t,e,i){var s,A,r,o,a=0,h=0;if(0===i.samples.length)return n.info("ISOFile","No sample in track, cannot seek! Using time "+n.getDurationString(0,1)+" and offset: 0"),{offset:0,time:0};for(s=0;s<i.samples.length;s++){if(A=i.samples[s],0===s)h=0,o=A.timescale;else if(A.cts>t*A.timescale){h=s-1;break}e&&A.is_sync&&(a=s)}for(e&&(h=a),t=i.samples[h].cts,i.nextSample=h;i.samples[h].alreadyRead===i.samples[h].size&&i.samples[h+1];)h++;return r=i.samples[h].offset+i.samples[h].alreadyRead,n.info("ISOFile","Seeking to "+(e?"RAP":"")+" sample #"+i.nextSample+" on track "+i.tkhd.track_id+", time "+n.getDurationString(t,o)+" and offset: "+r),{offset:r,time:t/o}},p.prototype.seek=function(t,e){var i,s,A,r=this.moov,o={offset:1/0,time:1/0};if(this.moov){for(A=0;A<r.traks.length;A++)i=r.traks[A],(s=this.seekTrack(t,e,i)).offset<o.offset&&(o.offset=s.offset),s.time<o.time&&(o.time=s.time);return n.info("ISOFile","Seeking at time "+n.getDurationString(o.time,1)+" needs a buffer with a fileStart position of "+o.offset),o.offset===1/0?o={offset:this.nextParsePosition,time:0}:o.offset=this.stream.getEndFilePositionAfter(o.offset),n.info("ISOFile","Adjusted seek position (after checking data already in buffer): "+o.offset),o}throw"Cannot seek: moov not received!"},p.prototype.equal=function(t){for(var e=0;e<this.boxes.length&&e<t.boxes.length;){var i=this.boxes[e],n=t.boxes[e];if(!h.boxEqual(i,n))return!1;e++}return!0},t.ISOFile=p,p.prototype.lastBoxStartPosition=0,p.prototype.parsingMdat=null,p.prototype.nextParsePosition=0,p.prototype.discardMdatData=!1,p.prototype.processIncompleteBox=function(t){var e;return"mdat"===t.type?(e=new h[t.type+"Box"](t.size),this.parsingMdat=e,this.boxes.push(e),this.mdats.push(e),e.start=t.start,e.hdr_size=t.hdr_size,this.stream.addUsedBytes(e.hdr_size),this.lastBoxStartPosition=e.start+e.size,this.stream.seek(e.start+e.size,!1,this.discardMdatData)?(this.parsingMdat=null,!0):(this.moovStartFound?this.nextParsePosition=this.stream.findEndContiguousBuf():this.nextParsePosition=e.start+e.size,!1)):("moov"===t.type&&(this.moovStartFound=!0,0===this.mdats.length&&(this.isProgressive=!0)),!!this.stream.mergeNextBuffer&&this.stream.mergeNextBuffer()?(this.nextParsePosition=this.stream.getEndPosition(),!0):(t.type?this.moovStartFound?this.nextParsePosition=this.stream.getEndPosition():this.nextParsePosition=this.stream.getPosition()+t.size:this.nextParsePosition=this.stream.getEndPosition(),!1))},p.prototype.hasIncompleteMdat=function(){return null!==this.parsingMdat},p.prototype.processIncompleteMdat=function(){var t;return t=this.parsingMdat,this.stream.seek(t.start+t.size,!1,this.discardMdatData)?(n.debug("ISOFile","Found 'mdat' end in buffered data"),this.parsingMdat=null,!0):(this.nextParsePosition=this.stream.findEndContiguousBuf(),!1)},p.prototype.restoreParsePosition=function(){return this.stream.seek(this.lastBoxStartPosition,!0,this.discardMdatData)},p.prototype.saveParsePosition=function(){this.lastBoxStartPosition=this.stream.getPosition()},p.prototype.updateUsedBytes=function(t,e){this.stream.addUsedBytes&&("mdat"===t.type?(this.stream.addUsedBytes(t.hdr_size),this.discardMdatData&&this.stream.addUsedBytes(t.size-t.hdr_size)):this.stream.addUsedBytes(t.size))},p.prototype.add=h.Box.prototype.add,p.prototype.addBox=h.Box.prototype.addBox,p.prototype.init=function(t){var e=t||{};this.add("ftyp").set("major_brand",e.brands&&e.brands[0]||"iso4").set("minor_version",0).set("compatible_brands",e.brands||["iso4"]);var i=this.add("moov");return i.add("mvhd").set("timescale",e.timescale||600).set("rate",e.rate||65536).set("creation_time",0).set("modification_time",0).set("duration",e.duration||0).set("volume",e.width?0:256).set("matrix",[65536,0,0,0,65536,0,0,0,1073741824]).set("next_track_id",1),i.add("mvex"),this},p.prototype.addTrack=function(t){this.moov||this.init(t);var e=t||{};e.width=e.width||320,e.height=e.height||320,e.id=e.id||this.moov.mvhd.next_track_id,e.type=e.type||"avc1";var i=this.moov.add("trak");this.moov.mvhd.next_track_id=e.id+1,i.add("tkhd").set("flags",h.TKHD_FLAG_ENABLED|h.TKHD_FLAG_IN_MOVIE|h.TKHD_FLAG_IN_PREVIEW).set("creation_time",0).set("modification_time",0).set("track_id",e.id).set("duration",e.duration||0).set("layer",e.layer||0).set("alternate_group",0).set("volume",1).set("matrix",[0,0,0,0,0,0,0,0,0]).set("width",e.width<<16).set("height",e.height<<16);var n=i.add("mdia");n.add("mdhd").set("creation_time",0).set("modification_time",0).set("timescale",e.timescale||1).set("duration",e.media_duration||0).set("language",e.language||"und"),n.add("hdlr").set("handler",e.hdlr||"vide").set("name",e.name||"Track created with MP4Box.js"),n.add("elng").set("extended_language",e.language||"fr-FR");var A=n.add("minf");if(void 0!==h[e.type+"SampleEntry"]){var r=new h[e.type+"SampleEntry"];r.data_reference_index=1;var o="";for(var a in h.sampleEntryCodes)for(var l=h.sampleEntryCodes[a],d=0;d<l.length;d++)if(l.indexOf(e.type)>-1){o=a;break}switch(o){case"Visual":if(A.add("vmhd").set("graphicsmode",0).set("opcolor",[0,0,0]),r.set("width",e.width).set("height",e.height).set("horizresolution",72<<16).set("vertresolution",72<<16).set("frame_count",1).set("compressorname",e.type+" Compressor").set("depth",24),e.avcDecoderConfigRecord){var p=new h.avcCBox,c=new s(e.avcDecoderConfigRecord);p.parse(c),r.addBox(p)}break;case"Audio":A.add("smhd").set("balance",e.balance||0),r.set("channel_count",e.channel_count||2).set("samplesize",e.samplesize||16).set("samplerate",e.samplerate||65536);break;case"Hint":A.add("hmhd");break;case"Subtitle":switch(A.add("sthd"),e.type){case"stpp":r.set("namespace",e.namespace||"nonamespace").set("schema_location",e.schema_location||"").set("auxiliary_mime_types",e.auxiliary_mime_types||"")}break;case"Metadata":case"System":default:A.add("nmhd")}e.description&&r.addBox(e.description),e.description_boxes&&e.description_boxes.forEach((function(t){r.addBox(t)})),A.add("dinf").add("dref").addEntry((new h["url Box"]).set("flags",1));var u=A.add("stbl");return u.add("stsd").addEntry(r),u.add("stts").set("sample_counts",[]).set("sample_deltas",[]),u.add("stsc").set("first_chunk",[]).set("samples_per_chunk",[]).set("sample_description_index",[]),u.add("stco").set("chunk_offsets",[]),u.add("stsz").set("sample_sizes",[]),this.moov.mvex.add("trex").set("track_id",e.id).set("default_sample_description_index",e.default_sample_description_index||1).set("default_sample_duration",e.default_sample_duration||0).set("default_sample_size",e.default_sample_size||0).set("default_sample_flags",e.default_sample_flags||0),this.buildTrakSampleLists(i),e.id}},h.Box.prototype.computeSize=function(t){var e=t||new A;e.endianness=A.BIG_ENDIAN,this.write(e)},p.prototype.addSample=function(t,e,i){var n=i||{},s={},A=this.getTrackById(t);if(null!==A){s.number=A.samples.length,s.track_id=A.tkhd.track_id,s.timescale=A.mdia.mdhd.timescale,s.description_index=n.sample_description_index?n.sample_description_index-1:0,s.description=A.mdia.minf.stbl.stsd.entries[s.description_index],s.data=e,s.size=e.byteLength,s.alreadyRead=s.size,s.duration=n.duration||1,s.cts=n.cts||0,s.dts=n.dts||0,s.is_sync=n.is_sync||!1,s.is_leading=n.is_leading||0,s.depends_on=n.depends_on||0,s.is_depended_on=n.is_depended_on||0,s.has_redundancy=n.has_redundancy||0,s.degradation_priority=n.degradation_priority||0,s.offset=0,s.subsamples=n.subsamples,A.samples.push(s),A.samples_size+=s.size,A.samples_duration+=s.duration,A.first_dts||(A.first_dts=n.dts),this.processSamples();var r=this.createSingleSampleMoof(s);return this.addBox(r),r.computeSize(),r.trafs[0].truns[0].data_offset=r.size+8,this.add("mdat").data=new Uint8Array(e),s}},p.prototype.createSingleSampleMoof=function(t){var e=0;e=t.is_sync?1<<25:65536;var i=new h.moofBox;i.add("mfhd").set("sequence_number",this.nextMoofNumber),this.nextMoofNumber++;var n=i.add("traf"),s=this.getTrackById(t.track_id);return n.add("tfhd").set("track_id",t.track_id).set("flags",h.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),n.add("tfdt").set("baseMediaDecodeTime",t.dts-(s.first_dts||0)),n.add("trun").set("flags",h.TRUN_FLAGS_DATA_OFFSET|h.TRUN_FLAGS_DURATION|h.TRUN_FLAGS_SIZE|h.TRUN_FLAGS_FLAGS|h.TRUN_FLAGS_CTS_OFFSET).set("data_offset",0).set("first_sample_flags",0).set("sample_count",1).set("sample_duration",[t.duration]).set("sample_size",[t.size]).set("sample_flags",[e]).set("sample_composition_time_offset",[t.cts-t.dts]),i},p.prototype.lastMoofIndex=0,p.prototype.samplesDataSize=0,p.prototype.resetTables=function(){var t,e,i,n,s,A;for(this.initial_duration=this.moov.mvhd.duration,this.moov.mvhd.duration=0,t=0;t<this.moov.traks.length;t++){(e=this.moov.traks[t]).tkhd.duration=0,e.mdia.mdhd.duration=0,(e.mdia.minf.stbl.stco||e.mdia.minf.stbl.co64).chunk_offsets=[],(i=e.mdia.minf.stbl.stsc).first_chunk=[],i.samples_per_chunk=[],i.sample_description_index=[],(e.mdia.minf.stbl.stsz||e.mdia.minf.stbl.stz2).sample_sizes=[],(n=e.mdia.minf.stbl.stts).sample_counts=[],n.sample_deltas=[],(s=e.mdia.minf.stbl.ctts)&&(s.sample_counts=[],s.sample_offsets=[]),A=e.mdia.minf.stbl.stss;var r=e.mdia.minf.stbl.boxes.indexOf(A);-1!=r&&(e.mdia.minf.stbl.boxes[r]=null)}},p.initSampleGroups=function(t,e,i,n,s){var A,r,o,a;function h(t,e,i){this.grouping_type=t,this.grouping_type_parameter=e,this.sbgp=i,this.last_sample_in_run=-1,this.entry_index=-1}for(e&&(e.sample_groups_info=[]),t.sample_groups_info||(t.sample_groups_info=[]),r=0;r<i.length;r++){for(a=i[r].grouping_type+"/"+i[r].grouping_type_parameter,o=new h(i[r].grouping_type,i[r].grouping_type_parameter,i[r]),e&&(e.sample_groups_info[a]=o),t.sample_groups_info[a]||(t.sample_groups_info[a]=o),A=0;A<n.length;A++)n[A].grouping_type===i[r].grouping_type&&(o.description=n[A],o.description.used=!0);if(s)for(A=0;A<s.length;A++)s[A].grouping_type===i[r].grouping_type&&(o.fragment_description=s[A],o.fragment_description.used=!0,o.is_fragment=!0)}if(e){if(s)for(r=0;r<s.length;r++)!s[r].used&&s[r].version>=2&&(a=s[r].grouping_type+"/0",(o=new h(s[r].grouping_type,0)).is_fragment=!0,e.sample_groups_info[a]||(e.sample_groups_info[a]=o))}else for(r=0;r<n.length;r++)!n[r].used&&n[r].version>=2&&(a=n[r].grouping_type+"/0",o=new h(n[r].grouping_type,0),t.sample_groups_info[a]||(t.sample_groups_info[a]=o))},p.setSampleGroupProperties=function(t,e,i,n){var s,A;for(s in e.sample_groups=[],n){var r;if(e.sample_groups[s]={},e.sample_groups[s].grouping_type=n[s].grouping_type,e.sample_groups[s].grouping_type_parameter=n[s].grouping_type_parameter,i>=n[s].last_sample_in_run&&(n[s].last_sample_in_run<0&&(n[s].last_sample_in_run=0),n[s].entry_index++,n[s].entry_index<=n[s].sbgp.entries.length-1&&(n[s].last_sample_in_run+=n[s].sbgp.entries[n[s].entry_index].sample_count)),n[s].entry_index<=n[s].sbgp.entries.length-1?e.sample_groups[s].group_description_index=n[s].sbgp.entries[n[s].entry_index].group_description_index:e.sample_groups[s].group_description_index=-1,0!==e.sample_groups[s].group_description_index)r=n[s].fragment_description?n[s].fragment_description:n[s].description,e.sample_groups[s].group_description_index>0?(A=e.sample_groups[s].group_description_index>65535?(e.sample_groups[s].group_description_index>>16)-1:e.sample_groups[s].group_description_index-1,r&&A>=0&&(e.sample_groups[s].description=r.entries[A])):r&&r.version>=2&&r.default_group_description_index>0&&(e.sample_groups[s].description=r.entries[r.default_group_description_index-1])}},p.process_sdtp=function(t,e,i){e&&(t?(e.is_leading=t.is_leading[i],e.depends_on=t.sample_depends_on[i],e.is_depended_on=t.sample_is_depended_on[i],e.has_redundancy=t.sample_has_redundancy[i]):(e.is_leading=0,e.depends_on=0,e.is_depended_on=0,e.has_redundancy=0))},p.prototype.buildSampleLists=function(){var t,e;for(t=0;t<this.moov.traks.length;t++)e=this.moov.traks[t],this.buildTrakSampleLists(e)},p.prototype.buildTrakSampleLists=function(t){var e,i,n,s,A,r,o,a,h,l,d,c,u,f,g,m,b,y,v,_,E,B,C,w;if(t.samples=[],t.samples_duration=0,t.samples_size=0,i=t.mdia.minf.stbl.stco||t.mdia.minf.stbl.co64,n=t.mdia.minf.stbl.stsc,s=t.mdia.minf.stbl.stsz||t.mdia.minf.stbl.stz2,A=t.mdia.minf.stbl.stts,r=t.mdia.minf.stbl.ctts,o=t.mdia.minf.stbl.stss,a=t.mdia.minf.stbl.stsd,h=t.mdia.minf.stbl.subs,c=t.mdia.minf.stbl.stdp,l=t.mdia.minf.stbl.sbgps,d=t.mdia.minf.stbl.sgpds,y=-1,v=-1,_=-1,E=-1,B=0,C=0,w=0,p.initSampleGroups(t,null,l,d),void 0!==s){for(e=0;e<s.sample_sizes.length;e++){var q={};q.number=e,q.track_id=t.tkhd.track_id,q.timescale=t.mdia.mdhd.timescale,q.alreadyRead=0,t.samples[e]=q,q.size=s.sample_sizes[e],t.samples_size+=q.size,0===e?(f=1,u=0,q.chunk_index=f,q.chunk_run_index=u,b=n.samples_per_chunk[u],m=0,g=u+1<n.first_chunk.length?n.first_chunk[u+1]-1:1/0):e<b?(q.chunk_index=f,q.chunk_run_index=u):(f++,q.chunk_index=f,m=0,f<=g||(g=++u+1<n.first_chunk.length?n.first_chunk[u+1]-1:1/0),q.chunk_run_index=u,b+=n.samples_per_chunk[u]),q.description_index=n.sample_description_index[q.chunk_run_index]-1,q.description=a.entries[q.description_index],q.offset=i.chunk_offsets[q.chunk_index-1]+m,m+=q.size,e>y&&(v++,y<0&&(y=0),y+=A.sample_counts[v]),e>0?(t.samples[e-1].duration=A.sample_deltas[v],t.samples_duration+=t.samples[e-1].duration,q.dts=t.samples[e-1].dts+t.samples[e-1].duration):q.dts=0,r?(e>=_&&(E++,_<0&&(_=0),_+=r.sample_counts[E]),q.cts=t.samples[e].dts+r.sample_offsets[E]):q.cts=q.dts,o?(e==o.sample_numbers[B]-1?(q.is_sync=!0,B++):(q.is_sync=!1,q.degradation_priority=0),h&&h.entries[C].sample_delta+w==e+1&&(q.subsamples=h.entries[C].subsamples,w+=h.entries[C].sample_delta,C++)):q.is_sync=!0,p.process_sdtp(t.mdia.minf.stbl.sdtp,q,q.number),q.degradation_priority=c?c.priority[e]:0,h&&h.entries[C].sample_delta+w==e&&(q.subsamples=h.entries[C].subsamples,w+=h.entries[C].sample_delta),(l.length>0||d.length>0)&&p.setSampleGroupProperties(t,q,e,t.sample_groups_info)}e>0&&(t.samples[e-1].duration=Math.max(t.mdia.mdhd.duration-t.samples[e-1].dts,0),t.samples_duration+=t.samples[e-1].duration)}},p.prototype.updateSampleLists=function(){var t,e,i,n,s,A,r,o,a,l,d,c,u,f,g;if(void 0!==this.moov)for(;this.lastMoofIndex<this.moofs.length;)if(a=this.moofs[this.lastMoofIndex],this.lastMoofIndex++,"moof"==a.type)for(l=a,t=0;t<l.trafs.length;t++){for(d=l.trafs[t],c=this.getTrackById(d.tfhd.track_id),u=this.getTrexById(d.tfhd.track_id),n=d.tfhd.flags&h.TFHD_FLAG_SAMPLE_DESC?d.tfhd.default_sample_description_index:u?u.default_sample_description_index:1,s=d.tfhd.flags&h.TFHD_FLAG_SAMPLE_DUR?d.tfhd.default_sample_duration:u?u.default_sample_duration:0,A=d.tfhd.flags&h.TFHD_FLAG_SAMPLE_SIZE?d.tfhd.default_sample_size:u?u.default_sample_size:0,r=d.tfhd.flags&h.TFHD_FLAG_SAMPLE_FLAGS?d.tfhd.default_sample_flags:u?u.default_sample_flags:0,d.sample_number=0,d.sbgps.length>0&&p.initSampleGroups(c,d,d.sbgps,c.mdia.minf.stbl.sgpds,d.sgpds),e=0;e<d.truns.length;e++){var m=d.truns[e];for(i=0;i<m.sample_count;i++){(f={}).moof_number=this.lastMoofIndex,f.number_in_traf=d.sample_number,d.sample_number++,f.number=c.samples.length,d.first_sample_index=c.samples.length,c.samples.push(f),f.track_id=c.tkhd.track_id,f.timescale=c.mdia.mdhd.timescale,f.description_index=n-1,f.description=c.mdia.minf.stbl.stsd.entries[f.description_index],f.size=A,m.flags&h.TRUN_FLAGS_SIZE&&(f.size=m.sample_size[i]),c.samples_size+=f.size,f.duration=s,m.flags&h.TRUN_FLAGS_DURATION&&(f.duration=m.sample_duration[i]),c.samples_duration+=f.duration,c.first_traf_merged||i>0?f.dts=c.samples[c.samples.length-2].dts+c.samples[c.samples.length-2].duration:(d.tfdt?f.dts=d.tfdt.baseMediaDecodeTime:f.dts=0,c.first_traf_merged=!0),f.cts=f.dts,m.flags&h.TRUN_FLAGS_CTS_OFFSET&&(f.cts=f.dts+m.sample_composition_time_offset[i]),g=r,m.flags&h.TRUN_FLAGS_FLAGS?g=m.sample_flags[i]:0===i&&m.flags&h.TRUN_FLAGS_FIRST_FLAG&&(g=m.first_sample_flags),f.is_sync=!(g>>16&1),f.is_leading=g>>26&3,f.depends_on=g>>24&3,f.is_depended_on=g>>22&3,f.has_redundancy=g>>20&3,f.degradation_priority=65535&g;var b=!!(d.tfhd.flags&h.TFHD_FLAG_BASE_DATA_OFFSET),y=!!(d.tfhd.flags&h.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),v=!!(m.flags&h.TRUN_FLAGS_DATA_OFFSET),_=0;_=b?d.tfhd.base_data_offset:y||0===e?l.start:o,f.offset=0===e&&0===i?v?_+m.data_offset:_:o,o=f.offset+f.size,(d.sbgps.length>0||d.sgpds.length>0||c.mdia.minf.stbl.sbgps.length>0||c.mdia.minf.stbl.sgpds.length>0)&&p.setSampleGroupProperties(c,f,f.number_in_traf,d.sample_groups_info)}}if(d.subs){c.has_fragment_subsamples=!0;var E=d.first_sample_index;for(e=0;e<d.subs.entries.length;e++)E+=d.subs.entries[e].sample_delta,(f=c.samples[E-1]).subsamples=d.subs.entries[e].subsamples}}},p.prototype.getSample=function(t,e){var i,s=t.samples[e];if(!this.moov)return null;if(s.data){if(s.alreadyRead==s.size)return s}else s.data=new Uint8Array(s.size),s.alreadyRead=0,this.samplesDataSize+=s.size,n.debug("ISOFile","Allocating sample #"+e+" on track #"+t.tkhd.track_id+" of size "+s.size+" (total: "+this.samplesDataSize+")");for(;;){var r=this.stream.findPosition(!0,s.offset+s.alreadyRead,!1);if(!(r>-1))return null;var o=(i=this.stream.buffers[r]).byteLength-(s.offset+s.alreadyRead-i.fileStart);if(s.size-s.alreadyRead<=o)return n.debug("ISOFile","Getting sample #"+e+" data (alreadyRead: "+s.alreadyRead+" offset: "+(s.offset+s.alreadyRead-i.fileStart)+" read size: "+(s.size-s.alreadyRead)+" full size: "+s.size+")"),A.memcpy(s.data.buffer,s.alreadyRead,i,s.offset+s.alreadyRead-i.fileStart,s.size-s.alreadyRead),i.usedBytes+=s.size-s.alreadyRead,this.stream.logBufferLevel(),s.alreadyRead=s.size,s;if(0===o)return null;n.debug("ISOFile","Getting sample #"+e+" partial data (alreadyRead: "+s.alreadyRead+" offset: "+(s.offset+s.alreadyRead-i.fileStart)+" read size: "+o+" full size: "+s.size+")"),A.memcpy(s.data.buffer,s.alreadyRead,i,s.offset+s.alreadyRead-i.fileStart,o),s.alreadyRead+=o,i.usedBytes+=o,this.stream.logBufferLevel()}},p.prototype.releaseSample=function(t,e){var i=t.samples[e];return i.data?(this.samplesDataSize-=i.size,i.data=null,i.alreadyRead=0,i.size):0},p.prototype.getAllocatedSampleDataSize=function(){return this.samplesDataSize},p.prototype.getCodecs=function(){var t,e="";for(t=0;t<this.moov.traks.length;t++){t>0&&(e+=","),e+=this.moov.traks[t].mdia.minf.stbl.stsd.entries[0].getCodec()}return e},p.prototype.getTrexById=function(t){var e;if(!this.moov||!this.moov.mvex)return null;for(e=0;e<this.moov.mvex.trexs.length;e++){var i=this.moov.mvex.trexs[e];if(i.track_id==t)return i}return null},p.prototype.getTrackById=function(t){if(void 0===this.moov)return null;for(var e=0;e<this.moov.traks.length;e++){var i=this.moov.traks[e];if(i.tkhd.track_id==t)return i}return null},p.prototype.items=[],p.prototype.itemsDataSize=0,p.prototype.flattenItemInfo=function(){var t,e,i,s=this.items,A=this.meta;if(null!=A&&void 0!==A.hdlr&&void 0!==A.iinf){for(t=0;t<A.iinf.item_infos.length;t++)(i={}).id=A.iinf.item_infos[t].item_ID,s[i.id]=i,i.ref_to=[],i.name=A.iinf.item_infos[t].item_name,A.iinf.item_infos[t].protection_index>0&&(i.protection=A.ipro.protections[A.iinf.item_infos[t].protection_index-1]),A.iinf.item_infos[t].item_type?i.type=A.iinf.item_infos[t].item_type:i.type="mime",i.content_type=A.iinf.item_infos[t].content_type,i.content_encoding=A.iinf.item_infos[t].content_encoding;if(A.iloc)for(t=0;t<A.iloc.items.length;t++){var r=A.iloc.items[t];switch(i=s[r.item_ID],0!==r.data_reference_index&&(n.warn("Item storage with reference to other files: not supported"),i.source=A.dinf.boxes[r.data_reference_index-1]),r.construction_method){case 0:break;case 1:case 2:n.warn("Item storage with construction_method : not supported")}for(i.extents=[],i.size=0,e=0;e<r.extents.length;e++)i.extents[e]={},i.extents[e].offset=r.extents[e].extent_offset+r.base_offset,i.extents[e].length=r.extents[e].extent_length,i.extents[e].alreadyRead=0,i.size+=i.extents[e].length}if(A.pitm&&(s[A.pitm.item_id].primary=!0),A.iref)for(t=0;t<A.iref.references.length;t++){var o=A.iref.references[t];for(e=0;e<o.references.length;e++)s[o.from_item_ID].ref_to.push({type:o.type,id:o.references[e]})}if(A.iprp)for(var a=0;a<A.iprp.ipmas.length;a++){var h=A.iprp.ipmas[a];for(t=0;t<h.associations.length;t++){var l=h.associations[t];for(void 0===(i=s[l.id]).properties&&(i.properties={},i.properties.boxes=[]),e=0;e<l.props.length;e++){var d=l.props[e];if(d.property_index>0&&d.property_index-1<A.iprp.ipco.boxes.length){var p=A.iprp.ipco.boxes[d.property_index-1];i.properties[p.type]=p,i.properties.boxes.push(p)}}}}}},p.prototype.getItem=function(t){var e,i;if(!this.meta)return null;if(!(i=this.items[t]).data&&i.size)i.data=new Uint8Array(i.size),i.alreadyRead=0,this.itemsDataSize+=i.size,n.debug("ISOFile","Allocating item #"+t+" of size "+i.size+" (total: "+this.itemsDataSize+")");else if(i.alreadyRead===i.size)return i;for(var s=0;s<i.extents.length;s++){var r=i.extents[s];if(r.alreadyRead!==r.length){var o=this.stream.findPosition(!0,r.offset+r.alreadyRead,!1);if(!(o>-1))return null;var a=(e=this.stream.buffers[o]).byteLength-(r.offset+r.alreadyRead-e.fileStart);if(!(r.length-r.alreadyRead<=a))return n.debug("ISOFile","Getting item #"+t+" extent #"+s+" partial data (alreadyRead: "+r.alreadyRead+" offset: "+(r.offset+r.alreadyRead-e.fileStart)+" read size: "+a+" full extent size: "+r.length+" full item size: "+i.size+")"),A.memcpy(i.data.buffer,i.alreadyRead,e,r.offset+r.alreadyRead-e.fileStart,a),r.alreadyRead+=a,i.alreadyRead+=a,e.usedBytes+=a,this.stream.logBufferLevel(),null;n.debug("ISOFile","Getting item #"+t+" extent #"+s+" data (alreadyRead: "+r.alreadyRead+" offset: "+(r.offset+r.alreadyRead-e.fileStart)+" read size: "+(r.length-r.alreadyRead)+" full extent size: "+r.length+" full item size: "+i.size+")"),A.memcpy(i.data.buffer,i.alreadyRead,e,r.offset+r.alreadyRead-e.fileStart,r.length-r.alreadyRead),e.usedBytes+=r.length-r.alreadyRead,this.stream.logBufferLevel(),i.alreadyRead+=r.length-r.alreadyRead,r.alreadyRead=r.length}}return i.alreadyRead===i.size?i:null},p.prototype.releaseItem=function(t){var e=this.items[t];if(e.data){this.itemsDataSize-=e.size,e.data=null,e.alreadyRead=0;for(var i=0;i<e.extents.length;i++){e.extents[i].alreadyRead=0}return e.size}return 0},p.prototype.processItems=function(t){for(var e in this.items){var i=this.items[e];this.getItem(i.id),t&&!i.sent&&(t(i),i.sent=!0,i.data=null)}},p.prototype.hasItem=function(t){for(var e in this.items){var i=this.items[e];if(i.name===t)return i.id}return-1},p.prototype.getMetaHandler=function(){return this.meta?this.meta.hdlr.handler:null},p.prototype.getPrimaryItem=function(){return this.meta&&this.meta.pitm?this.getItem(this.meta.pitm.item_id):null},p.prototype.itemToFragmentedTrackFile=function(t){var e=t||{},i=null;if(null==(i=e.itemId?this.getItem(e.itemId):this.getPrimaryItem()))return null;var n=new p;n.discardMdatData=!1;var s={type:i.type,description_boxes:i.properties.boxes};i.properties.ispe&&(s.width=i.properties.ispe.image_width,s.height=i.properties.ispe.image_height);var A=n.addTrack(s);return A?(n.addSample(A,i.data),n):null},p.prototype.write=function(t){for(var e=0;e<this.boxes.length;e++)this.boxes[e].write(t)},p.prototype.createFragment=function(t,e,i){var s=this.getTrackById(t),r=this.getSample(s,e);if(null==r)return r=s.samples[e],this.nextSeekPosition?this.nextSeekPosition=Math.min(r.offset+r.alreadyRead,this.nextSeekPosition):this.nextSeekPosition=s.samples[e].offset+r.alreadyRead,null;var o=i||new A;o.endianness=A.BIG_ENDIAN;var a=this.createSingleSampleMoof(r);a.write(o),a.trafs[0].truns[0].data_offset=a.size+8,n.debug("MP4Box","Adjusting data_offset with new value "+a.trafs[0].truns[0].data_offset),o.adjustUint32(a.trafs[0].truns[0].data_offset_position,a.trafs[0].truns[0].data_offset);var l=new h.mdatBox;return l.data=r.data,l.write(o),o},p.writeInitializationSegment=function(t,e,i,s){var r;n.debug("ISOFile","Generating initialization segment");var o=new A;o.endianness=A.BIG_ENDIAN,t.write(o);var a=e.add("mvex");for(i&&a.add("mehd").set("fragment_duration",i),r=0;r<e.traks.length;r++)a.add("trex").set("track_id",e.traks[r].tkhd.track_id).set("default_sample_description_index",1).set("default_sample_duration",s).set("default_sample_size",0).set("default_sample_flags",65536);return e.write(o),o.buffer},p.prototype.save=function(t){var e=new A;e.endianness=A.BIG_ENDIAN,this.write(e),e.save(t)},p.prototype.getBuffer=function(){var t=new A;return t.endianness=A.BIG_ENDIAN,this.write(t),t.buffer},p.prototype.initializeSegmentation=function(){var t,e,i,s;for(null===this.onSegment&&n.warn("MP4Box","No segmentation callback set!"),this.isFragmentationInitialized||(this.isFragmentationInitialized=!0,this.nextMoofNumber=0,this.resetTables()),e=[],t=0;t<this.fragmentedTracks.length;t++){var A=new h.moovBox;A.mvhd=this.moov.mvhd,A.boxes.push(A.mvhd),i=this.getTrackById(this.fragmentedTracks[t].id),A.boxes.push(i),A.traks.push(i),(s={}).id=i.tkhd.track_id,s.user=this.fragmentedTracks[t].user,s.buffer=p.writeInitializationSegment(this.ftyp,A,this.moov.mvex&&this.moov.mvex.mehd?this.moov.mvex.mehd.fragment_duration:void 0,this.moov.traks[t].samples.length>0?this.moov.traks[t].samples[0].duration:0),e.push(s)}return e},h.Box.prototype.printHeader=function(t){this.size+=8,this.size>r&&(this.size+=8),"uuid"===this.type&&(this.size+=16),t.log(t.indent+"size:"+this.size),t.log(t.indent+"type:"+this.type)},h.FullBox.prototype.printHeader=function(t){this.size+=4,h.Box.prototype.printHeader.call(this,t),t.log(t.indent+"version:"+this.version),t.log(t.indent+"flags:"+this.flags)},h.Box.prototype.print=function(t){this.printHeader(t)},h.ContainerBox.prototype.print=function(t){this.printHeader(t);for(var e=0;e<this.boxes.length;e++)if(this.boxes[e]){var i=t.indent;t.indent+=" ",this.boxes[e].print(t),t.indent=i}},p.prototype.print=function(t){t.indent="";for(var e=0;e<this.boxes.length;e++)this.boxes[e]&&this.boxes[e].print(t)},h.mvhdBox.prototype.print=function(t){h.FullBox.prototype.printHeader.call(this,t),t.log(t.indent+"creation_time: "+this.creation_time),t.log(t.indent+"modification_time: "+this.modification_time),t.log(t.indent+"timescale: "+this.timescale),t.log(t.indent+"duration: "+this.duration),t.log(t.indent+"rate: "+this.rate),t.log(t.indent+"volume: "+(this.volume>>8)),t.log(t.indent+"matrix: "+this.matrix.join(", ")),t.log(t.indent+"next_track_id: "+this.next_track_id)},h.tkhdBox.prototype.print=function(t){h.FullBox.prototype.printHeader.call(this,t),t.log(t.indent+"creation_time: "+this.creation_time),t.log(t.indent+"modification_time: "+this.modification_time),t.log(t.indent+"track_id: "+this.track_id),t.log(t.indent+"duration: "+this.duration),t.log(t.indent+"volume: "+(this.volume>>8)),t.log(t.indent+"matrix: "+this.matrix.join(", ")),t.log(t.indent+"layer: "+this.layer),t.log(t.indent+"alternate_group: "+this.alternate_group),t.log(t.indent+"width: "+this.width),t.log(t.indent+"height: "+this.height)};var c={createFile:function(t,e){var i=void 0===t||t,n=new p(e);return n.discardMdatData=!i,n}};t.createFile=c.createFile}(Wi);class Xi{constructor(t){this.url="",this.url=t.url,this.header=t.header,this.method=t.method,this.responseType=t.responseType||"arraybuffer",this.xhr=t.xhr}}class Zi{constructor(){}setup(){}load(t){let e,i=t.request;if(i.xhr?e=i.xhr:(e=new XMLHttpRequest,i.xhr=e),e.open(i.method||"get",i.url),e.responseType=i.responseType,i.header)for(let t in i.header)e.setRequestHeader(t,i.header[t]);e.onreadystatechange=i=>{4===e.readyState&&(e.status>=200&&e.status<300||304===e.status?t.success&&t.success.call(e,e.response):t.error&&t.error.call(e,i))},e.onabort=i=>{t.abort&&t.abort.call(e,i)},e.onerror=i=>{t.error&&t.error.call(e,i)},e.onprogress=i=>{t.progress&&t.progress.call(e,i)},e.send()}}class $i{constructor(t){this.isActive=!1,this.realtime=!1,this.chunkStart=0,this.chunkSize=0,this.totalLength=0,this.chunkTimeout=1e3,this.timeoutID=null,this.url="",this.callback=null,this.eof=!1,this.url=t||"",this.loader=new Zi}start(){return Wi.Log.info("Downloader","Starting file download"),this.chunkStart=0,this.resume(),this}reset(){return this.chunkStart=0,this.totalLength=0,this.eof=!1,this}stop(){return window.clearTimeout(this.timeoutID),this.timeoutID=null,this.isActive=!1,this}resume(){return Wi.Log.info("Downloader","Resuming file download"),this.isActive=!0,0===this.chunkSize&&(this.chunkSize=1/0),this.getFile(),this}setUrl(t){return this.url=t,this}setRealTime(t){return this.realtime=t,this}setChunkSize(t){return this.chunkSize=t,this}setChunkStart(t){return this.chunkStart=t,this.eof=!1,this}setInterval(t){return this.chunkTimeout=t,this}setCallback(t){return this.callback=t,this}getFileLength(){return this.totalLength}isStopped(){return!this.isActive}initHttpRequest(){let t=new XMLHttpRequest,e={};if(t.start=this.chunkStart,this.chunkStart+this.chunkSize<1/0){let t=0,i="bytes="+this.chunkStart+"-";t=this.chunkStart+this.chunkSize-1,i+=t,e.Range=i}return new Xi({url:this.url,header:e,method:"get",xhr:t})}getFile(){let t=this;if(this.isStopped())return;if(0!==t.totalLength&&t.chunkStart>=t.totalLength&&(t.eof=!0),!0===t.eof)return Wi.Log.info("Downloader","File download done."),void t.callback(null,!0);let e=this.initHttpRequest();this.loader.load({request:e,error:function(e){t.callback(null,!1,!0)},success:function(e){let i=this.getResponseHeader("Content-Range");if(0===t.totalLength&&i){let e;e=i.indexOf("/"),e>-1&&(t.totalLength=+i.slice(e+1))}t.eof=this.response.byteLength!==t.chunkSize||this.response.byteLength===t.totalLength;let n=this.response;if(n.fileStart=this.start,t.callback(n,t.eof),!0===t.isActive&&!1===t.eof){let e=t.chunkTimeout;t.timeoutID=window.setTimeout(t.getFile.bind(t),e)}}})}}class tn{constructor(t,e){this.lastSeekTime=0,this.url=t,this.player=e,this.init()}init(){this.mp4boxfile=Wi.createFile(),this.downloader=new $i(this.url),this.mediaSource=new MediaSource,this.player.video.src=window.URL.createObjectURL(this.mediaSource),this.initEvent()}initEvent(){let t=this;this.mediaSource.addEventListener("sourceopen",t=>{this.loadFile()}),this.mp4boxfile.onMoovStart=function(){Wi.Log.info("Application","Starting to parse movie information")},this.mp4boxfile.onReady=function(e){t.mediaInfo=e,e.isFragmented?t.mediaSource.duration=e.fragment_duration/e.timescale:t.mediaSource.duration=e.duration/e.timescale,t.stop(),t.initializeAllSourceBuffers()},this.mp4boxfile.onSegment=function(e,i,n,s,A){var r=i;r.segmentIndex++,r.pendingAppends.push({id:e,buffer:n,sampleNum:s,is_last:A}),t.onUpdateEnd.call(r,!0,!1,t)},this.player.on("seeking",t=>{var e,i,n,s,A=this.player.video;if(this.lastSeekTime!==A.currentTime){for(e=0;e<A.buffered.length;e++)if(i=A.buffered.start(e),n=A.buffered.end(e),A.currentTime>=i&&A.currentTime<=n)return;this.downloader.stop(),s=this.mp4boxfile.seek(A.currentTime,!0),this.downloader.setChunkStart(s.offset),this.downloader.resume(),this.lastSeekTime=A.currentTime}})}start(){this.downloader.setChunkStart(this.mp4boxfile.seek(0,!0).offset),this.downloader.setChunkSize(1e6),this.downloader.setInterval(1e3),this.mp4boxfile.start(),this.downloader.resume()}reset(){}stop(){this.downloader.isStopped()||this.downloader.stop()}addBuffer(t){var e,i=t.id,n='video/mp4; codecs="'+t.codec+'"';if(!MediaSource.isTypeSupported(n))throw new Error(`你的浏览器不支持${n}媒体类型`);try{console.log("MSE - SourceBuffer #"+i,"Creation with type '"+n+"'"),(e=this.mediaSource.addSourceBuffer(n)).addEventListener("error",(function(t){Wi.Log.error("MSE SourceBuffer #"+i,t)})),e.ms=this.mediaSource,e.id=i,this.mp4boxfile.setSegmentOptions(i,e),e.pendingAppends=[]}catch(t){Wi.Log.error("MSE - SourceBuffer #"+i,"Cannot create buffer with type '"+n+"'"+t)}}loadFile(){let t=this;"open"===this.mediaSource.readyState&&(this.downloader.setInterval(500),this.downloader.setChunkSize(1e6),this.downloader.setUrl(this.url),this.downloader.setCallback((function(e,i,n){var s=0;e&&(s=t.mp4boxfile.appendBuffer(e,i)),i?t.mp4boxfile.flush():t.downloader.setChunkStart(s),n&&t.reset()})),this.downloader.start())}initializeAllSourceBuffers(){if(this.mediaInfo){for(var t=this.mediaInfo,e=0;e<t.tracks.length;e++){var i=t.tracks[e];this.addBuffer(i)}this.initializeSourceBuffers()}}initializeSourceBuffers(){for(var t=this.mp4boxfile.initializeSegmentation(),e=0;e<t.length;e++){var i=t[e].user;0===e&&(i.ms.pendingInits=0),this.onInitAppended=this.onInitAppended.bind(this),i.onupdateend=this.onInitAppended,Wi.Log.info("MSE - SourceBuffer #"+i.id,"Appending initialization data"),i.appendBuffer(t[e].buffer),i.segmentIndex=0,i.ms.pendingInits++}}onInitAppended(t){let e=this;var i=t.target;"open"===i.ms.readyState&&(i.sampleNum=0,i.onupdateend=null,i.addEventListener("updateend",this.onUpdateEnd.bind(i,!0,!0,e)),this.onUpdateEnd.call(i,!1,!0,e),i.ms.pendingInits--,0===i.ms.pendingInits&&this.start())}onUpdateEnd(t,e,i){if(!0===e&&(this.sampleNum&&(i.mp4boxfile.releaseUsedSamples(this.id,this.sampleNum),delete this.sampleNum),this.is_last&&this.ms.endOfStream()),"open"===this.ms.readyState&&!1===this.updating&&this.pendingAppends.length>0){var n=this.pendingAppends.shift();this.sampleNum=n.sampleNum,this.is_last=n.is_last,this.appendBuffer(n.buffer)}}}Tt(".video-mobile-medium-wrapper {\n  position: absolute;\n  height: 2.5rem;\n  width: 40%;\n  padding: 0.3125rem;\n  background-color: rgba(0, 0, 0, 0.5);\n  z-index: 100;\n  border-radius: 5px;\n  top: 50%;\n  left: 50%;\n  -webkit-transform: translateX(-50%) translateY(-50%);\n          transform: translateX(-50%) translateY(-50%);\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.video-mobile-medium-wrapper .video-mobile-medium-iconbox {\n  height: 100%;\n  min-width: 1.875rem;\n}\n.video-mobile-medium-wrapper .video-mobile-medium-iconbox svg {\n  height: 100%;\n  width: 100%;\n}\n.video-mobile-medium-wrapper .video-mobile-medium-iconbox svg path {\n  fill: #fff;\n}\n.video-mobile-medium-wrapper .video-mobile-medium-progressbox {\n  height: 0.1875rem;\n  background-color: #fff;\n  -webkit-box-flex: 0.9;\n  -webkit-flex-grow: 0.9;\n      -ms-flex-positive: 0.9;\n          flex-grow: 0.9;\n  margin-left: 0.3125rem;\n  border-radius: 3px;\n}\n.video-mobile-medium-wrapper .video-mobile-medium-progressbox .video-mobile-medium-completed {\n  background-color: #007aff;\n  height: 100%;\n  width: 0;\n}\n");class en extends C{constructor(t,e,i,n,s){super(e,i,n,s),this.id="MobileVolume",this.timer=0,this.player=t,this.props=n||{},this.init()}init(){this.initTemplate(),this.initEvent()}initTemplate(){h(this.el,["video-mobile-medium-wrapper"]),this.el.style.display="none",this.iconBox=o("div.video-mobile-medium-iconbox"),this.progressBox=o("div.video-mobile-medium-progressbox"),this.completedBox=o("div.video-mobile-medium-completed",{style:{width:"0px"}}),this.icon=g(H),this.iconBox.appendChild(this.icon),this.progressBox.appendChild(this.completedBox),this.el.appendChild(this.iconBox),this.el.appendChild(this.progressBox)}initEvent(){let t=this.completedBox.clientWidth;this.player.on(n.MOVE_VERTICAL,e=>{this.timer&&window.clearInterval(this.timer),this.timer=null,this.el.style.display="";let i=e.deltaY,n=(t+-i)/this.progressBox.clientWidth;n<0?n=0:n>1&&(n=1),this.completedBox.style.width=100*n+"%",this.player.video.volume=n}),this.player.on(n.SLIDE_VERTICAL,e=>{t=this.completedBox.clientWidth,this.timer=window.setTimeout(()=>{this.el.style.display="none"},600)}),this.player.on(n.VIDEO_CLICK,()=>{this.el.style.display="none"})}}class nn{constructor(t,e){this.player=t,this.subtitles=e,this.init()}init(){this.initTemplate(),this.initTextTrack(),this.adjustSubtitleStyle(this.defaultSubtitle),this.initEvent()}initTemplate(){this.el=o("div.video-texttrack-container"),this.player.el.appendChild(this.el),this.subsettingsMain=yt.instance,this.leadItem=this.subsettingsMain.registerSubsettingsItem({leftIcon:b(["M803.6 150.498H220.4c-65.286 0-118.4 53.114-118.4 118.4v486.203c0 65.286 53.114 118.4 118.4 118.4h583.2c65.286 0 118.4-53.114 118.4-118.4V268.898c0-65.286-53.114-118.4-118.4-118.4zM862 755.102c0 32.202-26.198 58.4-58.4 58.4H220.4c-32.202 0-58.4-26.198-58.4-58.4V268.898c0-32.202 26.198-58.4 58.4-58.4h583.2c32.202 0 58.4 26.198 58.4 58.4v486.204z","M691.841 322.542H332.159c-16.568 0-30 13.432-30 30s13.432 30 30 30H482v288.917c0 16.568 13.432 30 30 30 16.569 0 30-13.432 30-30V382.542h149.841c16.568 0 30-13.432 30-30s-13.432-30-30-30z"],"0 0 1024 1024"),leftText:"字幕设置",rightTip:"默认",rightIcon:g(Z,"0 0 1024 1024"),target:wt})}adjustSubtitleStyle(t){console.log(t.style);for(let t in this.defaultSubtitle.style)this.el.style[t]="";if(t.style)for(let e in t.style)this.el.style[e]=t.style[e]}initTextTrack(){this.xhrLoader=new Zi,this.onsuccess=this.onsuccess.bind(this),this.defaultSubtitle=this.subtitles[0];for(let t of this.subtitles)if(t.default){this.defaultSubtitle=t;break}this.trackElement=document.createElement("track"),this.player.video.appendChild(this.trackElement),this.player.on("HideSubtitle",()=>{this.currentSource=this.trackElement.src,this.trackElement.src="",this.el.innerHTML=""}),this.player.on("ShowSubtitle",()=>{this.trackElement.src=this.currentSource}),Bt(()=>{let t=this;this.subsettingsSubtitle=wt.instance,this.subtitles.forEach(e=>{let i=null;e===this.defaultSubtitle&&(i=g(et,"0 0 1024 1024"));let n=this.subsettingsSubtitle.registerSubsettingsItem({leftIcon:i,leftText:e.tip,target:yt,click:i=>{this.leadItem.instance.rightTipBox.innerText=i.leftText,t.trackElement.src=e.source,t.adjustSubtitleStyle(e),t.defaultSubtitle=e;for(let e in t.subtitles)t.subtitles[e].instance.leftIconBox.innerHTML="",i.leftIcon&&delete i.leftIcon,t.subtitles[e].instance===i.instance&&(i.leftIcon=g(et,"0 0 1024 1024"),t.subtitles[e].instance.leftIconBox.appendChild(i.leftIcon))}});e.instance=n.instance})}),this.loadVTTFile(this.defaultSubtitle.source)}initEvent(){this.player.on(n.SHOW_TOOLBAR,()=>{h(this.el,["video-texttrack-container-showtoolbar"])}),this.player.on(n.HIDE_TOOLBAR,()=>{l(this.el,["video-texttrack-container-showtoolbar"])}),this.textTrack=this.player.video.textTracks[0],this.textTrack.mode="hidden",this.textTrack.addEventListener("cuechange",t=>{this.el.innerHTML="",this.textTrack.activeCues.length>0&&[...this.textTrack.activeCues].forEach(t=>{if(!t)return;t.text.split("\n").forEach(t=>{let e=o("p");e.innerText=t,this.el.appendChild(e)})})})}loadVTTFile(t){let e=new Xi({url:t,method:"get"});this.xhrLoader.load({request:e,success:t=>{this.onsuccess(t)}})}onsuccess(t){let e=window.URL.createObjectURL(new Blob([t]));this.trackElement.src=e,this.trackElement.default=!0,this.trackElement.srclang=this.defaultSubtitle.tip,this.trackElement.kind="subtitles"}}class sn{constructor(t,e){this.id="ContextMenuItem",this.container=t,this.content=e,this.init()}init(){this.initTemplate(),this.initEvent()}initTemplate(){this.el=o("div.video-context-menu-item"),this.container.append(this.el),"string"==typeof this.content?this.el.innerHTML=this.content:this.el.append(this.content)}initEvent(){}}var An="1.4.4";class rn{constructor(t,e,i){this.id="ContextMenuInfo",this.container=e,this.player=t,this.info=i,this.init()}init(){this.initTemplate(),this.el.onclick=t=>{t.stopPropagation()}}initTemplate(){this.el=o("div.video-context-menu-info",{style:{display:"none"}});let t=o("div.video-context-menu-infoTitleBox"),e=o("div.video-context-menu-infoTitle"),i=o("span.close");e.innerText="视频信息统计",i.innerText="X",i.onclick=t=>{t.stopPropagation(),this.el.style.display="none"},this.container.append(this.el),t.append(e,i),this.el.appendChild(t);for(let t in this.info){let e=o("div.video-context-menu-infoItem"),i=o("span.video-context-menu-infoSubtitle"),n=o("span.video-context-menu-infoDesc");this.el.appendChild(e),e.append(i,n),"url"===t?i.innerText="视频地址：":"videoCodec"===t?i.innerText="视频编码规范：":"audioCodec"===t?i.innerText="音频编码规范：":"lastUpdateTime"===t?i.innerText="最近更新时间：":"width"===t?i.innerText="媒体资源宽度：":"height"===t?i.innerText="媒体资源高度：":"isFragmented"===t&&(i.innerText="是否为fragmented类型的MP4："),n.innerText=this.info[t]}}}class on extends C{constructor(t,e,i){super(e,i),this.id="ContextMenu",this.player=t,this.init()}init(){this.initTemplate(),this.initComponent(),G(this)}initTemplate(){h(this.el,["video-context-menu"])}initComponent(){let t=this;this.player.on(n.MOOV_PARSE_READY,()=>{this.contextMenuInfo=new rn(t.player,t.player.el,t.player.getVideoInfo())}),this.registerContextMenu("统计信息",(function(t){this.el.style.display="",this.contextMenuInfo.el.style.display=""})),this.registerContextMenu("NiPlayer "+An),this.registerContextMenu("关闭",(function(t){this.el.style.display=""}))}registerContextMenu(t,e){let i=new sn(this.el,t);i.el.addEventListener("click",t=>{t.stopPropagation(),e.call(this,i,t)})}}class an{constructor(t,e){this.url=t,this.player=e,this.mp4boxfile=Wi.createFile(),this.downloader=new $i(t),this.init()}init(){this.initEvent(),this.loadFile()}initEvent(){this.mp4boxfile.onReady=t=>{this.stop();let e={url:this.url,lastUpdateTime:t.modified,videoCodec:t.tracks[0].codec,audioCodec:t.tracks[1].codec,isFragmented:t.isFragmented,width:t.tracks[0].track_width,height:t.tracks[0].track_height};this.player.setVideoInfo(e),this.player.emit(n.MOOV_PARSE_READY)}}stop(){this.downloader.isStopped()||this.downloader.stop()}loadFile(){let t=this;this.downloader.setInterval(500),this.downloader.setChunkSize(1e6),this.downloader.setUrl(this.url),this.downloader.setCallback((function(e,i,n){var s=0;e&&(s=t.mp4boxfile.appendBuffer(e,i)),i?t.mp4boxfile.flush():t.downloader.setChunkStart(s)})),this.downloader.start()}}var hn;class ln extends C{constructor(t){super(t.container,"div.Niplayer_video-wrapper"),this.id="Player",this.isFullscreen=!1,this.enableSeek=!0,this.env=_t.env,this.fullScreenMode="Horizontal",this.baseSize=16,this.mediaProportion=9/16,this.playerOptions=Object.assign({autoPlay:!1,streamPlay:!1},t),this.container=t.container,this.containerHeight=t.container.clientHeight,this.containerWidth=t.container.clientWidth,this.init()}init(){var t;this.playerOptions.video?(this.video=this.playerOptions.video,this.video.parentNode&&this.video.parentNode.removeChild(this.video)):(this.video=o("video"),this.video.playsinline=!0,this.video["x5-video-player-type"]="h5"),this.video.crossOrigin="anonymous",this.el.appendChild(this.video),(null===(t=this.playerOptions)||void 0===t?void 0:t.url)&&this.attachSource(this.playerOptions.url),this.initPlugin(),this.initComponent(),this.initTemplate(),this.initEvent(),this.initResizeObserver(),this.checkFullScreenMode()}initTemplate(){"Mobile"===this.env&&(this.unmountComponent("Volume"),new en(this,this.el,"div")),this.pauseIcon=o("div.pauseIcon");const t=o("img");t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAACCQAAAgkCAYAAABoLDe6AABuYklEQVR42uzasQ0AQAgDMfZfOogFqOhw4QUiffHiKkkBAAAAAAAAAFwyAgAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAAggQAAAAAAAAAAEECAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAIEowAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAAggQAAAAAAAAAAEECAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAAYAQAAAAAAAAAQJAAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAECQYAQAAAAAAAAAQJAAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAQJAAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAAMAIAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAAggQAAAAAAAAAAEECAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAACBIMAIAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAAggQAAAAAAAAAAEECAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAQJAAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAACAEQAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAABAkGAEAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAAggQAAAAAAAAAACMAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAQJAAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAgCDBCAAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAACBIAAAAAAAAAAAQJAAAAAAAAAAAggQAAAAAAAAAQJAAAAAAAAAAACBIAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAQJAAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAAAAQQIAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAABGAAAAAAAAAAAECQAAAAAAAACAIAEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAABBAgAAAAAAAAAgSAAAAAAAAAAAECQAAAAAAAAAAIIEAAAAAAAAAECQAAAAAAAAAAAgSAAAAAAAAAAABAkAAAAAAAAAgCABAAAAAAAAAECQAAAAAAAAAAAIEgAAAAAAAAAAQQIAAAAAAAAAgCABAAAAAAAAABAkAAAAAAAAAACCBAAAAAAAAABAkAAAAAAAAAAAIEgAAAAAAAAAAAQJAAAAAAAAAIAgAQAAAAAAAABAkAAAAAAAAAAACBIAAAAAAAAAAEECAAAAAAAAAIAgAQAAAAAAAAAQJAAAAAAAAAAAggQAAAD4YL7NsPFOAAAAQJAAAACA4zsg0gAAAECQAAAA4DgPgBADAABAkAAAADjgO0YBgLgCAABAkAAAAI78AADiCQAAQJAAAAAiAAAAxBEAACBIAAAAYQAAAIghAAAQJAAAgFAAAAAQPgAAIEgAAEA0AAAAiB0AABAkAAAgHgAAABA4AAAIEgAAEBEAAAAgbgAAECQAAIgJAAAAEDUAAAgSAAAEBQAAACBoAAAECQAAogIAAAAQMwAACBIAAGEBAAAAIGQAAAQJAIC4AAAAABAxAACCBABAYAAAAAAgYAAABAkAICoAAAAAEDMAAIIEABAYAAAAACBgAABBAgAgNAAAAAAQLwAAggQAEBsAAAAAIFoAAEECAAgOAAAAABAsAIAgAQAEBwAAAAAgVgAAQQIAwgMAAAAAECsAgCABAIQHAAAAAAgVAECQAADCAwAAAAAQKgAgSAAA8QEAAAAAiBQAQJAAgPgAAAAAABApACBIAEB8AAAAAACIFAAQJACA+AAAAAAABAoAIEgAQIAAAAAAAAgUABAkACBAAAAAAAAECgAIEgAQIAAAAAAACBQAECQAIEIAAAAAAAQKAAgSABAgAAAAAADiBAAECQCIEAAAAAAABAoACBIAECEAAAAAAOIEAAQJAAgQAAAAAABxAgCCBABECAAAAAAA4gQABAkAQgQAAAAAAHECAIIEAEQIAAAAAIA4AQBBAgAiBAAAAAAAYQKAIAEAIQIAAAAAgDgBAEECgAgBAAAAAECYAIAgAQAhAgAAAACAOAFAkACACAEAAAAAQJgAgCABQIgAAAAAAIAwAUCQAIAQAQAAAACavTsqdlwHoihKQRAEIRAEIRAM4UIQhEAwhEAQhEAQBDE4U4+D++utj0XAkTW3e3aVQZwAIEgAQIQAAAAAACBMAECQACBEAAAAAABAmAAgSAAQIgAAAAAAIEwAECQAIEQAAAAAABAmACBIABAiAAAAAAAgTAAQJAAIEQAAAAAAECYACBIA8Ec6AAAAAIAwAQBBAoAQAQAAAAAAYQKAIAFAiAAAAAAAgCgBQJAAIEQAAAAAAECYACBI8BAAxAgAAAAAAAgTAAQJAEIEAAAAAABECQCCBAAhAgAAAAAAwgQAQQIAYgQAAAAAAEQJAIIEACECAAAAAADCBABBAoAYAQAAAAAAYQKAIAFAiAAAAAAAAKIEAEECgBgBAAAAAABRAoAgAUCIAAAAAACAMAFAkAAgRgAAAAAAAFECgCABQIwAAAAAAIAwAUCQACBEAAAAAABAlAAgSAAQIwAAAAAAgCgBQJAAiBEAAAAAAECYACBIABAjAAAAAAAgSgAQJAAIEQAAAAAAQJQAIEgAxAgAAAAAACBKABAkAIgRAAAAAAAQJQAIEgDECAAAAAAAIEwABAkAYgQAAAAAABAlAAgSACGCP0YBAAAAABAlAAgSAMQIAAAAAAAgSgAECQBiBAAAAAAAECUACBIAMQIAAAAAAIgSAAQJAGIEAAAAAAAQJQCCBAAxAgAAAAAAiBIABAmAGAEAAAAAAEQJAIIEADECAAAAAACIEgBBAoAYAQAAAAAARAkAggRAjAAAAAAAAKIEAEECIEYAAAAAAABECYAgAUCMAAAAAAAAogQAQQIgRgAAAAAAAFECgCABECMAAAAAAACiBECQACBIAAAAAAAAUQIgSAAQIwAAAAAAgCgBQJAAiBEAAAAAAABBAiBIABAjAAAAAACAKAEQJACIEQAAAAAAQJQAIEgAxAgAAAAAAIAoARAkAIIEf/gBAAAAAIAoARAkAIgRAAAAAABAlAAgSADECAAAAAAAgCABECQAYgQAAAAAAECUAAgSAMQIAAAAAAAgSgAQJACCBAAAAAAAQJQACBIAMQIAAAAAACBIAAQJAGIEAAAAAAAQJQAIEgAxAgAAAAAAIEoABAmAIAEAAAAAABAlAIIEADECAAAAAAAIEgAECYAYAQAAAAAAECUAggRAkAAAAAAAAIgSAEECIEYAAAAAAAAECYAgAUCMAAAAAAAAogQAQQIgSAAAAAAAAEQJgCABECMAAAAAAACCBECQACBGAAAAAAAAUQKAIAEQJAAAAAAAAKIEQJAAiBEAAAAAAABBAiBIABAkAAAAAACAKAFAkACIEQAAAAAAAEECIEgAxAgAAAAAAIAoARAkAIIEAAAAAABAlAAgSADECAAAAAAAgCABECQAggQAAAAAAECUAAgSADECAAAAAAAgSAAQJABiBAAAAAAAQJQACBIAQQIAAAAAACBIAAQJgBgBAAAAAAAQJQCCBABBAgAAAAAAIEoABAmAGAEAAAAAABAkAIIEQJAAAAAAAACIEgBBAoAYAQAAAAAAECQAggRAkAAAAAAAAIgSAEECIEYAAAAAAAAECYAgARAkAAAAAAAAiBIAQQIgRgAAAAAAAAQJgCABECQAAAAAAACiBECQAIgRAAAAAAAABAmAIAEQJAAAAAAAAKIEQJAAiBEAAAAAAABBAiBIAAQJAAAAAAAAogRAkACIEQAAAAAAAEECIEgABAkAAAAAAIAgARAkAGIEAAAAAABAlAAIEjwEwB9GAAAAAACAIAEQJACCBAAAAAAAQJQACBIAMQIAAAAAACBIAAQJgCABAAAAAABAlAAIEgAxAgAAAAAAIEgABAmAIAEAAAAAABAkAIIEQIwAAAAAAAAgSgAECYAgAQAAAAAAECQAggRAkAAAAAAAAIgSAEECIEYAAAAAAAAQJACCBECQAAAAAAAAiBIAQQIgRgAAAAAAAAQJgCABECQAAAAAAAAIEgBBAuAPHgAAAAAAQJQACBIAMQIAAAAAACBIAAQJgCABAAAAAABAkAAIEkCQAAAAAAAAIEoABAmAGAEAAAAAABAkAIIEQJAAAAAAAAAgSgBBAiBGAAAAAAAAECQAggRAkAAAAAAAAAgSAEECIEgAAAAAAAAQJYAgARAjAAAAAAAACBIAQQIgSAAAAAAAAAQJgCABECQAAAAAAACiBECQAIgRAAAAAAAABAmAIAEQJAAAAAAAAIIEQJAACBIAAAAAAABRAiBIAMQIAAAAAAAAggRAkACCBAAAAAAAAEECIEgABAkAAAAAAIAoARAkAGIEAAAAAAAAQQIgSABBAgAAAAAAgCABECQAggQAAAAAAECUAAgSADECAAAAAACAIAEECYAgAQAAAAAAQJAACBIAQQIAAAAAACBIAAQJgCABAAAAAABAlACCBECMAAAAAAAAIEgABAmAIAEAAAAAABAkAIIEQJAAAAAAAAAgSgBBAiBGAAAAAAAAECQAggQQJAAAAAAAAAgSAEECIEgAAAAAAAAQJIAgARAkAAAAAAAAiBIAQQKIEQAAAAAAAAQJgCABECQAAAAAAACCBECQAAgSAAAAAAAARAmAIAHECAAAAAAAAIIEQJAACBIAAAAAAABBAiBIAAQJAAAAAAAAggRAkACCBAAAAAAAAFECIEgAxAgAAAAAAIAgARAkAIIEAAAAAAAAQQIIEgBBAgAAAAAAgCABECSAIAEAAAAAAECUAAgSADECAAAAAACAIAEECYAgAQAAAAAAQJAACBJAkAAAAAAAACBIAAQJgCABAAAAAABAlACCBECQAAAAAAAAIEgABAkgRgAAAAAAABAkAIIEQJAAAAAAAAAgSABBAiBIAAAAAAAAECUAggQQJAAAAAAAAAgSAEECIEYAAAAAAAAQJIAgARAkAAAAAAAACBIAQQIIEgAAAAAAAAQJgCABECQAAAAAAACiBECQAIgRAAAAAAAABAkgSAAECQAAAAAAAIIEQJAAggQAAAAAAABBAiBIAAQJAAAAAAAAggQQJACCBAAAAAAAAFECIEgAMQIAAAAAAIAgARAkAIIEAAAAAAAAQQIIEgBBAgAAAAAAgCABECSAIAEAAAAAAECQAAgSAEECAAAAAACAKAEECYAYAQAAAAAAQJAACBJAkAAAAAAAACBIAAQJgCABAAAAAABAkACCBECQAAAAAAAAIEgABAkgSAAAAAAAABAlAIIEECMAAAAAAAAgSABBAiBIAAAAAAAAECSAIMFDAEECAAAAAACAIAEQJIAgAQAAAAAAQJDg/5FAkAAIEgAAAAAAAEQJIEgABAkAAAAAAACCBECQAGIEAAAAAAAAQQIgSAAECQAAAAAAAIIEECQAggQAAAAAAABBAiBIAEECAAAAAACAIAEQJACCBAAAAAAAAFECCBIAQQIAAAAAAIAgARAkgBgBAAAAAABAkAAIEgBBAgAAAAAAgCABBAmAIAEAAAAAAECQAAgSQJAAAAAAAAAgSAAECSBIAAAAAAAAQJQAggRAkAAAAAAAACBIAAQJIEYAAAAAAAAQJACCBBAkAAAAAAAAIEgAQQIgSAAAAAAAABAkgCABECQAAAAAAAAIEgBBAggSAAAAAAAAECWAIAEQJAAAAAAAAAgSQJAAiBEAAAAAAAAECYAgAQQJAAAAAAAAggRAkAAIEgAAAAAAAAQJIEgABAkAAAAAAACCBECQAIIEAAAAAAAAQQIgSAAECQAAAAAAAKIEECQAggQAAAAAAABBAiBIADECAAAAAACAIAEQJIAgAQAAAAAAAEECCBIAQQIAAAAAAIAgARAkgCABAAAAAABAkAAIEkCQAAAAAAAAgCABBAmAIAEAAAAAAECUAIIEQJAAAAAAAAAgSAAECSBIAAAAAAAAQJAAggRAjAAAAAAAACBIAEECIEgAAAAAAAAQJACCBBAkAAAAAAAAIEgAQQIgSAAAAAAAABAk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AAAAAAAAECSAIAEQJAAAAAAAAIgRAEECCBIAAAAAAAAQJIAgAQQJAAAAAAAACBJAkAAIEgAAAAAAAAQJgCABBAkAAAAAAACCBECQAIIEAAAAAAAABAkgSABECQAAAAAAAIIEQJAAggQAAAAAAABBAiBIAEECAAAAAAAAggQQJACCBAAAAAAAADECIEgAQQIAAAAAAIAgARAkgCABAAAAAAAAQQIIEgBBAgAAAAAAgCABBAmAIAEAAAAAAECQAAgSQJAAAAAAAACAIAEECYAoAQAAAAAAQJAAggRAkAAAAAAAACBIAAQJIEgAAAAAAABAkACCBECQAAAAAAAAIEYAQQIgSAAAAAAAABAkAIIEECQAAAAAAAAIEgBBAggSAAAAAAAAECSAIAEQJAAAAAAAAAgSAEECCBIAAAAAAAAECYAgAUQJAAAAAAAACBJAkAAIEgAAAAAAAAQJgCABBAkAAAAAAACCBECQAIIEAAAAAAAAxAggSAAECQAAAAAAAIIEECQAggQAAAAAAABBAiBIAEECAAAAAAAAggQQJACCBAAAAAAAAEECCBIAQQIAAAAAAIAgARAkgCgBAAAAAAAAQQIIEgBBAgAAAAAAgCABBAmAIAEAAAAAAECQAAgSQJAAAAAAAAAgRgAECYAgAQAAAAAAQJAAggRAkAAAAAAAACBIAAQJIEgAAAAAAAAQJACCBBAkAAAAAAAAIEgAQQIgSgAAAAAAABAkAIIEECQAAAAAAAAIEgBBAggSAAAAAAAAECOAIAEQJAAAAAAAAAgSAEECCBIAAAAAAAAECYAgAQQJAAAAAAAACBJAkAAIEgAAAAAAAAQJIEgARAkAAAAAAACCBECQAIIEAAAAAAAABAkgSAAECQAAAAAAAIIEECQAggQAAAAAAAAxAiBIAEECAAAAAACAIAEQJACCBAAAAAAAAEECCBIAQQIAAAAAAIAgARAkgCgBAAAAAABAkAAIEgBBAgAAAAAAgCABBAmAIAEAAAAAAECMAAgSQJAAAAAAAAAgSAAECSBIAAAAAAAAQJAAggRAkAAAAAAAACBIAAQJIEgAAAAAAAAQJACCBBAlAAAAAAAAIEgAQQIgSAAAAAAAABAkgCABECQAAAAAAACIEQBBAggSAAAAAAAAECSAIAEQJAAAAAAAAAgSQJAACBIAAAAAAAAECYAgAUQJAAAAAAAA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VVXVIKGqqqqqqqqqapBQVVVVVVVVVQ0SqqqqqqqqqqpBQlVVVVVVVVXVIKGqqqqqqqqqGiRUVVVVVVVVVYOEqqqqqqqqqqpBQlVVVVVVVVU1SKiqqqqqqqqqBglVVVVVVVVVVYOEqqqqqqqqqmqQUFVVVVVVVVUNEqqqqqqqqqqqBglVVVVVVVVV1SChqqqqqqqqqhokVFVVVVVVVVWDhKqqqqqqqqqqQUJVVVVVVVVVNUioqqqqqqqqqgYJVVVVVVVVVVWDhKqqqqqqqqpqkFBVVVVVVVVVDRKqqqqqqqqqqgYJVVVVVVVVVdUgoaqqqqqqqqoaJFRVVVVVVVVVDRKqqqqqqqqqqkFCVVVVVVVVVTVIqKqqqqqqqqoaJFRVVVVVVVVVg4SqqqqqqqqqapBQVVVVVVVVVTVIqKqqqqqqqqoGCVVVVVVVVVXVIKGqqqqqqqqqGiRUVVVVVVVVVQ0SqqqqqqqqqqpBQlVVVVVVVVU1SKiqqqqqqqqqGiRUVVVVVVVVVYOEqqqqqqqqqmqQUFVVVVVVVVU1SKiqqqqqqqqqBglVVVVVVVVV1SChqqqqqqqqqmqQUFVVVVVVVVUNEqqqqqqqqqqqQUJVVVVVVVVV1SChqqqqqqqqqhokVFVVVVVVVVWDhKqqqqqqqqpqkFBVVVVVVVVVNUioqqqqqqqqqgYJVVVVVVVVVdUgoaqqqqqqqqpqkFBVVVVVVVVVDRKqqqqqqqqqqkFCVVVVVVVVVdUgoaqqqqqqqqoaJFRVVVVVVVVVg4SqqqqqqqqqqkFCVVVVVVVVVTVIqKqqqqqqqqoGCVVVVVVVVVVVg4SqqqqqqqqqapBQVVVVVVVVVQ0SqqqqqqqqqqpBwiNUVVVVVVVVVYOEqqqqqqqqqmqQUFVVVVVVVVUNEqqqqqqqqqqqBglVVVVVVVVV1SChqqqqqqqqqhokVFVVVVVVVVUNEqqqqqqqqqqqQUJVVVVVVVVVNUioqqqqqqqqqhokVFVVVVVVVVWDhKqqqqqqqqpqkFBVVVVVVVVVNUioqqqqqqqqqgYJVVVVVVVVVdUgoaqqqqqqqqpqkFBVVVVVVVVVDRKqqqqqqqqqqkFCVVVVVVVVVTVIqKqqqqqqqqoaJFRVVVVVVVVVg4SqqqqqqqqqapBQVVVVVVVVVTVIqKqqqqqqqqoGCVVVVVVVVVXVIKGqqqqqqqqqapBQVVVVVVVVVQ0SqqqqqqqqqqpBQlVVVVVVVVXVIKGqqqqqqqqqGiRUVVVVVVVVVYOEqqqqqqqqqqpBQlVVVVVVVVU1SKiqqqqqqqqqBglVVVVVVVVV1SChqqqqqqqqqmqQUFVVVVVVVVUNEqqqqqqqqqqqQUJVVVVVVVVV1SChqqqqqqqqqhokVFVVVVVVVVWDhKqqqqqqqqqqQUJVVVVVVVVVNUioqqqqqqqqqgYJVVVVVVVVVVWDhKqqqqqqqqpqkFBVVVVVVVVVDRKqqqqqqqqqqgYJVVVVVVVVVdUgoaqqqqqqqqoaJFRVVVVVVVVVDRKqqqqqqqqqqkFCVVVVVVVVVTVIqKqqqqqqqqoGCVVVVVVVVVVVg4SqqqqqqqqqapBQVVVVVVVVVQ0SqqqqqqqqqqoGCVVVVVVVVVXVIKGqqqqqqqqqGiRUVVVVVVVVVQ0SqqqqqqqqqqpBQlVVVVVVVVU1SKiqqqqqqqqqGiRUVVVVVVVVVYOEqqqqqqqqqmqQUFVVVVVVVVU1SKiqqqqqqqqqBglVVVVVVVVV1SChqqqqqqqqqhokVFVVVVVVVVUNEqqqqqqqqqqqQUJVVVVVVVVVNUioqqqqqqqqqhokVFVVVVVVVVWDhKqqqqqqqqpqkFBVVVVVVVVVNUioqqqqqqqqqgYJVVVVVVVVVdUgoaqqqqqqqqpqkFBVVVVVVVVVDRKqqqqqqqqqqkFCVVVVVVVVVdUgoaqqqqqqqqoaJFRVVVVVVVVVg4SqqqqqqqqqapDwCFVVVVVVVVXVIKGqqqqqqqqqGiRUVVVVVVVVVYOEqqqqqqqqqqpBQlVVVVVVVVU1SKiqqqqqqqqqBglVVVVVVVVVVYOEqqqqqqqqqmqQUFVVVVVVVVUNEqqqqqqqqqqqBglVVVVVVVVV1SChqqqqqqqqqhokVFVVVVVVVVUNEqqqqqqqqqqqQUJVVVVVVVVVNUioqqqqqqqqqhokVFVVVVVVVVWDhKqqqqqqqqpqkFBVVVVVVVVVDRKqqqqqqqqqqgYJVVVVVVVVVdUgoaqqqqqqqqoaJFRVVVVVVVVVDRKqqqqqqqqqqkFCVVVVVVVVVTVIqKqqqqqqqqoaJFRVVVVVVVVVg4SqqqqqqqqqapBQVVVVVVVVVTVIqKqqqqqqqqoGCVVVVVVVVVXVIKGqqqqqqqqqapBQVVVVVVVVVQ0SqqqqqqqqqqpBQlVVVVVVVVU1SKiqqqqqqqqqGiRUVVVVVVVVVYOEqqqqqqqqqmqQUFVVVVVVVVU1SKiqqqqqqqqqBglVVVVVVVVV1SChqqqqqqqqqmqQUFVVVVVVVVUNEqqqqqqqqqqqQUJVVVVVVVVV1SChqqqqqqqqqhokVFVVVVVVVVWDhKqqqqqqqqqqQUJVVVVVVVVVNUioqqqqqqqqqgYJVVVVVVVVVVWDhKqqqqqqqqpqkFBVVVVVVVVVDRKqqqqqqqqqqkFCVVVVVVVVVdUgoaqqqqqqqqoaJFRVVVVVVVVVg4SqqqqqqqqqqkFCVVVVVVVVVTVIqKqqqqqqqqoGCVVVVVVVVVVVg4SqqqqqqqqqapBQVVVVVVVVVQ0SqqqqqqqqqqoGCVVVVVVVVVXVIKGqqqqqqqqqGiRUVVVVVVVVVQ0SqqqqqqqqqqpBQlVVVVVVVVU1SKiqqqqqqqqqBglVVVVVVVVVVYOEqqqqqqqqqmqQUFVVVVVVVVUNEqqqqqqqqqqqBglVVVVVVVVV1SChqqqqqqqqqhokVFVVVVVVVVUNEqqqqqqqqqqqQUJVVVVVVVVVNUioqqqqqqqqqhokVFVVVVVVVVWDhKqqqqqqqqpqkFBVVVVVVVVVNUioqqqqqqqqqgYJVVVVVVVVVdUgoaqqqqqqqqoaJDxCVVVVVVVVVTVIqKqqqqqqqqoGCVVVVVVVVVXVIKGqqqqqqqqqapBQVVVVVVVVVQ0SqqqqqqqqqqpBQlVVVVVVVVXVIKGqqqqqqqqqGiRUVVVVVVVVVYOEqqqqqqqqqqpBQlVVVVVVVVU1SKiqqqqqqqqqBglVVVVVVVVVVYOEqqqqqqqqqmqQUFVVVVVVVWnXDgkAAAAABP1/7QobgQNmAQwJAAAAAAAAAACGBAAAAAAAAADAkAAAAAAAAAAAGBIAAAAAAAAAAEMCAAAAAAAAAIAhAQAAAAAAAAAwJAAAAAAAAAAAhgQAAAAAAAAAAEMCAAAAAAAAAGBIAAAAAAAAAAAMCQAAAAAAAAAAhgQAAAAAAAAAwJAAAAAAAAAAABgSAAAAAAAAAAAMCQAAAAAAAACAIQEAAAAAAAAAMCQAAAAAAAAAABgSAAAAAAAAAABDAgAAAAAAAABgSAAAAAAAAAAADAkAAAAAAAAAAIYEAAAAAAAAAMCQAAAAAAAAAAAYEgAAAAAAAAAADAkAAAAAAAAAgCEBAAAAAAAAADAkAAAAAAAAAAAYEgAAAAAAAAAAQwIAAAAAAAAAYEgAAAAAAAAAADAkAAAAAAAAAACGBAAAAAAAAADAkAAAAAAAAAAAYEgAAAAAAAAAAAwJAAAAAAAAAIAhAQAAAAAAAADAkAAAAAAAAAAAGBIAAAAAAAAAAEMCAAAAAAAAAGBIAAAAAAAAAAAwJAAAAAAAAAAAhgQAAAAAAAAAwJAAAAAAAAAAAGBIAAAAAAAAAAAMCQAAAAAAAACAIQEAAAAAAAAAwJAAAAAAAAAAABgSAAAAAAAAAABDAgAAAAAAAACAIQEAAAAAAAAAMCQAAAAAAAAAAIYEAAAAAAAAAABDAgAAAAAAAABgSAAAAAAAAAAADAkAAAAAAAAAgCEBAAAAAAAAAMCQAAAAAAAAAAAYEgAAAAAAAAAAQwIAAAAAAAAAgCEBAAAAAAAAADAkAAAAAAAAAACGBAAAAAAAAAAAQwIAAAAAAAAAYEgAAAAAAAAAAAwJAAAAAAAAAACGBAAAAAAAAADAkAAAAAAAAAAAGBIAAAAAAAAAAAwJAAAAAAAAAIAhAQAAAAAAAAAwJAAAAAAAAAAAhgQRAAAAAAAAAABDAgAAAAAAAABgSAAAAAAAAAAADAkAAAAAAAAAAIYEAAAAAAAAAMCQAAAAAAAAAAAYEgAAAAAAAAAADAkAAAAAAAAAgCEBAAAAAAAAADAkAAAAAAAAAAAYEgAAAAAAAAAAQwIAAAAAAAAAYEgAAAAAAAAAADAkAAAAAAAAAACGBAAAAAAAAADAkAAAAAAAAAAAYEgAAAAAAAAAAAwJAAAAAAAAAIAhAQAAAAAAAAAwJAAAAAAAAAAAGBIAAAAAAAAAAEMCAAAAAAAAAGBIAAAAAAAAAAAwJAAAAAAAAAAAhgQAAAAAAAAAwJAAAAAAAAAAAGBIAAAAAAAAAAAMCQAAAAAAAACAIQEAAAAAAAAAwJAAAAAAAAAAABgSAAAAAAAAAABDAgAAAAAAAACAIQEAAAAAAAAAMCQAAAAAAAAAAIYEAAAAAAAAAMCQAAAAAAAAAABgSAAAAAAAAAAADAkAAAAAAAAAgCEBAAAAAAAAAMCQAAAAAAAAAAAYEgAAAAAAAAAAQwIAAAAAAAAAgCEBAAAAAAAAADAkAAAAAAAAAACGBAAAAAAAAAAAQwIAAAAAAAAAYEgAAAAAAAAAAAwJAAAAAAAAAACGBAAAAAAAAADAkAAAAAAAAAAAGBIAAAAAAAAAAAwJAAAAAAAAAIAhAQAAAAAAAAAwJAAAAAAAAAAAhgQAAAAAAAAAAEMCAAAAAAAAAGBIAAAAAAAAAAAMCQAAAAAAAAAAhgQAAAAAAAAAwJAAAAAAAAAAABgSAAAAAAAAAAAMCQAAAAAAAACAIQEAAAAAAAAAMCQAAAAAAAAAABgSAAAAAAAAAABDAgAAAAAAAABgSAAAAAAAAAAAMCQAAAAAAAAAAIYEAAAAAAAAAMCQAAAAAAAAAAAYEgAAAAAAAAAADAkAAAAAAAAAgCEBAAAAAAAAADAkAAAAAAAAAAAYEgAAAAAAAAAAQwIAAAAAAAAAYEgAAAAAAAAAADAkAAAAAAAAAACGBAAAAAAAAADAkAAAAAAAAAAAYEgAAAAAAAAAAAwJAAAAAAAAAIAhAQAAAAAAAADAkAAAAAAAAAAAzAKs/5LRM74yqQAAAABJRU5ErkJggg==",this.pauseIcon.append(t),this.pauseIcon.style.display="none",this.el.append(this.pauseIcon)}initComponent(){this.loading=new V(this,"视频姬正在努力加载中(⑅˃◡˂⑅)",this.el),this.error=new q(this,"你的网络罢工啦Q_Q",this.el),this.toolBar=new kt(this,this.el,"div"),this.topbar=new St(this,this.el,"div"),this.contextMenu=new on(this,this.el,"div"),this.playerOptions.subtitles&&this.playerOptions.subtitles.length>0&&new nn(this,this.playerOptions.subtitles),this.playerOptions.danmaku&&this.playerOptions.danmaku.open&&(this.danmakuController=new ji(this,this.playerOptions.danmaku))}initEvent(){"Mobile"===this.env?this.initMobileEvent():this.initPCEvent(),this.video.addEventListener("loadedmetadata",t=>{this.emit(n.LOADED_META_DATA,t),this.adjustMediaSize()}),this.video.addEventListener("timeupdate",t=>{this.emit(n.TIME_UPDATE,t)}),this.video.addEventListener("play",t=>{this.pauseIcon.style.display="none",this.emit(n.PLAY,t)}),this.video.addEventListener("pause",t=>{this.pauseIcon.style.display="",this.emit(n.PAUSE,t)}),this.video.addEventListener("seeking",t=>{this.enableSeek&&this.emit(n.SEEKING,t)}),this.video.addEventListener("seeked",t=>{this.emit(n.SEEKED,t)}),this.video.addEventListener("waiting",t=>{this.emit(n.WAITING,t)}),this.video.addEventListener("canplay",t=>{this.emit(n.CAN_PLAY,t)}),this.video.addEventListener("error",t=>{this.emit(n.ERROR)}),this.video.addEventListener("abort",t=>{this.emit(n.ERROR)}),this.video.addEventListener("ratechange",t=>{this.emit(n.RATE_CHANGE)}),this.on(n.DANMAKU_INPUT_FOCUS,()=>{this.el.onmouseleave=null}),this.on(n.DANMAKU_INPUT_BLUR,()=>{this.el.onmouseleave=t=>{this.emit(n.HIDE_TOOLBAR,t)}}),this.on(n.DOT_DOWN,()=>{this.enableSeek=!1}),this.on(n.DOT_UP,()=>{this.enableSeek=!0}),this.on(n.VIDEO_DOT_DRAG,(t,e)=>{this.emit(n.SHOW_TOOLBAR,e)}),this.on(n.ENTER_FULLSCREEN,()=>{this.isFullscreen=!0,this.adjustRem(this.el.clientWidth)}),this.on(n.LEAVE_FULLSCREEN,()=>{this.isFullscreen=!1,this.adjustRem()}),this.on(n.ENTER_FULLPAGE,()=>{this.adjustRem(this.el.clientWidth)}),this.on(n.LEAVE_FULLPAGE,()=>{this.adjustRem()})}initPCEvent(){this.el.onclick=t=>{this.video.paused?this.video.play():this.video.played&&this.video.pause()},this.el.onmousemove=t=>{this.emit(n.SHOW_TOOLBAR,t)},this.el.onmouseenter=t=>{this.emit(n.SHOW_TOOLBAR,t)},this.el.onmouseleave=t=>{this.video.paused||this.emit(n.HIDE_TOOLBAR,t)},document.addEventListener("keyup",t=>{switch(console.log(t.key),t.key){case"f":N.get("FullScreen").requestFullScreen();break;case"ArrowRight":this.video.paused&&this.video.play(),this.video.currentTime+5<=this.video.duration&&(this.video.currentTime+=5);break;case"ArrowLeft":this.video.paused&&this.video.play(),this.video.currentTime-5>=0&&(this.video.currentTime-=5);break;case"ArrowTop":case"ArrowDown":case"":this.isFullscreen&&(this.video.played?this.video.pause():this.video.play())}}),this.el.addEventListener("click",t=>{this.contextMenu.el.style.display=""}),this.el.addEventListener("contextmenu",t=>{t.preventDefault(),this.contextMenu.el.style.display="block",this.contextMenu.el.style.top=t.offsetY+"px",this.contextMenu.el.style.left=t.offsetX+"px"})}initMobileEvent(){R(this.el).addEventListener("touchstart",()=>{this.emit(n.DOT_DOWN)}),R(this.el).addEventListener("singleTap",t=>{"hidden"===this.toolBar.status?this.emit(n.SHOW_TOOLBAR,t):this.emit(n.HIDE_TOOLBAR,t),this.emit(n.VIDEO_CLICK)}),R(this.el).addEventListener("doubleTap",t=>{this.video.paused?this.video.play():this.video.played&&this.video.pause()}),R(this.el).addEventListener("move",t=>{let e=t.deltaX,i=t.deltaY;ht(e,i)>=75?this.emit(n.MOVE_VERTICAL,t):ht(e,i)<=15&&this.emit(n.MOVE_HORIZONTAL,t)}),R(this.el).addEventListener("swipe",t=>{let e=t.endPos.x-t.startPos.x,i=t.endPos.y-t.startPos.y;ht(e,i)>=75?this.emit(n.SLIDE_VERTICAL,t):ht(e,i)<=15&&this.emit(n.SLIDE_HORIZONTAL,t)})}initPlugin(){this.playerOptions.plugins&&this.playerOptions.plugins.forEach(t=>{this.use(t)})}attachSource(t){let e=Ct(t);this.emit(n.SOURCE_ATTACHED,t),"mp4"===e&&(new an(t,this),this.playerOptions.streamPlay?new tn(t,this):this.video.src=t)}initResizeObserver(){new ResizeObserver(t=>{this.emit(n.RESIZE,{width:t[0].contentRect.width,height:t[0].contentRect.height}),this.adjustMediaSize();let e,i=t[0].contentRect.width;if(t[0].contentRect.height,i<=500)P.forEach((t,i)=>{-1!==["SubSetting"].indexOf(i)?(e=N.get(i),this.unmountComponent(i)):-1!==["PicInPic","Playrate","ScreenShot","SubSetting","VideoShot"].indexOf(i)&&(J.get(i)||this.hideComponent(i))}),this.mountComponent(e.id,e,{mode:{type:"TopToolBar",pos:"right"}}),h(e.el,["video-subsettings","video-topbar-controller"]);else if(J.forEach((t,e)=>{this.showComponent(e)}),P.has("SubSetting")){let t="SubSetting",e=N.get(t);this.unmountComponent(t),this.mountComponent(t,e,{mode:{type:"BottomToolBar",pos:"right"},index:1}),h(e.el,["video-subsettings","video-controller"])}}).observe(this.el)}adjustRem(t=600){console.log("调整rem大小",t);let e=1;t/600>1.75&&(e=1.25),document.documentElement.style.fontSize=this.baseSize*e+"px"}adjustMediaSize(){0!==this.mediaProportion&&(this.el.clientHeight/this.el.clientWidth>this.mediaProportion?(this.video.style.width="100%",this.video.style.height=this.el.clientWidth*this.mediaProportion+.05*this.el.clientWidth+"px"):(this.video.style.height="100%",this.video.style.width=this.el.clientHeight/this.mediaProportion+"px"))}checkFullScreenMode(){}mountComponent(t,e,i){if(P.has(t))throw new Error("无法挂载一个已经存在于视图上的组件，请先将其卸载或者删除");if(P.set(t,e),N.has(t)||N.set(t,e),i){let t=i.mode;if("BottomToolBar"===t.type){let n;"left"===t.pos?n=this.toolBar.controller.leftArea:"right"===t.pos?n=this.toolBar.controller.rightArea:"medium"===t.pos&&(n=this.toolBar.controller.mediumArea);let s=[...n.children];if(i.index){if(i.index<0)throw new Error("index不能传入负值");n.insertBefore(e.el,s[i.index]||null)}else n.appendChild(e.el)}else if("TopToolBar"===t.type){let n;n="left"===t.pos?this.topbar.leftArea:this.topbar.rightArea;let s=[...n.children];if(i.index){if(i.index<0)throw new Error("index不能传入负值");n.insertBefore(e.el,s[i.index]||null)}else n.appendChild(e.el)}else"AnyPosition"===t.type&&this.el.appendChild(e.el);e.container=e.el.parentElement}else{if(!e.container)throw new Error("必须传入Options选项或者传入的组件实例中需要有container选项");e.container.appendChild(e.el)}}updateComponent(t,e,i){if(!P.get(t))throw new Error("该组件不存在或者已经被卸载");y(P.get(t),e,i)}hideComponent(t){if(!P.get(t))throw new Error("无法隐藏一个未挂载在视图上的组件");if(J.get(t))throw new Error("该元素已经隐藏");let e=P.get(t);e.el.style.display="none",J.set(t,e)}showComponent(t){if(!J.get(t))throw new Error("该元素已经隐藏");if(!P.get(t))throw new Error("该元素不存在或者被卸载");P.get(t).el.style.display="",J.delete(t)}unmountComponent(t){if(!P.has(t))throw new Error("该组件不存在或者已经被卸载");let e=P.get(t);e.el.parentElement.removeChild(e.el),l(e.el,[...e.el.classList]),P.delete(t)}deleteComponent(t){P.has(t)&&this.unmountComponent(t),N.delete(t)}registerContextMenu(t,e){this.contextMenu.registerContextMenu(t,e)}registerControllers(t,e){"left"===e?(this.playerOptions.leftBottomBarControllers||(this.playerOptions.leftBottomBarControllers=[]),this.playerOptions.leftBottomBarControllers.unshift(t)):"medium"===e?(this.playerOptions.mediumMediumBarController||(this.playerOptions.mediumMediumBarController=[]),this.playerOptions.mediumMediumBarController.unshift(t)):(this.playerOptions.rightBottomBarControllers||(this.playerOptions.rightBottomBarControllers=[]),this.playerOptions.rightBottomBarControllers.unshift(t))}registerSubsetting(){}getVideoInfo(){return this.videoInfo}setVideoInfo(t){this.videoInfo=t,console.log(this.videoInfo)}use(t){t.install(this)}}hn=ln,ln.player=hn}}]);